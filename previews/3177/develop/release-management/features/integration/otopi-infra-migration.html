<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Otopi Infra Migration | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Otopi Infra Migration" />
<meta name="author" content="Alon Bar-Lev" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/3177/develop/release-management/features/integration/otopi-infra-migration.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/3177/develop/release-management/features/integration/otopi-infra-migration.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Otopi Infra Migration" />
<meta name="twitter:site" content="@ovirt" />
<meta name="twitter:creator" content="@Alon Bar-Lev" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Alon Bar-Lev"},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"Otopi Infra Migration","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/3177/images/logo.svg"},"name":"Alon Bar-Lev"},"url":"https://ovirt.github.io/ovirt-site/previews/3177/develop/release-management/features/integration/otopi-infra-migration.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/3177/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/3177/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/3177/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/3177/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/3177/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/3177/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3177/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3177/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3177/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3177/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3177/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/3177/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/3177/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/3177/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/3177/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/3177/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/3177/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/3177/images/logo.svg" />      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav" role="menubar">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/3177/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3177/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/3177/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3177/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3177//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3177//blogs.ovirt.org/'>Blog</a></li>        </ul>      </div>      <!-- /.navbar-collapse -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3177/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3177/develop/">
              <span property="name">Joining the developers community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3177/develop/release-management/">
              <span property="name">Release Management</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3177/develop/release-management/features/">
              <span property="name">Features (Design documents)</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3177/develop/release-management/features/integration/">
              <span property="name">Integration</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/73dbd7b0a4e813ae529563511ec671b4?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/73dbd7b0a4e813ae529563511ec671b4?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Alon Bar-Lev">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Alon Bar-Lev</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/5bfaac88736a0cf76b09e06ebe4dd665?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/5bfaac88736a0cf76b09e06ebe4dd665?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Alex Lourie">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Alex Lourie</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/65fafd7adcef0c369b149759491fae7f?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/65fafd7adcef0c369b149759491fae7f?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Sandro Bonazzola">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard"><a rel="author" href="https://twitter.com/sandrobonazzola" title="Sandro Bonazzola">Sandro Bonazzola</a></span></p>
                      
                    </section>
                  </div>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Feature pages are design documents that developers have created while collaborating on oVirt.<br><br>Most of them are&nbsp;<strong>outdated</strong>, but provide historical design context.<br><br>They are&nbsp;<strong>not</strong>&nbsp;user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/3177/documentation/'>Documentation is available here.</a></div>

<h1 id="otopi-infra-migration">Otopi Infra Migration</h1>

<h2 id="summary">Summary</h2>

<p>A complete re-write of engine-setup, engine-cleanup, engine-upgrade and AIO plugin using otopi.</p>

<h2 id="owner">Owner</h2>

<ul>
  <li>
    <p>Name: Alon Bar-Lev (Alonbl)</p>
  </li>
  <li>
    <p>Name: Alex Lourie (Alourie)</p>
  </li>
  <li>Name: <a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></li>
  <li>Email: <a href="mailto:sbonazzo@redhat.com">sbonazzo@redhat.com</a></li>
</ul>

<h2 id="current-status">Current status</h2>

<ul>
  <li>Last updated: ,</li>
</ul>

<h3 id="engine-setup">engine-setup</h3>

<table>
  <thead>
    <tr>
      <th>Feature</th>
      <th>Existing implementation</th>
      <th>Otopi implementation</th>
      <th>Owner</th>
      <th>Priority</th>
      <th>Target date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Verify that root is the user executing the script</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Allow unprivileged user ro run a development installation</td>
      <td>Not implemented</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Checking total memory</td>
      <td>Done</td>
      <td>Done [1]</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Generate answer file</td>
      <td>Done</td>
      <td>Done[2]</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Allow logging</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support AIO plugin</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td>Medium</td>
      <td> </td>
    </tr>
    <tr>
      <td>Support FIREWALL_MANAGER option</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td>High</td>
      <td> </td>
    </tr>
    <tr>
      <td>Support OVERRIDE_HTTPD_CONFIG option</td>
      <td>Done</td>
      <td>Not required[3]</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support HTTP_PORT option</td>
      <td>Done</td>
      <td>Done[4]</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support HTTPS_PORT option</td>
      <td>Done</td>
      <td>Done[5]</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support RANDOM_PASSWORDS option</td>
      <td>Done</td>
      <td>Not required[6]</td>
      <td> </td>
      <td>Medium</td>
      <td> </td>
    </tr>
    <tr>
      <td>Overriding given passwords with random</td>
      <td>Done</td>
      <td>Not required[7]</td>
      <td> </td>
      <td>Medium</td>
      <td> </td>
    </tr>
    <tr>
      <td>Support MAC_RANGE option</td>
      <td>Done</td>
      <td>Done</td>
      <td>Alex Lourie (AlexLourie)</td>
      <td>Medium</td>
      <td> </td>
    </tr>
    <tr>
      <td>Support HOST_FQDN option</td>
      <td>Done</td>
      <td>Done[8]</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support AUTH_PASS option</td>
      <td>Done</td>
      <td>Done[9]</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support ORG_NAME option</td>
      <td>Done</td>
      <td>Done[10]</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support APPLICATION_MODE option</td>
      <td>Done</td>
      <td>Done[11]</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support DC_TYPE option</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td>Medium</td>
      <td> </td>
    </tr>
    <tr>
      <td>Support DB_REMOTE_INSTALL option</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td>Medium</td>
      <td> </td>
    </tr>
    <tr>
      <td>Support DB_LOCAL_PASS option</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td>Low</td>
      <td> </td>
    </tr>
    <tr>
      <td>Support DB_HOST option</td>
      <td>Done</td>
      <td>Done[12]</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support DB_PORT option</td>
      <td>Done</td>
      <td>Done[13]</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support DB_ADMIN option</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support DB_REMOTE_PASS option</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support DB_SECURE_CONNECTION option</td>
      <td>Done</td>
      <td>Done [14]</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support local DB creation</td>
      <td>Done</td>
      <td>Done</td>
      <td>Alex Lourie (AlexLourie)</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support NFS_MP option</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support ISO_DOMAIN_NAME option</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support CONFIG_NFS option</td>
      <td>Done</td>
      <td>Done[15]</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Display summary in interactive mode</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td>Low</td>
      <td> </td>
    </tr>
    <tr>
      <td>Initialize MiniYum</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td>Medium</td>
      <td> </td>
    </tr>
    <tr>
      <td>Handle second execution warning</td>
      <td>Done</td>
      <td>Not required[16]</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td>Medium</td>
      <td> </td>
    </tr>
    <tr>
      <td>Handle loading and validating params from answer file</td>
      <td>Done</td>
      <td>Done[17]</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Mask input sets</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td>Low</td>
      <td> </td>
    </tr>
    <tr>
      <td>Log masked configuration</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td>Low</td>
      <td> </td>
    </tr>
    <tr>
      <td>Set Max Shared Memory</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Check for supported Java VM</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>CA Generation</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Extract CA fingerprint</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Extract non password key for log collector</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Extract non password key for Apache</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Extract SSH fingerprint</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure engine service - database</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure engine service - Java</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure engine service - Protocols</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure .pgpass file</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Encrypt DB Password</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Push the encrypted password into the local configuration file</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Start / Stop rhevm-etl / ovirt-engine-dwhd service when needed</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Start / Stop rhevm-notifierd / engine-notifierd service when needed</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Upgrade engine database if already exist</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Install engine database if doesn’t exist</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Set Application Mode (Both, Virt, Gluster)</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Update VDC Options</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Update default data center storage type</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td>Medium</td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure engine-log-collector</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure engine-iso-uploader</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure engine-image-uploader</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure PostgreSQL max_connections if using local DB</td>
      <td>Done</td>
      <td>Done</td>
      <td>Alex Lourie (AlexLourie)</td>
      <td>Low</td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure NFS exports for ISO Domain if requested</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td>Medium</td>
      <td> </td>
    </tr>
    <tr>
      <td>Allow importing existing NFS ISO Domain</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Create new NFS ISO Domain</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Migrate existing NFS ISO exports from /etc/exports to /etc/exports.d/</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td>Low</td>
      <td> </td>
    </tr>
    <tr>
      <td>Set selinux context for NFS ISO mount points</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td>Medium</td>
      <td> </td>
    </tr>
    <tr>
      <td>set NFS/portmap ports by overriding /etc/sysconfig/nfs</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Enable the rpcbind and nfs services</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Load files (iso,vfd) from existing rpms to ISO domain</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Check firewall managers installed in the system</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td>High</td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure and enable iptables if requested</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td>High</td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure and enable FirewallD if requested</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td>High</td>
      <td> </td>
    </tr>
    <tr>
      <td>Start / Stop Engine service when needed</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Enable httpd_can_network_connect selinux flag</td>
      <td>Done</td>
      <td>Done</td>
      <td>Alex Lourie (Alourie)</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Backup old Apache httpd config when needed</td>
      <td>Done</td>
      <td>Done</td>
      <td>Alex Lourie (Alourie)</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure Apache mod_ssl for using engine apache keys</td>
      <td>Done</td>
      <td>Done</td>
      <td>Alex Lourie (Alourie)</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure Apache for listening on requested HTTP port</td>
      <td>Done</td>
      <td>Done</td>
      <td>Alex Lourie (Alourie)</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure Apache for listening on requested HTTPS port</td>
      <td>Done</td>
      <td>Done</td>
      <td>Alex Lourie (Alourie)</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Configure Apache as proxy for the requests to the jboss service</td>
      <td>Done</td>
      <td>Done</td>
      <td>Alex Lourie (Alourie)</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Enable the httpd service</td>
      <td>Done</td>
      <td>Done</td>
      <td>Alex Lourie (Alourie)</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Enter rpm versions into yum version-lock</td>
      <td>Done</td>
      <td>Done</td>
      <td>Alex Lourie (Alourie)</td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Add info message to the user finalizing the successful install</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td>Low</td>
      <td> </td>
    </tr>
    <tr>
      <td>Print additional message to the user finalizing the successful install</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td>Low</td>
      <td> </td>
    </tr>
    <tr>
      <td>Log a summary of the parameters</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td>Low</td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>[18] [19] [20] [21] [22] [23] [24] [25] [26] [27] [28] [29] [30] [31]</p>

<h3 id="engine-cleanup">engine-cleanup</h3>

<table>
  <thead>
    <tr>
      <th>Feature</th>
      <th>Existing implementation</th>
      <th>Otopi implementation</th>
      <th>Owner</th>
      <th>Priority</th>
      <th>Target date</th>
      <th> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Verify that root is the user executing the script</td>
      <td>Done</td>
      <td>Done[32]</td>
      <td> </td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Allow unprivileged user ro run a development cleanup</td>
      <td>Not implemented</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support unattended-clean option</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support dont-drop-db option</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support dont-remove-ca option</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support remove-nfs-exports option</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Support remove-exported-content option</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Change working dir to the root directory</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Allow logging</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Ask user to proceed with cleanup in interactive mode</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Stop Engine service when needed</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Backup engine database if drop requested</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Drop engine database if requested</td>
      <td>Done</td>
      <td>Done[33]</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Clean pgpass if drop requested</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Clean sysctl configuration</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Backup CA if remove requested</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Remove CA if requested</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Stop engine-notifierd when needed</td>
      <td>Done</td>
      <td>Done</td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Clean ISO domain NFS exports if requested</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Clean ISO domain exported directories if requested</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Add info message to the user finalizing the successful cleanup</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td><a href="https://github.com/sandrobonazzola">Sandro Bonazzola</a></td>
      <td> </td>
      <td> </td>
    </tr>
    <tr>
      <td>Add info message on where the logs are located</td>
      <td>Done</td>
      <td>Done</td>
      <td> </td>
      <td> </td>
      <td> </td>
      <td> </td>
    </tr>
  </tbody>
</table>

<p>[34] database is not dropped but all objects within are dropped, should be revisit when <a href="https://bugzilla.redhat.com/show_bug.cgi?id=951923">bug#951923</a> is resolved.</p>

<h2 id="detailed-description">Detailed Description</h2>

<p>TBD</p>

<h2 id="benefit-to-ovirt">Benefit to oVirt</h2>

<ul>
  <li>Modular implementation, lower cost of maintenance.</li>
  <li>Use of otopi API.</li>
  <li>Be able to port engine to other distributions.</li>
  <li>Be able to install engine at development mode.</li>
  <li>Be able to customize installation.</li>
  <li>Share installation of components (reports, dwh).</li>
  <li>Code reuse of installer code for multiple purposes (host-deploy, enigne-setup).</li>
</ul>

<h2 id="dependencies--related-features">Dependencies / Related Features</h2>

<p>TBD</p>

<h2 id="documentation--external-references">Documentation / External references</h2>

<ul>
  <li><a href="http://resources.ovirt.org/old-site-files/wiki/Ovirt-host-deploy_3.2.pdf">Ovirt Host Deploy Presentation</a></li>
  <li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=911191">Bug 911191 - Migrate ovirt-engine-setup and AIO plugin to otopi</a></li>
</ul>

<h2 id="basic-testing">Basic Testing</h2>

<h3 id="test-case-setup">Test case: setup</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Run engine-setup-2 on a clean system
   check that the procedure ends successfully
   check that the portal is reachable
   check that the engine is running as it was installed using legacy setup
</code></pre></div></div>

<h3 id="test-case-setup-with-aio-plugin">Test case: setup with AIO plugin</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  On a clean system install AIO plugin and run engine-setup-2
   check that the procedure ends successfully
   check that the portal is reachable
   check that the engine is running as it was installed using legacy setup with AIO plugin
</code></pre></div></div>

<h3 id="test-case-cleanup">Test case: cleanup</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Run engine-cleanup-2 on a system installed using engine-setup-2
   check that the items you confirmed to be removed will be really removed from the system
</code></pre></div></div>

<h3 id="test-case-upgrade-from-previous-version">Test case: upgrade from previous version</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Install stable version on a supported OS (Fedora 19 is not supported by 3.2)
  Upgrade ovirt-engine-setup to 3.3.0
  Run engine-setup-2
   check that the package are upgraded to 3.3.0
   check that the DB schema is upgraded
   check that the configuration is upgraded
   check that the portal is reachable after upgrade
   check that the engine is running after upgrade
</code></pre></div></div>

<h3 id="test-case-upgrade-to-latest-nightly-from-engine-setup-2">Test case: upgrade to latest nightly from engine-setup-2</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Install beta version using engine-setup-2
  Upgrade ovirt-engine-setup to latest nightly
  Run engine-setup-2
   check that the package are upgraded to latest nightly
   check that the DB schema is upgraded
   check that the configuration is upgraded
   check that the portal is reachable after upgrade
   check that the engine is running after upgrade
</code></pre></div></div>

<h3 id="test-case-upgrade-to-latest-nightly-from-legacy-engine-setup">Test case: upgrade to latest nightly from legacy engine-setup</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Install beta version using legacy engine-setup
  Upgrade ovirt-engine-setup to latest nightly
  Run engine-setup-2
   check that the package are upgraded to latest nightly
   check that the DB schema is upgraded
   check that the configuration is upgraded
   check that the portal is reachable after upgrade
   check that the engine is running after upgrade
</code></pre></div></div>

<h2 id="detailed-features-testing">Detailed Features Testing</h2>

<h3 id="test-case-minimum-hardware-requirements-validation">Test case: minimum hardware requirements validation</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Run engine-setup-2 on a system with less than 4 GB of memory
   Check that a warning is issued about not enough available memory on the Host
</code></pre></div></div>

<h3 id="test-case-recommended-hardware-requirements-validation">Test case: recommended hardware requirements validation</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Run engine-setup-2 on a system with less than 16 GB of memory
  Check that a warning is issued about running on a system with less than recommended memory
</code></pre></div></div>

<h3 id="test-case-generate-answer-file">Test case: generate answer file</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Run engine-setup-2 --generate-answer=filename
  check that at the end of the execution the file was generated

  Run engine-cleanup-2 --generate-answer=filename
  check that at the end of the execution the file was generated
</code></pre></div></div>

<h3 id="test-case--use-answer-file">Test case : use answer file</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Run engine-setup-2 --config-append=filename where filename is an answer file generated in a previous execution
  check that engine-setup-2 runs without any question

  Run engine-cleanup-2 --config-append=filename where filename is an answer file generated in a previous execution
  check that engine-cleanup-2 runs without any question
</code></pre></div></div>

<h3 id="test-case-logging">Test case: logging</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Run engine-setup-2
   check that a log file is created in /tmp dir
   check that a summary of the configuration is logged
  Run engine-cleanup-2
   check that a log file is created in /tmp dir
   check that a summary of the configuration is logged

  Run engine-setup-2 --log=filename
   check that a log file is created at specified path
  Run engine-cleanup-2 --log=filename
   check that a log file is created at specified path
</code></pre></div></div>

<h3 id="test-case-firewall-manager-configuration">Test case: firewall manager configuration</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Run engine-setup-2 on a clean system
   check that if only firewalld is installed, the system prompt if you want to configure it.
   check that if only iptables is installed,  the system prompt if you want to configure it.
   check that if both firewalld and iptables are installed the system prompt first for firewalld and if the answer is no it also ask for iptables.
   check that at the end of the execution only the selected firewall manager is running
   check that if no firewall manager was selected an informative message is given to the user allowing to configure the firewall manager manually.
</code></pre></div></div>

<h3 id="test-case-password-masked">Test case: password masked</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Run engine-setup-2
   check that when typing a password nothing is printed on screen
   check that the entered passwords are not visible in logs
</code></pre></div></div>

<h3 id="test-case-output-messages">Test case: output messages</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Run engine-setup-2
   check that there is a message telling where to find the log file
   check that a summary of the configuration is presented when running without an answer file before applying changes to the system allowing the user to abort the procedure
   check that there is an info message finalizing the successful install

  Run engine-cleanup-2
   check that there is a message telling where to find the log file
   check that there is an info message finalizing the successful cleanup
</code></pre></div></div>

<h3 id="test-case-local-database-configuration">Test case: local database configuration</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Run engine-setup-2 on a clean system
   select local database
   select automatic postgresql configuration
   check that the DB is correctly provisioned and created

  Run engine-setup-2 on a clean system
   select local database
   select manual postgresql configuration
   follow on screen instructions
   fill required connection parameters
   check that the setup completes successfully
   check that the engine is running correctly at setup end
</code></pre></div></div>

<h3 id="test-case-remote-database-configuration">Test case: remote database configuration</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Run engine-setup-2 on a clean system
   select remote database
   follow on screen instructions
   fill required connection parameters
   check that the setup completes successfully
   check that the engine is running correctly at setup end
</code></pre></div></div>

<h3 id="test-case-apache-configuration">Test case: Apache configuration</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Run engine-setup-2 on a clean system
   check that if selinux is enabled  httpd_can_network_connect flag is enabled on http and https ports
   check that existing httpd configuration were backed up
   check that mod_ssl was configured for using engine apache keys
   check that Apache was configured as proxy for the requests to the jboss service
</code></pre></div></div>

<h3 id="test-case-tools-configuration">Test case: tools configuration</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Run engine-setup-2 on a clean system
   check that ovirt-log-collector is configured
   check that ovirt-iso-uploader is configured
   check that ovirt-image-uploader is configured
</code></pre></div></div>

<h3 id="test-case-aio-plugin-hardware-requirements-validation">Test case: AIO plugin Hardware requirements validation</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Install ovirt-engine-setup-plugins-allinone and run engine-setup-2
   check that you can configure vdsm if cpu hardware support for virtualization is enabled
   check that you can't configure vdsm if cpu hardware support for virtualization is disabled by bios or not supported by the CPU
</code></pre></div></div>

<p>[1]</p>

<p>[2]</p>

<p>[3]</p>

<p>[4]</p>

<p>[5]</p>

<p>[6]</p>

<p>[7]</p>

<p>[8]</p>

<p>[9]</p>

<p>[10]</p>

<p>[11]</p>

<p>[12]</p>

<p>[13]</p>

<p>[14]</p>

<p>[15]</p>

<p>[16]</p>

<p>[17]</p>

<p>[18] The option <code class="language-plaintext highlighter-rouge">--no-mem-check</code> is now <code class="language-plaintext highlighter-rouge">--otopi-environment="OVESETUP_SYSTEM/memCheck=bool:False"</code></p>

<p>[19] The option <code class="language-plaintext highlighter-rouge">--gen-answer-file</code> is now <code class="language-plaintext highlighter-rouge">--generate-answer</code></p>

<p>[20] The option <code class="language-plaintext highlighter-rouge">--answer-file</code> is now <code class="language-plaintext highlighter-rouge">--config-append</code></p>

<p>[21] The option <code class="language-plaintext highlighter-rouge">CONFIG_NFS=yes</code> is now <code class="language-plaintext highlighter-rouge">OVESETUP_SYSTEM/nfsConfigEnabled=bool:True</code></p>

<p>[22] The option <code class="language-plaintext highlighter-rouge">HOST_FQDN=host</code> is now <code class="language-plaintext highlighter-rouge">OVESETUP_CONFIG/fqdn=str:host</code></p>

<p>[23] The option <code class="language-plaintext highlighter-rouge">HTTP_PORT=80</code> is now <code class="language-plaintext highlighter-rouge">OVESETUP_CONFIG/httpPort=int:80</code></p>

<p>[24] The option <code class="language-plaintext highlighter-rouge">HTTPS_PORT=443</code> is now <code class="language-plaintext highlighter-rouge">OVESETUP_CONFIG/httpsPort=int:443</code></p>

<p>[25] The option <code class="language-plaintext highlighter-rouge">APPLICATION_MODE=both</code> is now <code class="language-plaintext highlighter-rouge">OVESETUP_CONFIG/applicationMode=str:both</code></p>

<p>[26] The option <code class="language-plaintext highlighter-rouge">ORG_NAME=organization</code> is now <code class="language-plaintext highlighter-rouge">OVESETUP_PKI/organization=str:organization</code></p>

<p>[27] The option <code class="language-plaintext highlighter-rouge">DB_HOST=localhost</code> is now <code class="language-plaintext highlighter-rouge">OVESETUP_DB/host=str:localhost</code></p>

<p>[28] The option <code class="language-plaintext highlighter-rouge">DB_PORT=5432</code> is now <code class="language-plaintext highlighter-rouge">OVESETUP_DB/port=int:5432</code></p>

<p>[29] The option <code class="language-plaintext highlighter-rouge">DB_SECURE_CONNECTION=no</code> is now <code class="language-plaintext highlighter-rouge">OVESETUP_DB/secured=bool:False</code></p>

<p>[30] The option <code class="language-plaintext highlighter-rouge">AUTH_PASS=...</code> is now <code class="language-plaintext highlighter-rouge">osetupcons.ConfigEnv.ADMIN_PASSWORD</code></p>

<p>[31] This means that the function is not required in the new code design</p>

<p>[32]</p>

<p>[33]</p>

<p>[34] only if we did not install in development mode</p>



        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/3177/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/3177/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/3177/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/3177/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2024 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/release-management/features/integration/otopi-infra-migration.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/main/source/develop/release-management/features/integration/otopi-infra-migration.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
