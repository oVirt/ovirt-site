<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Refresh LUN Size | oVirt</title>
<meta name="generator" content="Jekyll v3.9.1" />
<meta property="og:title" content="Refresh LUN Size" />
<meta name="author" content="Fred Rolland" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/2648/develop/release-management/features/storage/lun-resize.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/2648/develop/release-management/features/storage/lun-resize.html" />
<meta property="og:site_name" content="oVirt" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Refresh LUN Size" />
<meta name="twitter:site" content="@ovirt" />
<meta name="twitter:creator" content="@Fred Rolland" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Fred Rolland"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/2648/images/logo.svg"},"name":"Fred Rolland"},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","@type":"WebPage","headline":"Refresh LUN Size","url":"https://ovirt.github.io/ovirt-site/previews/2648/develop/release-management/features/storage/lun-resize.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/2648/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/2648/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/2648/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/2648/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/2648/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/2648/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2648/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2648/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2648/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2648/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2648/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <!-- Begin Jekyll Favicon tag v0.2.9 -->
<!-- Classic -->
<link rel="shortcut icon" href="/ovirt-site/previews/2648/favicon.ico">
<link rel="icon" sizes="48x48 32x32 16x16" href="/ovirt-site/previews/2648/favicon.ico">
  <link rel="icon" sizes="16x16" type="image/png" href="/ovirt-site/previews/2648/images/favicon-16x16.png">
  <link rel="icon" sizes="32x32" type="image/png" href="/ovirt-site/previews/2648/images/favicon-32x32.png">
  <link rel="icon" sizes="64x64" type="image/png" href="/ovirt-site/previews/2648/images/favicon-64x64.png">
  <link rel="icon" sizes="144x144" type="image/png" href="/ovirt-site/previews/2648/images/favicon-144x144.png">
<!-- Safari -->
  <link rel="apple-touch-icon" sizes="57x57" href="/ovirt-site/previews/2648/images/favicon-57x57.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/ovirt-site/previews/2648/images/favicon-76x76.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/ovirt-site/previews/2648/images/favicon-120x120.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/ovirt-site/previews/2648/images/favicon-152x152.png">
  <link rel="apple-touch-icon" sizes="167x167" href="/ovirt-site/previews/2648/images/favicon-167x167.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/ovirt-site/previews/2648/images/favicon-180x180.png">
<!-- Chrome -->
  <link rel="icon" sizes="192x192" href="/ovirt-site/previews/2648/images/favicon-192x192.png">
  <link rel="icon" sizes="96x96" href="/ovirt-site/previews/2648/images/favicon-96x96.png">
  <link rel="icon" sizes="48x48" href="/ovirt-site/previews/2648/images/favicon-48x48.png">
<link rel="manifest" href="/ovirt-site/previews/2648/manifest.webmanifest">
<!-- IE -->
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ovirt-site/previews/2648/images/favicon-144x144.png">
<meta name='msapplication-config' content="/ovirt-site/previews/2648/browserconfig.xml">
<!-- End Jekyll Favicon tag -->
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/2648/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/2648/images/logo.svg">      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/2648/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2648/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/2648/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2648/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2648//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2648//blogs.ovirt.org/'>Blog</a></li>              </ul>          </div>          <!-- /.navbar-collapse -->      </div>      <!-- /.container-fluid -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2648/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2648/develop/">
              <span property="name">Developers Community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2648/develop/release-management/">
              <span property="name">Release Management</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2648/develop/release-management/features/">
              <span property="name">Features (Design documents)</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2648/develop/release-management/features/storage/">
              <span property="name">Storage</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <header class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/6261848c1efa431a180b0da119660b8a?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/6261848c1efa431a180b0da119660b8a?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Fred Rolland</span></p>
                      
                    </section>
                  </span>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/25f5a61a5a1e1290bc14e350ce6d8977?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/25f5a61a5a1e1290bc14e350ce6d8977?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Nir Soffer</span></p>
                      
                    </section>
                  </span>
                
              </header>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Feature pages are design documents that developers have created while collaborating on oVirt.<br><br>Most of them are&nbsp;<strong>outdated</strong>, but provide historical design context.<br><br>They are&nbsp;<strong>not</strong>&nbsp;user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/2648/documentation/'>Documentation is available here.</a></div>

<h1 id="refresh-lun-size">Refresh LUN Size</h1>

<h2 id="summary">Summary</h2>

<p>Support dynamic increase of data domain LUNs in oVirt.</p>

<h2 id="owner">Owner</h2>

<ul>
  <li>Fred Rolland (<a href="mailto:frolland@redhat.com">frolland@redhat.com</a>)</li>
  <li>Nir Soffer (<a href="mailto:nsoffer@redhat.com">nsoffer@redhat.com</a>)</li>
</ul>

<h2 id="detailed-description">Detailed Description</h2>

<p>Users need the ability to increase storage space available in oVirt data domains without increasing the number of LUNs presented to it.</p>

<p>A storage admin resizes a LUN using some administrative tool. (This is out of our scope)
The oVirt admin will be able to perform a UI action on specific LUNs in a storage domain so that the new size will be refreshed.</p>

<p>The engine will send to all hosts in Data Center a “GetDeviceList” command with the required LUNs only.
If all hosts return the same size, the engine will send to SPM a “resize PV” command.
The DB will be updated with new sizes if needed.
 In the case when a host was in maintenance or not reachable when this operation has been performed, the host will rescan and resize the LUNs as part of the Connect Storage Server verb. The Connect Storage Server verb is called in engine command InitVdsOnUpCommand whenever a host comes back from a non up state.</p>

<h3 id="user-experience">User Experience</h3>

<p>In the “Edit Domain” window, a new column “Additional Size” will be available. If the LUN can be expanded , a toggle button with the additional size available will appear in the column. The user can choose to select the button on the LUN he wants to refresh and then click OK.</p>

<p><img src="/ovirt-site/previews/2648/images/wiki/DomainRefreshLun.png" alt="" /></p>

<h3 id="vdsm">Vdsm</h3>

<p>The following verbs will be added:
* Resize PV</p>

<p>input : a single LUN GUID</p>

<p>output : size of PV</p>

<p>action : call pvresize and return the size of the PV</p>

<p>The following verb will be updated:
* Get Device List - Rescan and resize of devices will be added</p>
<ul>
  <li>Additional fields will be added:</li>
</ul>

<p>Capacity of path in the path status section</p>

<p>Size of PV</p>

<ul>
  <li>
    <p>Connect Storage server</p>
  </li>
  <li>
    <p>Rescan and resize of devices will be added</p>
  </li>
</ul>

<h3 id="engine">Engine</h3>

<p>A new command will be added:</p>

<ul>
  <li>RefreshLunSize</li>
</ul>

<p>input : a list of LUN GUIDs</p>

<p>output : status of operation</p>

<p>action : send to all hosts in Data Center a “getDeviceList” command with the epecific devices. If all hosts return the same size, the engine will send to SPM a “resize PV” command. The DB will be updated with new sizes if needed.</p>

<h3 id="rest">REST</h3>

<p>The user will able to perform LUN resize using the REST API of Storage Domain.
A new action named “refresh_luns” will be added.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST /api/storagedomains/zzz/refreshluns
&lt;action&gt;
  &lt;logical_units&gt;
    &lt;logical_unit id='xxx'/&gt;
    &lt;logical_unit id='yyy'/&gt;
  &lt;/logical_units&gt;
&lt;/action&gt;
</code></pre></div></div>

<h2 id="open-issues">Open Issues</h2>

<p>What if the host used for getDeviceList do not see the new LUN size? Currently in Edit Domain , the “Use Host” is disabled and the user cannot choose a different one.
Consider revisit Device Visibility command to check if all the hosts are aware of the same PV sizes.</p>




        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/2648/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/2648/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/2648/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/2648/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2021 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/release-management/features/storage/lun-resize.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/master/source/develop/release-management/features/storage/lun-resize.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
