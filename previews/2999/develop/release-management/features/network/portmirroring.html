<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>PortMirroring | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="PortMirroring" />
<meta name="author" content="Moti Asayag" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/2999/develop/release-management/features/network/portmirroring.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/2999/develop/release-management/features/network/portmirroring.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="PortMirroring" />
<meta name="twitter:site" content="@ovirt" />
<meta name="twitter:creator" content="@Moti Asayag" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Moti Asayag"},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"PortMirroring","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/2999/images/logo.svg"},"name":"Moti Asayag"},"url":"https://ovirt.github.io/ovirt-site/previews/2999/develop/release-management/features/network/portmirroring.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/2999/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/2999/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/2999/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/2999/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/2999/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/2999/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2999/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2999/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2999/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2999/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2999/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/2999/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/2999/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/2999/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/2999/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/2999/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/2999/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/2999/images/logo.svg" />      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav" role="menubar">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/2999/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2999/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/2999/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2999/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2999//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2999//blogs.ovirt.org/'>Blog</a></li>        </ul>      </div>      <!-- /.navbar-collapse -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2999/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2999/develop/">
              <span property="name">Developers Community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2999/develop/release-management/">
              <span property="name">Release Management</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2999/develop/release-management/features/">
              <span property="name">Features (Design documents)</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2999/develop/release-management/features/network/">
              <span property="name">Network</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/90758110b19ee0a2e03473012fdc1bd7?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/90758110b19ee0a2e03473012fdc1bd7?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Moti Asayag">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Moti Asayag</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/92517631861d6438bbc8b312cf9ef0a7?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/92517631861d6438bbc8b312cf9ef0a7?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Oved Ourfali">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Oved Ourfali</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/7c6257b29245987d17e77cbc4535da1b?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/7c6257b29245987d17e77cbc4535da1b?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Shahar Havivi">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Shahar Havivi</span></p>
                      
                    </section>
                  </div>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Feature pages are design documents that developers have created while collaborating on oVirt.<br><br>Most of them are&nbsp;<strong>outdated</strong>, but provide historical design context.<br><br>They are&nbsp;<strong>not</strong>&nbsp;user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/2999/documentation/'>Documentation is available here.</a></div>

<h1 id="port-mirroring">Port Mirroring</h1>

<h2 id="summary">Summary</h2>

<p>The purpose of the feature is to allow mirroring network traffic to a specific VM</p>

<h2 id="owner">Owner</h2>

<ul>
  <li>Name: Shahar Havivi (Shaharh)</li>
  <li>Email: <a href="mailto:shavivi@redhat.com">shavivi@redhat.com</a></li>
</ul>

<h2 id="current-status">Current status</h2>

<ul>
  <li>In progress of defining the requirements from the ovirt engine</li>
  <li>VDSM - patch sent (mirror mode only): <a href="http://gerrit.ovirt.org/#change,956">http://gerrit.ovirt.org/#change,956</a></li>
</ul>

<h2 id="detailed-description">Detailed Description</h2>

<p>The port mirroring feature is about allowing a certain VM NIC to monitor the network traffic of a specific logical network, on the host the VM resides on. The method for doing that is to mirror all the VM network traffic on a specific host to a specific VM running on that host. (As opposed to using in-lining/redirect - which is the ability to redirect all the traffic of VMs in a network to a single VM)</p>

<h2 id="user-work-flows">User work-flows</h2>

<ol>
  <li>Upon creating/editing a VM NIC:
    <ul>
      <li>Choose the logical network of the NIC (same as today)</li>
      <li>Choose whether this NIC should get mirrored traffic</li>
    </ul>
  </li>
  <li>It is recommended that the VM containing this NIC will be pinned to a single host (the host which we would like to monitor). One will probably want to define such a VM for each host in the cluster.</li>
</ol>

<p>Notes:</p>

<ol>
  <li>A VM NIC resides only on VM Networks, thus port mirroring is only supported on these networks.</li>
  <li>We shouldn’t limit the VM to be pinned to host, although it is the common use-case.</li>
  <li>More than one VM can monitor the same logical network</li>
  <li>A VM can monitor more than one logical network</li>
  <li>It will be supported when when hot-plugging/unplugging a nic (can set an offline nic to be in mirrored mode, and then activate it)</li>
</ol>

<h2 id="permissions">Permissions</h2>

<ol>
  <li>Permissions support
    <ul>
      <li>Add a “Manipulate port mirroring” action group, which means the user can check/uncheck the port mirroring flag on the VM NIC.</li>
      <li>No pre-defined role will be added for that. In order to use this feature administrators will have to define a custom role containing this action group, and assign it to a user on the DC level.</li>
      <li>A user which has this permission on the DC level, will be able to check this flag for every logical network in the DC, on every cluster (assuming he has permissions on the cluster/VM, of course).</li>
      <li>In the engine-core we will test for this permission on the network level, although for now it will only inherit the permission from the DC, as we won’t enable setting this permission via the UI/API.</li>
      <li>The role will allow users to check the port mirroring flag on the VM NIC. However, everyone with edit permissions on the VM will be able to uncheck it.</li>
    </ul>
  </li>
</ol>

<h2 id="importexporttemplates">Import/Export/Templates</h2>

<ol>
  <li>This flag will not be exported/imported.</li>
  <li>This flag will not be a part of a VM template</li>
</ol>

<h2 id="ui-mockups">UI mockups</h2>

<p>Will be available soon.</p>

<h2 id="rest-api">REST API</h2>

<p>The only change is the ability to set whether the VM NIC should get mirrored traffic or not, so we add the following element to the NIC type:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;xs:element</span> <span class="na">name=</span><span class="s">"mirror_to_port"</span> <span class="na">type=</span><span class="s">"xs:boolean"</span> <span class="na">minOccurs=</span><span class="s">"0"</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<h2 id="benefit-to-ovirt">Benefit to oVirt</h2>

<p>The ability to integrate the security world with the virtualization one, allowing to easily monitor and secure networks in a virtualized environment, same as done today in non-virtualized environments.</p>




        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/2999/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/2999/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/2999/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/2999/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/release-management/features/network/portmirroring.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/master/source/develop/release-management/features/network/portmirroring.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
