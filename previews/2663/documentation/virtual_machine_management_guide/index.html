<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Virtual Machine Management Guide | oVirt</title>
<meta name="generator" content="Jekyll v3.9.1" />
<meta property="og:title" content="Virtual Machine Management Guide" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/2663/documentation/virtual_machine_management_guide/" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/2663/documentation/virtual_machine_management_guide/" />
<meta property="og:site_name" content="oVirt" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Virtual Machine Management Guide" />
<meta name="twitter:site" content="@ovirt" />
<script type="application/ld+json">
{"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/2663/images/logo.svg"}},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","@type":"WebPage","headline":"Virtual Machine Management Guide","url":"https://ovirt.github.io/ovirt-site/previews/2663/documentation/virtual_machine_management_guide/","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/2663/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/2663/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/2663/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/2663/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/2663/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/2663/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2663/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2663/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2663/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2663/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2663/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <!-- Begin Jekyll Favicon tag v0.2.9 -->
<!-- Classic -->
<link rel="shortcut icon" href="/ovirt-site/previews/2663/favicon.ico">
<link rel="icon" sizes="48x48 32x32 16x16" href="/ovirt-site/previews/2663/favicon.ico">
  <link rel="icon" sizes="16x16" type="image/png" href="/ovirt-site/previews/2663/images/favicon-16x16.png">
  <link rel="icon" sizes="32x32" type="image/png" href="/ovirt-site/previews/2663/images/favicon-32x32.png">
  <link rel="icon" sizes="64x64" type="image/png" href="/ovirt-site/previews/2663/images/favicon-64x64.png">
  <link rel="icon" sizes="144x144" type="image/png" href="/ovirt-site/previews/2663/images/favicon-144x144.png">
<!-- Safari -->
  <link rel="apple-touch-icon" sizes="57x57" href="/ovirt-site/previews/2663/images/favicon-57x57.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/ovirt-site/previews/2663/images/favicon-76x76.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/ovirt-site/previews/2663/images/favicon-120x120.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/ovirt-site/previews/2663/images/favicon-152x152.png">
  <link rel="apple-touch-icon" sizes="167x167" href="/ovirt-site/previews/2663/images/favicon-167x167.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/ovirt-site/previews/2663/images/favicon-180x180.png">
<!-- Chrome -->
  <link rel="icon" sizes="192x192" href="/ovirt-site/previews/2663/images/favicon-192x192.png">
  <link rel="icon" sizes="96x96" href="/ovirt-site/previews/2663/images/favicon-96x96.png">
  <link rel="icon" sizes="48x48" href="/ovirt-site/previews/2663/images/favicon-48x48.png">
<link rel="manifest" href="/ovirt-site/previews/2663/manifest.webmanifest">
<!-- IE -->
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ovirt-site/previews/2663/images/favicon-144x144.png">
<meta name='msapplication-config' content="/ovirt-site/previews/2663/browserconfig.xml">
<!-- End Jekyll Favicon tag -->
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/2663/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/2663/images/logo.svg">      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/2663/download/'>Download</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/2663/documentation/'>Documentation</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2663/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2663/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2663//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2663//blogs.ovirt.org/'>Blog</a></li>              </ul>          </div>          <!-- /.navbar-collapse -->      </div>      <!-- /.container-fluid -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2663/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2663/documentation/">
              <span property="name">Documentation</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
        
        <section id="content" class="content container">
          
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#chap-Introduction">1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#Audience">1.1. Audience</a></li>
<li><a href="#Supported_virtual_machines">1.2. Supported Virtual Machine Operating Systems</a></li>
<li><a href="#Virtual_machine_performance_parameters">1.3. Virtual Machine Performance Parameters</a></li>
<li><a href="#sect-Installing_Supporting_Components">1.4. Installing Supporting Components on Client Machines</a>
<ul class="sectlevel3">
<li><a href="#sect-Installing_Console_Components">1.4.1. Installing Console Components</a></li>
<li><a href="#Installing_usbdk_on_Windows">1.4.2. Installing usbdk on Windows</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#Installing_Red_Hat_Enterprise_Linux_Virtual_Machines">2. Installing Enterprise Linux Virtual Machines</a>
<ul class="sectlevel2">
<li><a href="#Creating_a_virtual_machine_linux_vm">2.1. Creating a virtual machine</a></li>
<li><a href="#Starting_the_Virtual_Machine">2.2. Starting the Virtual Machine</a>
<ul class="sectlevel3">
<li><a href="#Powering_on_a_virtual_machine">2.2.1. Starting a Virtual Machine</a></li>
<li><a href="#Opening_a_Console_to_a_Virtual_Machine_linux_vm">2.2.2. Opening a console to a virtual machine</a></li>
</ul>
</li>
<li><a href="#Enabling_the_Required_Repositories">2.3. Enabling the Required Repositories</a></li>
<li><a href="#Installing_Guest_Agents_and_Drivers_Linux">2.4. Installing Guest Agents and Drivers</a>
<ul class="sectlevel3">
<li><a href="#Red_Hat_Virtualization_Guest_Agents_and_Drivers_linux_vm">2.4.1. oVirt Guest agents, tools, and drivers</a></li>
<li><a href="#Installing_the_Guest_Agents_and_Drivers_on_Red_Hat_Enterprise_Linux">2.4.2. Installing the Guest Agents and Drivers on Enterprise Linux</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#chap-Installing_Windows_Virtual_Machines">3. Installing Windows virtual machines</a>
<ul class="sectlevel2">
<li><a href="#Creating_a_virtual_machine_windows_vm">3.1. Creating a virtual machine</a></li>
<li><a href="#sect-Starting_the_Virtual_Machine_Using_the_Run_Once_Option">3.2. Starting the virtual machine using Run Once</a>
<ul class="sectlevel3">
<li><a href="#Installing_Windows_on_Virtio_Optimized_Hardware">3.2.1. Installing Windows on VirtIO-optimized hardware</a></li>
<li><a href="#Opening_a_Console_to_a_Virtual_Machine_windows_vm">3.2.2. Opening a console to a virtual machine</a></li>
</ul>
</li>
<li><a href="#Installing_Guest_Agents_and_Drivers_Windows">3.3. Installing guest agents and drivers</a>
<ul class="sectlevel3">
<li><a href="#Red_Hat_Virtualization_Guest_Agents_and_Drivers_windows_vm">3.3.1. oVirt Guest agents, tools, and drivers</a></li>
<li><a href="#Installing_the_Guest_Agents_and_Drivers_on_Windows">3.3.2. Installing the guest agents, tools, and drivers on Windows</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#chap-Additional_Configuration">4. Additional Configuration</a>
<ul class="sectlevel2">
<li><a href="#Configuring_operating_systems_with_osinfo">4.1. Configuring Operating Systems with osinfo</a></li>
<li><a href="#sect-Configuring_Single_Sign-On_for_Virtual_Machines">4.2. Configuring Single Sign-On for Virtual Machines</a>
<ul class="sectlevel3">
<li><a href="#Configuring_Single_Sign-On_for_Red_Hat_Enterprise_Linux_Virtual_Machines">4.2.1. Configuring Single Sign-On for Enterprise Linux Virtual Machines Using IPA (IdM)</a></li>
<li><a href="#Configuring_Single_Sign_On_for_Windows_Virtual_Machines">4.2.2. Configuring single sign-on for Windows virtual machines</a></li>
<li><a href="#Disabling_Single_Sign-on_for_Virtual_Machines">4.2.3. Disabling Single Sign-on for Virtual Machines</a></li>
</ul>
</li>
<li><a href="#sect-Configuring_USB_Devices">4.3. Configuring USB Devices</a>
<ul class="sectlevel3">
<li><a href="#Using_USB_Devices_on_a_Windows_Client">4.3.1. Using USB Devices on a Windows Client</a></li>
<li><a href="#Using_USB_Devices_on_a_Red_Hat_Enterprise_Linux_Client">4.3.2. Using USB Devices on a Enterprise Linux Client</a></li>
</ul>
</li>
<li><a href="#sect-Configuring_Multiple_Monitors">4.4. Configuring Multiple Monitors</a>
<ul class="sectlevel3">
<li><a href="#Configuring_Multiple_Displays_for_Red_Hat_Enterprise_Linux_Guest_Virtual_Machines">4.4.1. Configuring Multiple Displays for Enterprise Linux Virtual Machines</a></li>
<li><a href="#Configuring_Multiple_Displays_for_Windows_Virtual_Machines">4.4.2. Configuring Multiple Displays for Windows Virtual Machines</a></li>
</ul>
</li>
<li><a href="#sect-Configuring_Console_Options">4.5. Configuring Console Options</a>
<ul class="sectlevel3">
<li><a href="#sect-Console_Options">4.5.1. Console Options</a></li>
<li><a href="#Accessing_console_options">4.5.2. Accessing Console Options</a></li>
<li><a href="#SPICE_Console_Options">4.5.3. SPICE Console Options</a></li>
<li><a href="#VNC_Console_Options">4.5.4. VNC Console Options</a></li>
<li><a href="#RDP_Console_Options">4.5.5. RDP Console Options</a></li>
<li><a href="#sect-Remote_Viewer_Options">4.5.6. Remote Viewer Options</a></li>
</ul>
</li>
<li><a href="#sect-Configuring_a_Watchdog">4.6. Configuring a Watchdog</a>
<ul class="sectlevel3">
<li><a href="#Adding_a_Watchdog_Card_to_a_Virtual_machine">4.6.1. Adding a Watchdog Card to a Virtual Machine</a></li>
<li><a href="#Installing_a_Watchdog">4.6.2. Installing a Watchdog</a></li>
<li><a href="#Confirming_Watchdog_Functionality">4.6.3. Confirming Watchdog Functionality</a></li>
<li><a href="#Parameters_for_Watchdogs_in_watchdog_conf">4.6.4. Parameters for Watchdogs in watchdog.conf</a></li>
</ul>
</li>
<li><a href="#Configuring_virtual_numa">4.7. Configuring Virtual NUMA</a></li>
<li><a href="#Configuring_Satellite_Errata">4.8. Configuring Satellite errata viewing for a virtual machine</a></li>
<li><a href="#Configuring_Headless_Machines">4.9. Configuring Headless Virtual Machines</a></li>
<li><a href="#Configuring_High_Performance_Virtual_Machines_Templates_and_Pools">4.10. Configuring High Performance Virtual Machines, Templates, and Pools</a>
<ul class="sectlevel3">
<li><a href="#creating-a-high-performance-virtual-machine-template-or-pool">4.10.1. Creating a High Performance Virtual Machine, Template, or Pool</a></li>
<li><a href="#Configuring_Recommended_Manual_Settings">4.10.2. Configuring the Recommended Manual Settings</a></li>
</ul>
</li>
<li><a href="#Configuring_timezones">4.11. Configuring the time zone</a></li>
</ul>
</li>
<li><a href="#chap-Editing_Virtual_Machines">5. Editing Virtual Machines</a>
<ul class="sectlevel2">
<li><a href="#Editing_Virtual_Machine_Properties">5.1. Editing Virtual Machine Properties</a></li>
<li><a href="#sect-Network_Interfaces">5.2. Network Interfaces</a>
<ul class="sectlevel3">
<li><a href="#Adding_a_Network_Interface">5.2.1. Adding a New Network Interface</a></li>
<li><a href="#Editing_network_interfaces">5.2.2. Editing a Network Interface</a></li>
<li><a href="#Hot_Plugging_Network_Interfaces">5.2.3. Hot Plugging a Network Interface</a></li>
<li><a href="#Removing_a_Network_Interface">5.2.4. Removing a Network Interface</a></li>
<li><a href="#Blacklisting_Network_Interfaces">5.2.5. Blacklisting Network Interfaces</a></li>
</ul>
</li>
<li><a href="#sect-Virtual_Disks">5.3. Virtual Disks</a>
<ul class="sectlevel3">
<li><a href="#Adding_a_Virtual_Disk">5.3.1. Adding a New Virtual Disk</a></li>
<li><a href="#Associating_a_Virtual_Disk_with_a_Virtual_Machine">5.3.2. Attaching an Existing Disk to a Virtual Machine</a></li>
<li><a href="#Extending_the_Available_Size_of_a_Virtual_Disk">5.3.3. Extending the Available Size of a Virtual Disk</a></li>
<li><a href="#Hot_Plugging_a_Virtual_Disk">5.3.4. Hot Plugging a Virtual Disk</a></li>
<li><a href="#Removing_Virtual_Disks_From_Virtual_Machines">5.3.5. Removing a Virtual Disk from a Virtual Machine</a></li>
<li><a href="#importing-a-disk-image-from-an-imported-storage-domain">5.3.6. Importing a Disk Image from an Imported Storage Domain</a></li>
<li><a href="#importing-an-unregistered-disk-image-from-an-imported-storage-domain">5.3.7. Importing an Unregistered Disk Image from an Imported Storage Domain</a></li>
</ul>
</li>
<li><a href="#sect-Virtual_Memory">5.4. Virtual Memory</a>
<ul class="sectlevel3">
<li><a href="#Hot_Plugging_Virtual_Memory">5.4.1. Hot Plugging Virtual Memory</a></li>
<li><a href="#Hot_Unplugging_Virtual_Memory">5.4.2. Hot Unplugging Virtual Memory</a></li>
</ul>
</li>
<li><a href="#CPU_hot_plug">5.5. Hot Plugging vCPUs</a></li>
<li><a href="#Pinning_a_Virtual_Machine_to_Multiple_Hosts">5.6. Pinning a Virtual Machine to Multiple Hosts</a></li>
<li><a href="#Viewing_Virtual_Machines_Pinned_to_a_Host">5.7. Viewing Virtual Machines Pinned to a Host</a></li>
<li><a href="#Changing_the_CD_for_a_Virtual_Machine">5.8. Changing the CD for a Virtual Machine</a></li>
<li><a href="#Enabling_and_Disabling_Smartcards">5.9. Smart Card Authentication</a></li>
</ul>
</li>
<li><a href="#chap-Administrative_Tasks">6. Administrative Tasks</a>
<ul class="sectlevel2">
<li><a href="#Shutting_down_a_virtual_machine">6.1. Shutting Down a Virtual Machine</a></li>
<li><a href="#Suspending_a_virtual_machine">6.2. Suspending a Virtual Machine</a></li>
<li><a href="#Rebooting_a_Virtual_Machine">6.3. Rebooting or Resetting a Virtual Machine</a></li>
<li><a href="#Removing_a_virtual_machine">6.4. Removing a Virtual Machine</a></li>
<li><a href="#Cloning_a_Virtual_Machine">6.5. Cloning a Virtual Machine</a></li>
<li><a href="#sect-Updating_Virtual_Machine_Guest_Agents_and_Drivers">6.6. Updating Virtual Machine Guest Agents and Drivers</a>
<ul class="sectlevel3">
<li><a href="#Updating_the_Guest_Agents_and_Drivers_on_Red_Hat_Enterprise_Linux">6.6.1. Updating the Guest Agents and Drivers on Enterprise Linux</a></li>
<li><a href="#Updating_Win_Guest_Drivers_with_Windows_Updates">6.6.2. Updating Windows drivers with Windows Update</a></li>
<li><a href="#Updating_the_Guest_Agents_and_Drivers_on_Windows">6.6.3. Updating Windows guest agents and drivers using the command prompt</a></li>
</ul>
</li>
<li><a href="#Viewing_Satellite_Errata">6.7. Viewing Red Hat Satellite Errata for a Virtual Machine</a></li>
<li><a href="#sect-Virtual_Machines_and_Permissions">6.8. Virtual Machines and Permissions</a>
<ul class="sectlevel3">
<li><a href="#Managing_System_Permissions_for_a_Virtual_Machine">6.8.1. Managing System Permissions for a Virtual Machine</a></li>
<li><a href="#Virtual_Machine_Administrator_Roles_Explained">6.8.2. Virtual Machine Administrator Roles Explained</a></li>
<li><a href="#virtual-machine-user-roles-explained">6.8.3. Virtual Machine User Roles Explained</a></li>
<li><a href="#Assigning_virtual_machines_to_users">6.8.4. Assigning Virtual Machines to Users</a></li>
<li><a href="#Removing_Access_to_Virtual_Machines_from_Users">6.8.5. Removing Access to Virtual Machines from Users</a></li>
</ul>
</li>
<li><a href="#sect-Snapshots">6.9. Snapshots</a>
<ul class="sectlevel3">
<li><a href="#Creating_a_snapshot_of_a_virtual_machine">6.9.1. Creating a Snapshot of a Virtual Machine</a></li>
<li><a href="#Using_a_snapshot_to_restore_a_virtual_machine">6.9.2. Using a Snapshot to Restore a Virtual Machine</a></li>
<li><a href="#Creating_a_Virtual_Machine_from_a_Snapshot_vm_guide_administrative_tasks">6.9.3. Creating a Virtual Machine from a Snapshot</a></li>
<li><a href="#Deleting_a_snapshot">6.9.4. Deleting a Snapshot</a></li>
</ul>
</li>
<li><a href="#sect-Host_Devices">6.10. Host Devices</a>
<ul class="sectlevel3">
<li><a href="#Adding_Host_Devices_to_a_Virtual_Machine">6.10.1. Adding a Host Device to a Virtual Machine</a></li>
<li><a href="#Removing_Host_Devices_from_a_Virtual_Machine">6.10.2. Removing Host Devices from a Virtual Machine</a></li>
<li><a href="#Pinning_a_Virtual_Machine_to_Another_Host">6.10.3. Pinning a Virtual Machine to Another Host</a></li>
<li><a href="#conc-nvdimm-host-devices_vm_guide_administrative_tasks">6.10.4. NVDIMM host devices</a></li>
</ul>
</li>
<li><a href="#sect-Affinity_Groups">6.11. Affinity Groups</a>
<ul class="sectlevel3">
<li><a href="#Creating_an_Affinity_Group">6.11.1. Creating an Affinity Group</a></li>
<li><a href="#Editing_an_Affinity_Group">6.11.2. Editing an Affinity Group</a></li>
<li><a href="#Removing_an_Affinity_Group">6.11.3. Removing an Affinity Group</a></li>
<li><a href="#Affinity_groups_examples">6.11.4. Affinity Groups Examples</a></li>
<li><a href="#Affinity_groups_troubleshooting">6.11.5. Affinity Groups Troubleshooting</a></li>
</ul>
</li>
<li><a href="#Affinity_Labels">6.12. Affinity Labels</a>
<ul class="sectlevel3">
<li><a href="#Creating_an_Affinity_Label">6.12.1. Creating an Affinity Label</a></li>
<li><a href="#Editing_an_Affinity_Label">6.12.2. Editing an Affinity Label</a></li>
<li><a href="#Removing_an_Affinity_Label">6.12.3. Removing an Affinity Label</a></li>
</ul>
</li>
<li><a href="#sect-Exporting_and_Importing_Virtual_Machines_and_Templates">6.13. Exporting and Importing Virtual Machines and Templates</a>
<ul class="sectlevel3">
<li><a href="#Exporting_individual_virtual_machines_to_the_export_domain">6.13.1. Exporting a Virtual Machine to the Export Domain</a></li>
<li><a href="#proc_Exporting_individual_virtual_machines_to_a_data_domain_vm_guide_administrative_tasks">6.13.2. Exporting a Virtual Machine to a Data Domain</a></li>
<li><a href="#Importing_the_virtual_machine_from_the_export_domain">6.13.3. Importing a Virtual Machine from the Export Domain</a></li>
<li><a href="#Importing_a_Virtual_Machine_from_a_Data_Domain">6.13.4. Importing a Virtual Machine from a Data Domain</a></li>
<li><a href="#Importing_a_Virtual_Machine_from_a_VMware_Provider">6.13.5. Importing a Virtual Machine from a VMware Provider</a></li>
<li><a href="#Exporting_a_virtual_machine_to_a_host">6.13.6. Exporting a Virtual Machine to a Host</a></li>
<li><a href="#Importing_a_virtual_machine_from_a_host">6.13.7. Importing a Virtual Machine from a Host</a></li>
<li><a href="#Importing_a_Virtual_Machine_from_Xen">6.13.8. Importing a virtual machine from a RHEL 5 Xen host</a></li>
<li><a href="#Importing_a_Virtual_Machine_from_KVM">6.13.9. Importing a Virtual Machine from a KVM Host</a></li>
<li><a href="#Importing_a_Red_Hat_KVM_Guest_Image">6.13.10. Importing a Red Hat KVM Guest Image</a></li>
</ul>
</li>
<li><a href="#sect-Migrating_Virtual_Machines_Between_Hosts">6.14. Migrating Virtual Machines Between Hosts</a>
<ul class="sectlevel3">
<li><a href="#Live_migration_prerequisites">6.14.1. Live Migration Prerequisites</a></li>
<li><a href="#Configuring_virtual_machines_with_SR-IOV-Enabled_vNICs">6.14.2. Configuring Virtual Machines with SR-IOV-Enabled vNICs to Reduce Network Outage during Migration</a></li>
<li><a href="#Configuring_virtual_machines_with_SR-IOV-Enabled_vNICs_minimal_downtime">6.14.3. Configuring Virtual Machines with SR-IOV-Enabled vNICs with minimal downtime.</a></li>
<li><a href="#Optimizing_Live_Migration">6.14.4. Optimizing Live Migration</a></li>
<li><a href="#Guest_Agent_Hooks">6.14.5. Guest Agent Hooks</a></li>
<li><a href="#Automatic_virtual_machine_migration">6.14.6. Automatic Virtual Machine Migration</a></li>
<li><a href="#Preventing_automatic_migration_of_a_virtual_machine">6.14.7. Preventing Automatic Migration of a Virtual Machine</a></li>
<li><a href="#Manually_migrating_virtual_machines">6.14.8. Manually Migrating Virtual Machines</a></li>
<li><a href="#Setting_migration_priority">6.14.9. Setting Migration Priority</a></li>
<li><a href="#Canceling_ongoing_virtual_machine_migrations">6.14.10. Canceling Ongoing Virtual Machine Migrations</a></li>
<li><a href="#Event_and_Log_Notification_upon_Automatic_Migration_of_Highly_Available_Virtual_Servers">6.14.11. Event and Log Notification upon Automatic Migration of Highly Available Virtual Servers</a></li>
</ul>
</li>
<li><a href="#sect-Improving_Uptime_with_Virtual_Machine_High_Availability">6.15. Improving Uptime with Virtual Machine High Availability</a>
<ul class="sectlevel3">
<li><a href="#What_is_high_availability">6.15.1. What is High Availability?</a></li>
<li><a href="#High_availability_considerations">6.15.2. High Availability Considerations</a></li>
<li><a href="#Configuring_a_highly_available_virtual_machine">6.15.3. Configuring a Highly Available Virtual Machine</a></li>
</ul>
</li>
<li><a href="#sect-Other_Virtual_Machine_Tasks">6.16. Other Virtual Machine Tasks</a>
<ul class="sectlevel3">
<li><a href="#Enabling_SAP_monitoring_for_a_virtual_machine_from_the_Administration_Portal">6.16.1. Enabling SAP Monitoring</a></li>
<li><a href="#sect-Configuring_Red_Hat_Enterprise_Linux_5.4_and_Higher_Virtual_Machines_to_use_SPICE">6.16.2. Configuring Enterprise Linux 5.4 and later Virtual Machines to use SPICE</a></li>
<li><a href="#KVM_virtual_machine_timing_management">6.16.3. KVM Virtual Machine Timing Management</a></li>
<li><a href="#Adding_TPM_devices">6.16.4. Adding a Trusted Platform Module device</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#chap-Templates">7. Templates</a>
<ul class="sectlevel2">
<li><a href="#Sealing_Virtual_Machines_in_Preparation_for_Deployment_as_Templates">7.1. Sealing Virtual Machines in Preparation for Deployment as Templates</a>
<ul class="sectlevel3">
<li><a href="#Sealing_a_Linux_Virtual_Machine_for_Deployment_as_a_Template">7.1.1. Sealing a Linux Virtual Machine for Deployment as a Template</a></li>
<li><a href="#Sealing_a_Windows_Virtual_Machine_for_Deployment_as_a_Template">7.1.2. Sealing a Windows Virtual Machine for Deployment as a Template</a></li>
</ul>
</li>
<li><a href="#Creating_a_template_from_an_existing_virtual_machine">7.2. Creating a Template</a></li>
<li><a href="#Editing_a_Template">7.3. Editing a Template</a></li>
<li><a href="#Deleting_a_template">7.4. Deleting a Template</a></li>
<li><a href="#sect-Exporting_Templates">7.5. Exporting Templates</a>
<ul class="sectlevel3">
<li><a href="#Migrating_Templates_to_the_Export_Domain">7.5.1. Migrating Templates to the Export Domain</a></li>
<li><a href="#Copying_a_Templates_Virtual_Hard_Disk">7.5.2. Copying a Template&#8217;s Virtual Hard Disk</a></li>
</ul>
</li>
<li><a href="#sect-Importing_Templates">7.6. Importing Templates</a>
<ul class="sectlevel3">
<li><a href="#Importing_a_template_into_a_data_center">7.6.1. Importing a Template into a Data Center</a></li>
<li><a href="#Importing_a_Virtual_Disk_from_an_OpenStack_Image_Service_as_a_Template">7.6.2. Importing a Virtual Disk from an OpenStack Image Service as a Template</a></li>
</ul>
</li>
<li><a href="#sect-Templates_and_Permissions">7.7. Templates and Permissions</a>
<ul class="sectlevel3">
<li><a href="#Managing_System_Permissions_for_a_Template">7.7.1. Managing System Permissions for a Template</a></li>
<li><a href="#Template_Administrator_Roles_Explained">7.7.2. Template Administrator Roles Explained</a></li>
<li><a href="#Assigning_an_Administrator_or_User_Role_to_a_Resource">7.7.3. Assigning an Administrator or User Role to a Resource</a></li>
<li><a href="#Removing_an_Administrator_or_User_Role_from_a_Resource">7.7.4. Removing an Administrator or User Role from a Resource</a></li>
</ul>
</li>
<li><a href="#Using_Cloud-Init_to_Automate_the_Configuration_of_Virtual_Machines">7.8. Using Cloud-Init to Automate the Configuration of Virtual Machines</a>
<ul class="sectlevel3">
<li><a href="#Cloud-Init_Use_Case_Scenarios">7.8.1. Cloud-Init Use Case Scenarios</a></li>
<li><a href="#Installing_Cloud-Init">7.8.2. Installing Cloud-Init</a></li>
<li><a href="#Using_Cloud-Init_to_Prepare_a_Template">7.8.3. Using Cloud-Init to Prepare a Template</a></li>
<li><a href="#Using_Cloud-Init">7.8.4. Using Cloud-Init to Initialize a Virtual Machine</a></li>
</ul>
</li>
<li><a href="#Using_Sysprep_to_Automate_the_Configuration_of_Virtual_Machines">7.9. Using Sysprep to Automate the Configuration of Virtual Machines</a>
<ul class="sectlevel3">
<li><a href="#Configuring_Sysprep_on_a_Template">7.9.1. Configuring Sysprep on a Template</a></li>
<li><a href="#Using_Sysprep_to_Initialize_a_Virtual_Machine">7.9.2. Using Sysprep to Initialize a Virtual Machine</a></li>
</ul>
</li>
<li><a href="#Creating_a_Virtual_Machine_Based_on_a_Template">7.10. Creating a Virtual Machine Based on a Template</a></li>
<li><a href="#Creating_a_cloned_virtual_machine_based_on_a_template">7.11. Creating a Cloned Virtual Machine Based on a Template</a></li>
</ul>
</li>
<li><a href="#appe-Reference_Settings_in_Administration_Portal_and_User_Portal_Windows">Appendix A: Reference: Settings in Administration Portal and VM Portal Windows</a>
<ul class="sectlevel2">
<li><a href="#sect-Explanation_of_Settings_in_the_New_Virtual_Machine_and_Edit_Virtual_Machine_Windows">Explanation of Settings in the New Virtual Machine and Edit Virtual Machine Windows</a>
<ul class="sectlevel3">
<li><a href="#Virtual_Machine_General_settings_explained">Virtual Machine General Settings Explained</a></li>
<li><a href="#Virtual_Machine_System_Settings_Explained">Virtual Machine System Settings Explained</a></li>
<li><a href="#Virtual_Machine_Initial_Run_settings_explained">Virtual Machine Initial Run Settings Explained</a></li>
<li><a href="#Virtual_Machine_Console_settings_explained">Virtual Machine Console Settings Explained</a></li>
<li><a href="#Virtual_Machine_Host_settings_explained">Virtual Machine Host Settings Explained</a></li>
<li><a href="#Virtual_Machine_High_Availability_settings_explained">Virtual Machine High Availability Settings Explained</a></li>
<li><a href="#Virtual_Machine_Resource_Allocation_settings_explained">Virtual Machine Resource Allocation Settings Explained</a></li>
<li><a href="#Virtual_Machine_Boot_Options_settings_explained">Virtual Machine Boot Options Settings Explained</a></li>
<li><a href="#Virtual_Machine_Random_Generator_Settings_Explained">Virtual Machine Random Generator Settings Explained</a></li>
<li><a href="#Virtual_Machine_Custom_Properties_settings_explained">Virtual Machine Custom Properties Settings Explained</a></li>
<li><a href="#Virtual_Machine_Icon_Settings_Explained">Virtual Machine Icon Settings Explained</a></li>
<li><a href="#Virtual_Machine_Satellite_settings_explained">Virtual Machine Foreman/Satellite Settings Explained</a></li>
</ul>
</li>
<li><a href="#Virtual_Machine_Run_Once_settings_explained">Explanation of settings in the Run Once window</a></li>
<li><a href="#Virtual_Machine_Network_Interface_dialogue_entries">Explanation of Settings in the New Network Interface and Edit Network Interface Windows</a></li>
<li><a href="#Add_Virtual_Disk_dialogue_entries">Explanation of settings in the New Virtual Disk and Edit Virtual Disk windows</a></li>
<li><a href="#Explanation_of_Settings_in_the_New_Template_and_Edit_Template_Windows">Explanation of Settings in the New Template Window</a></li>
</ul>
</li>
<li><a href="#appe-virt_sysprep_operations">Appendix B: <code>virt-sysprep</code> Operations</a></li>
<li><a href="#legal-notice">Appendix C: Legal notice</a></li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<h1 id="virtual-machine-management-guide" class="discrete">Virtual Machine Management Guide</h1>
</div>
</div>
<div class="sect1">
<h2 id="chap-Introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A virtual machine is a software implementation of a computer. The oVirt environment enables you to create virtual desktops and virtual servers.</p>
</div>
<div class="paragraph">
<p>Virtual machines consolidate computing tasks and workloads. In traditional computing environments, workloads usually run on individually administered and upgraded servers. Virtual machines reduce the amount of hardware and administration required to run the same computing tasks and workloads.</p>
</div>
<div class="sect2">
<h3 id="Audience">1.1. Audience</h3>
<div class="paragraph">
<p>Most virtual machine tasks in oVirt can be performed in both the VM Portal and Administration Portal. However, the user interface differs between each portal, and some administrative tasks require access to the Administration Portal. Tasks that can only be performed in the Administration Portal will be described as such in this book. Which portal you use, and which tasks you can perform in each portal, is determined by your level of permissions. Virtual machine permissions are explained in <a href="https://ovirt.org/documentation//virtual_machine_management_guide/index#sect-Virtual_Machines_and_Permissions">Virtual Machines and Permissions</a>.</p>
</div>
<div class="paragraph">
<p>The VM Portal&#8217;s user interface is described in the <a href="https://ovirt.org/documentation/introduction_to_the_vm_portal/index#">Introduction to the VM Portal</a>.</p>
</div>
<div class="paragraph">
<p>The Administration Portal&#8217;s user interface is described in the <a href="https://ovirt.org/documentation/administration_guide/index#">Administration Guide</a>.</p>
</div>
<div class="paragraph">
<p>The creation and management of virtual machines through the oVirt REST API is documented in the <a href="https://ovirt.github.io/ovirt-engine-api-model/4.4/index">REST API Guide</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="Supported_virtual_machines">1.2. Supported Virtual Machine Operating Systems</h3>
<div class="paragraph">
<p>For information on the operating systems that can be virtualized as guest operating systems in oVirt, see <a href="https://access.redhat.com/articles/973163" class="bare">https://access.redhat.com/articles/973163</a>.</p>
</div>
<div class="paragraph">
<p>For information on customizing the operating systems, see <a href="https://ovirt.org/documentation//virtual_machine_management_guide/index#Configuring_operating_systems_with_osinfo">Configuring operating systems with osinfo</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="Virtual_machine_performance_parameters">1.3. Virtual Machine Performance Parameters</h3>
<div class="paragraph">
<p>For information on the parameters that oVirt virtual machines can support, see <a href="https://access.redhat.com/articles/rhel-limits">Enterprise Linux technology capabilities and limits</a> and <a href="https://access.redhat.com/articles/906543">Virtualization limits for oVirt</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sect-Installing_Supporting_Components">1.4. Installing Supporting Components on Client Machines</h3>
<div class="sect3">
<h4 id="sect-Installing_Console_Components">1.4.1. Installing Console Components</h4>
<div class="paragraph">
<p>A console is a graphical window that allows you to view the start up screen, shut down screen, and desktop of a virtual machine, and to interact with that virtual machine in a similar way to a physical machine. In oVirt, the default application for opening a console to a virtual machine is Remote Viewer, which must be installed on the client machine prior to use.</p>
</div>
<div class="sect4">
<h5 id="Installing_Remote_Viewer_on_Linux">Installing Remote Viewer on Enterprise Linux</h5>
<div class="paragraph">
<p>The Remote Viewer application provides users with a graphical console for connecting to virtual machines. Once installed, it is called automatically when attempting to open a SPICE session with a virtual machine. Alternatively, it can also be used as a standalone application. Remote Viewer is included in the <code>virt-viewer</code> package provided by the base Enterprise Linux Workstation and Enterprise Linux Server repositories.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Install the <code>virt-viewer</code> package:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf install virt-viewer</pre>
</div>
</div>
</li>
<li>
<p>Restart your browser for the changes to take effect.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can now connect to your virtual machines using either the SPICE protocol or the VNC protocol.</p>
</div>
</div>
<div class="sect4">
<h5 id="Installing_Remote_Viewer_on_Windows">Installing Remote Viewer on Windows</h5>
<div class="paragraph">
<p>The Remote Viewer application provides users with a graphical console for connecting to virtual machines. Once installed, it is called automatically when attempting to open a SPICE session with a virtual machine. Alternatively, it can also be used as a standalone application.</p>
</div>
<div class="paragraph">
<p><strong>Installing Remote Viewer on Windows</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a web browser and download one of the following installers according to the architecture of your system.</p>
<div class="ulist">
<ul>
<li>
<p>Virt Viewer for 32-bit Windows:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">https://<em>your-manager-fqdn</em>/ovirt-engine/services/files/spice/virt-viewer-x86.msi</pre>
</div>
</div>
</li>
<li>
<p>Virt Viewer for 64-bit Windows:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">https://<em>your-manager-fqdn</em>/ovirt-engine/services/files/spice/virt-viewer-x64.msi</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Open the folder where the file was saved.</p>
</li>
<li>
<p>Double-click the file.</p>
</li>
<li>
<p>Click <strong>Run</strong> if prompted by a security warning.</p>
</li>
<li>
<p>Click <strong>Yes</strong> if prompted by User Account Control.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Remote Viewer is installed and can be accessed via <code>Remote Viewer</code> in the <strong>VirtViewer</strong> folder of <strong>All Programs</strong> in the start menu.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Installing_usbdk_on_Windows">1.4.2. Installing usbdk on Windows</h4>
<div class="paragraph">
<p><code>usbdk</code> is a driver that enables <code>remote-viewer</code> exclusive access to USB devices on Windows operating systems. Installing <code>usbdk</code> requires Administrator privileges. Note that the previously supported <code>USB Clerk</code> option has been deprecated and is no longer supported.</p>
</div>
<div class="paragraph">
<p><strong>Installing usbdk on Windows</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a web browser and download one of the following installers according to the architecture of your system.</p>
<div class="ulist">
<ul>
<li>
<p><code>usbdk</code> for 32-bit Windows:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">https://<em>[your manager&#8217;s address]</em>/ovirt-engine/services/files/spice/usbdk-x86.msi</pre>
</div>
</div>
</li>
<li>
<p><code>usbdk</code> for 64-bit Windows:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">https://<em>[your manager&#8217;s address]</em>/ovirt-engine/services/files/spice/usbdk-x64.msi</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Open the folder where the file was saved.</p>
</li>
<li>
<p>Double-click the file.</p>
</li>
<li>
<p>Click <strong>Run</strong> if prompted by a security warning.</p>
</li>
<li>
<p>Click <strong>Yes</strong> if prompted by User Account Control.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="Installing_Red_Hat_Enterprise_Linux_Virtual_Machines">2. Installing Enterprise Linux Virtual Machines</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Installing a Enterprise Linux virtual machine involves the following key steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://ovirt.org/documentation//virtual_machine_management_guide/index#Creating_a_virtual_machine_linux_vm">Create a virtual machine.</a> You must add a virtual disk for storage, and a network interface to connect the virtual machine to the network.</p>
</li>
<li>
<p><a href="https://ovirt.org/documentation//virtual_machine_management_guide/index#Starting_the_Virtual_Machine">Start the virtual machine</a> and install an operating system. See your operating system&#8217;s documentation for instructions.</p>
<div class="ulist">
<ul>
<li>
<p>Enterprise Linux 6: <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/Installation_Guide/index.html" class="bare">https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/Installation_Guide/index.html</a></p>
</li>
<li>
<p>Enterprise Linux 7: <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/Installation_Guide/index.html" class="bare">https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/Installation_Guide/index.html</a></p>
</li>
<li>
<p>Enterprise Linux Atomic Host 7: <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux_atomic_host/7/html-single/installation_and_configuration_guide/index" class="bare">https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux_atomic_host/7/html-single/installation_and_configuration_guide/index</a></p>
</li>
<li>
<p>Enterprise Linux 8: <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_a_standard_rhel_installation/index" class="bare">https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/performing_a_standard_rhel_installation/index</a></p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://ovirt.org/documentation//virtual_machine_management_guide/index#Enabling_the_Required_Repositories">Enable the required repositories</a> for your operating system.</p>
</li>
<li>
<p><a href="https://ovirt.org/documentation//virtual_machine_management_guide/index#Installing_Guest_Agents_and_Drivers_Linux">Install guest agents and drivers</a> for additional virtual machine functionality.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="Creating_a_virtual_machine_linux_vm">2.1. Creating a virtual machine</h3>
<div class="paragraph">
<p>When creating a new virtual machine, you specify its settings. You can edit some of these settings later, including the chipset and BIOS type. For more information, see <a href="https://ovirt.org/documentation//administration_guide/index#About_UEFI_Q35-cluster_opt_settings">UEFI and the Q35 chipset</a> in the <em>Administration Guide</em>.
.Prerequisites</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Before you can use this virtual machine, you must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Install an operating system</p>
<div class="ulist">
<ul>
<li>
<p>Use a pre-installed image by <a href="https://ovirt.org/documentation//virtual_machine_management_guide/index#Creating_a_cloned_virtual_machine_based_on_a_template">Creating a Cloned Virtual Machine Based on a Template</a></p>
</li>
<li>
<p>Use a pre-installed image from an attached pre-installed Disk</p>
</li>
<li>
<p>Install an operating system through the PXE boot menu or from an ISO file</p>
</li>
</ul>
</div>
</li>
<li>
<p>Register with the Content Delivery Network</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click <b class="button">New</b>. This opens the <strong>New Virtual Machine</strong> window.</p>
</li>
<li>
<p>Select an <strong>Operating System</strong> from the drop-down list.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you selected <strong>Enterprise Linux CoreOS</strong> as the operating system, you may need to set the initialization method by configuring <strong>Ignition</strong> settings in the <strong>Advanced Options</strong>  <code>Initial Run</code> tab. See <a href="https://ovirt.org/documentation//virtual_machine_management_guide/index#Configuring_Ignition">Configuring Ignition</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Enter a <strong>Name</strong> for the virtual machine.</p>
</li>
<li>
<p>Add storage to the virtual machine: under <strong>Instance Images</strong>, click <b class="button">Attach</b> or <b class="button">Create</b> to select or create a virtual disk .</p>
<div class="ulist">
<ul>
<li>
<p>Click <strong>Attach</strong> and select an existing virtual disk.</p>
<div class="paragraph">
<p>or</p>
</div>
</li>
<li>
<p>Click <strong>Create</strong> and enter a <strong>Size(GB)</strong> and <strong>Alias</strong> for a new virtual disk. You can accept the default settings for all other fields, or change them if required. See <a href="https://ovirt.org/documentation//virtual_machine_management_guide/index#Add_Virtual_Disk_dialogue_entries">Explanation of settings in the New Virtual Disk and Edit Virtual Disk windows</a> for more details on the fields for all disk types.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Connect the virtual machine to the network. Add a network interface by selecting a vNIC profile from the <strong>nic1</strong> drop-down list at the bottom of the <strong>General</strong> tab.</p>
</li>
<li>
<p>Specify the virtual machine&#8217;s <strong>Memory Size</strong> on the <strong>System</strong> tab.</p>
</li>
<li>
<p>In the <strong>Boot Options</strong> tab, choose the <strong>First Device</strong> that the virtual machine will use to boot.</p>
</li>
<li>
<p>You can accept the default settings for all other fields, or change them if required. For more details on all fields in the <strong>New Virtual Machine</strong> window, see <a href="https://ovirt.org/documentation//virtual_machine_management_guide/index#sect-Explanation_of_Settings_in_the_New_Virtual_Machine_and_Edit_Virtual_Machine_Windows">Explanation of settings in the New Virtual Machine and Edit Virtual Machine Windows</a>.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The new virtual machine is created and displays in the list of virtual machines with a status of <code>Down</code>.</p>
</div>
<div id="Configuring_Ignition" class="paragraph">
<div class="title">Configuring Ignition</div>
<p>Ignition is the utility that is used by Enterprise Linux CoreOS to manipulate disks during initial configuration. It completes common disk tasks, including partitioning disks, formatting partitions, writing files, and configuring users. On first boot, Ignition reads its configuration from the installation media or the location that you specify and applies the configuration to the machines.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Once Ignition has been configured as the initialization method, it cannot be reversed or re-configured.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <code>Add Virtual Machine</code> or <code>Edit Virtual Machine</code> screen, click <b class="button">Show Advanced Options</b>.</p>
</li>
<li>
<p>In the <code>Initial Run</code> tab, select the <strong>Ignition 2.3.0</strong> option and enter the <strong>VM Hostname</strong>.</p>
</li>
<li>
<p>Expand the <strong>Authorization</strong> option, enter a hashed (SHA-512) password, and enter the password again to verify.</p>
</li>
<li>
<p>If you are using SSH keys for authorization, enter them in the space provided.</p>
</li>
<li>
<p>You can also enter a custom Ignition script in JSON format in the <strong>Ignition Script</strong> field. This script will run on the virtual machine when it starts. The scripts you enter in this field are custom JSON sections that are added to those produced by the Engine, and allow you to use custom Ignition instructions.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the Enterprise Linux CoreOS image you are using contains an Ignition version different than 2.3.0, you need to use a script in the <strong>Ignition Script</strong> field to enforce the Ignition version included in your Enterprise Linux CoreOS image.</p>
</div>
<div class="paragraph">
<p>When you use an Ignition script, the script instructions take precedence over and override any conflicting Ignition settings you configured in the UI.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Starting_the_Virtual_Machine">2.2. Starting the Virtual Machine</h3>
<div class="sect3">
<h4 id="Powering_on_a_virtual_machine">2.2.1. Starting a Virtual Machine</h4>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine with a status of <code>Down</code>.</p>
</li>
<li>
<p>Click <b class="button">Run</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The <strong>Status</strong> of the virtual machine changes to <code>Up</code>, and the operating system installation begins. Open a console to the virtual machine if one does not open automatically.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A virtual machine will not start on a host with an overloaded CPU. By default, a host&#8217;s CPU is considered overloaded if it has a load of more than 80% for 5 minutes, but these values can be changed using scheduling policies. See <a href="https://ovirt.org/documentation/administration_guide/index#sect-Scheduling_Policies">Scheduling Policies</a> in the <em>Administration Guide</em> for more information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Troubleshooting</div>
<p>Scenario - the virtual machine fails to boot with the following error message:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Boot failed: not a bootable disk - No Bootable device</pre>
</div>
</div>
<div class="paragraph">
<p>Possible solutions to this problem:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make sure that <strong>hard disk</strong> is selected in the boot sequence, and the disk that the virtual machine is booting from must be set as <strong>Bootable</strong>.</p>
</li>
<li>
<p>Create a <a href="https://ovirt.org/documentation//virtual_machine_management_guide/index#Creating_a_cloned_virtual_machine_based_on_a_template">Cloned Virtual Machine Based on a Template</a>.</p>
</li>
<li>
<p>Create a new virtual machine with a local boot disk managed by oVirt that contains the OS and application binaries.</p>
</li>
<li>
<p>Install the OS by booting from the <strong>Network (PXE)</strong> boot option.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="Opening_a_Console_to_a_Virtual_Machine_linux_vm">2.2.2. Opening a console to a virtual machine</h4>
<div class="paragraph">
<p>Use Remote Viewer to connect to a virtual machine.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Install Remote Viewer if it is not already installed. See <a href="#sect-Installing_Console_Components">Installing Console Components</a>.</p>
</li>
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Console</b>. By default, the browser prompts you to download a file named <code>console.vv</code>. When you click to open the file, a console window opens for the virtual machine. You can configure your browser to automatically open these files, such that clicking <b class="button">Console</b> simply opens the console.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>console.vv</code> expires after 120 seconds. If more than 120 seconds elapse between the time the file is downloaded and the time that you open the file, click <b class="button">Console</b> again.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="#Automatically_connecting_to_a_Virtual_Machine">Automatically Connecting to a Virtual Machine</a></p>
</li>
<li>
<p><a href="#sect-Configuring_Console_Options">Configuring Console Options</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="Opening_a_Serial_Console_to_a_Virtual_Machine">Opening a Serial Console to a Virtual Machine</h5>
<div class="paragraph">
<p>You can access a virtual machine&#8217;s serial console from the command line instead of opening a console from the Administration Portal or the VM Portal. The serial console is emulated through VirtIO channels, using SSH and key pairs. The Engine acts as a proxy for the connection, provides information about virtual machine placement, and stores the authentication keys. You can add public keys for each user from either the Administration Portal or the VM Portal. You can access serial consoles for only those virtual machines for which you have appropriate permissions.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To access the serial console of a virtual machine, the user must have <strong>UserVmManager</strong>, <strong>SuperUser</strong>, or <strong>UserInstanceManager</strong> permission on that virtual machine. These permissions must be explicitly defined for each user. It is not enough to assign these permissions to <strong>Everyone</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The serial console is accessed through TCP port 2222 on the Engine. This port is opened during <code>engine-setup</code> on new installations. To change the port, see <a href="https://github.com/oVirt/ovirt-vmconsole/blob/master/README#L116">ovirt-vmconsole/README</a>.</p>
</div>
<div class="paragraph">
<p>Using a serial console requires configuring the firewall rules. For more information, see:
* <a href="https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/html-single/planning_and_prerequisites_guide/index#RHV-manager-firewall-requirements_RHV_planning">Rule "M3" in the oVirt Engine Firewall Requirements</a>
* <a href="https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/html-single/planning_and_prerequisites_guide/index#host-firewall-requirements_RHV_planning">Rule "H2" in the Host Firewall Requirements</a></p>
</div>
<div class="paragraph">
<p>The serial console relies on the <code>ovirt-vmconsole</code> package and the <code>ovirt-vmconsole-proxy</code> on the Engine, and the <code>ovirt-vmconsole</code> package and the <code>ovirt-vmconsole-host</code> package on the virtualization hosts. These packages are installed by default on new installations. To install the packages on existing installations, reinstall the host. See <a href="https://ovirt.org/documentation/administration_guide/index#Reinstalling_Hosts">Reinstalling Hosts</a> in the <em>Administration Guide</em>.</p>
</div>
<div class="paragraph">
<p><strong>Enabling a Virtual Machine&#8217;s Serial Console</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On the virtual machine whose serial console you are accessing, add the following lines to <strong>/etc/default/grub</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">GRUB_CMDLINE_LINUX_DEFAULT="console=tty0 console=ttyS0,115200n8"
GRUB_TERMINAL="console serial"
GRUB_SERIAL_COMMAND="serial --speed=115200 --unit=0 --word=8 --parity=no --stop=1"</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>GRUB_CMDLINE_LINUX_DEFAULT</code> applies this configuration only to the default menu entry. Use <code>GRUB_CMDLINE_LINUX</code> to apply the configuration to all the menu entries.</p>
</div>
<div class="paragraph">
<p>If these lines already exist in <strong>/etc/default/grub</strong>, update them. Do not duplicate them.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Rebuild <strong>/boot/grub2/grub.cfg</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>BIOS-based machines:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># grub2-mkconfig -o /boot/grub2/grub.cfg</pre>
</div>
</div>
</li>
<li>
<p>UEFI-based machines:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># grub2-mkconfig -o /boot/efi/EFI/redhat/grub.cfg</pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/system_administrators_guide/ch-working_with_the_grub_2_boot_loader#sec-GRUB_2_over_a_Serial_Console">GRUB 2 over a Serial Console</a> in the <em>Enterprise Linux 7 System Administrator&#8217;s Guide</em> for details.</p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>On the client machine from which you are accessing the virtual machine serial console, generate an SSH key pair. The Engine supports standard SSH key types, for example, an RSA key:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ssh-keygen -t rsa -b 2048 -C "<em>user@domain</em>" -f .ssh/serialconsolekey</pre>
</div>
</div>
<div class="paragraph">
<p>This command generates a public key and a private key.</p>
</div>
</li>
<li>
<p>In the Administration Portal or the VM Portal, click the name of the signed-in user on the header bar and click <strong>Options</strong>. This opens the <strong>Edit Options</strong> window.</p>
</li>
<li>
<p>In the <strong>User&#8217;s Public Key</strong> text field, paste the public key of the client machine that will be used to access the serial console.</p>
</li>
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>In the <strong>Console</strong> tab of the <strong>Edit Virtual Machine</strong> window, select the <strong>Enable VirtIO serial console</strong> check box.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Connecting to a Virtual Machine&#8217;s Serial Console</strong></p>
</div>
<div class="paragraph">
<p>On the client machine, connect to the virtual machine&#8217;s serial console:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If a single virtual machine is available, this command connects the user to that virtual machine:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ssh -t -p 2222 ovirt-vmconsole@<em>Manager_FQDN</em> -i .ssh/serialconsolekey
Enterprise Linux Server release 6.7 (Santiago)
Kernel 2.6.32-573.3.1.el6.x86_64 on an x86_64
<em>USER</em> login:</pre>
</div>
</div>
</li>
<li>
<p>If more than one virtual machine is available, this command lists the available virtual machines and their IDs:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ssh -t -p 2222 ovirt-vmconsole@<em>Manager_FQDN</em> -i .ssh/serialconsolekey list
1. vm1 [vmid1]
2. vm2 [vmid2]
3. vm3 [vmid3]
&gt; 2
Enterprise Linux Server release 6.7 (Santiago)
Kernel 2.6.32-573.3.1.el6.x86_64 on an x86_64
<em>USER</em> login:</pre>
</div>
</div>
<div class="paragraph">
<p>Enter the number of the machine to which you want to connect, and press <code>Enter</code>.</p>
</div>
</li>
<li>
<p>Alternatively, connect directly to a virtual machine using its unique identifier or its name:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ssh -t -p 2222 ovirt-vmconsole@<em>Manager_FQDN</em> connect --vm-id <em>vmid1</em></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ssh -t -p 2222 ovirt-vmconsole@<em>Manager_FQDN</em> connect --vm-name <em>vm1</em></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Disconnecting from a Virtual Machine&#8217;s Serial Console</strong></p>
</div>
<div class="paragraph">
<p>Press any key followed by <strong><code>~ .</code></strong> to close a serial console session.</p>
</div>
<div class="paragraph">
<p>If the serial console session is disconnected abnormally, a TCP timeout occurs. You will be unable to reconnect to the virtual machine&#8217;s serial console until the timeout period expires.</p>
</div>
</div>
<div class="sect4">
<h5 id="Automatically_connecting_to_a_Virtual_Machine">Automatically Connecting to a Virtual Machine</h5>
<div class="paragraph">
<p>Once you have logged in, you can automatically connect to a single running virtual machine. This can be configured in the VM Portal.</p>
</div>
<div class="paragraph">
<p><strong>Automatically Connecting to a Virtual Machine</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the Virtual Machines page, click the name of the virtual machine to go to the details view.</p>
</li>
<li>
<p>Click the pencil icon beside <strong>Console</strong> and set <strong>Connect automatically</strong> to <strong>ON</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The next time you log into the VM Portal, if you have only one running virtual machine, you will automatically connect to that machine.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Enabling_the_Required_Repositories">2.3. Enabling the Required Repositories</h3>
<div class="paragraph">
<p>To install packages signed by Red Hat you must register the target system to the Content Delivery Network. Then, use an entitlement from your subscription pool and enable the required repositories.</p>
</div>
<div class="paragraph">
<p><strong>Enabling the Required Repositories Using Subscription Engine</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Register your system with the Content Delivery Network, entering your Customer Portal user name and password when prompted:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager register</pre>
</div>
</div>
</li>
<li>
<p>Locate the relevant subscription pools and note down the pool identifiers:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager list --available</pre>
</div>
</div>
</li>
<li>
<p>Use the pool identifiers to attach the required subscriptions:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager attach --pool=<em>pool_id</em></pre>
</div>
</div>
</li>
<li>
<p>When a system is attached to a subscription pool with multiple repositories, only the main repository is enabled by default. Others are available, but disabled. Enable any additional repositories:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos --enable=<em>repository</em></pre>
</div>
</div>
</li>
<li>
<p>Ensure that all packages currently installed are up to date:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf upgrade --nobest</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For versions of Enterprise Linux earlier than 8, use the command <code>yum update</code> instead of <code>dnf upgrade</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum update</pre>
</div>
</div>
<div class="paragraph">
<p>See also <a href="https://access.redhat.com/solutions/5480561">Cannot perform yum update on my RHV manager (ansible conflict)</a></p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Installing_Guest_Agents_and_Drivers_Linux">2.4. Installing Guest Agents and Drivers</h3>
<div class="sect3">
<h4 id="Red_Hat_Virtualization_Guest_Agents_and_Drivers_linux_vm">2.4.1. oVirt Guest agents, tools, and drivers</h4>
<div class="paragraph">
<p>The oVirt guest agents, tools, and drivers provide additional functionality for virtual machines, such as gracefully shutting down or rebooting virtual machines from the VM Portal and Administration Portal. The tools and agents also provide information for virtual machines, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resource usage</p>
</li>
<li>
<p>IP addresses</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The guest agents, tools and drivers are distributed as an ISO file that you can attach to virtual machines. This ISO file is packaged as an RPM file that you can install and upgrade from the Engine machine.</p>
</div>
<div class="paragraph">
<p>You need to install the guest agents and drivers on a virtual machine to enable this functionality for that machine.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. oVirt Guest drivers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Driver</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Works on</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>virtio-net</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Paravirtualized network driver provides enhanced performance over emulated devices like rtl.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>virtio-block</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Paravirtualized HDD driver offers increased I/O performance over emulated devices like IDE by optimizing the coordination and communication between the virtual machine and the hypervisor. The driver complements the software implementation of the virtio-device used by the host to play the role of a hardware device.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>virtio-scsi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Paravirtualized iSCSI HDD driver offers similar functionality to the virtio-block device, with some additional enhancements. In particular, this driver supports adding hundreds of devices, and names devices using the standard SCSI device naming scheme.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>virtio-serial</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtio-serial provides support for multiple serial ports. The improved performance is used for fast communication between the virtual machine and the host that avoids network complications. This fast communication is required for the guest agents and for other features such as clipboard copy-paste between the virtual machine and the host and logging.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>virtio-balloon</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtio-balloon is used to control the amount of memory a virtual machine actually accesses. It offers improved memory overcommitment.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>qxl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A paravirtualized display driver reduces CPU usage on the host and provides better performance through reduced network bandwidth on most workloads.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. oVirt Guest agents and tools</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Guest agent/tool</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Works on</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>qemu-guest-agent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used instead of <code>ovirt-guest-agent-common</code> on Enterprise Linux 8 virtual machines. It is installed and enabled by default.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>spice-agent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The SPICE agent supports multiple monitors and is responsible for client-mouse-mode support to provide a better user experience and improved responsiveness than the QEMU emulation. Cursor capture is not needed in client-mouse-mode. The SPICE agent reduces bandwidth usage when used over a wide area network by reducing the display level, including color depth, disabling wallpaper, font smoothing, and animation. The SPICE agent enables clipboard support allowing cut and paste operations for both text and images between client and virtual machine, and automatic guest display setting according to client-side settings. On Windows-based virtual machines, the SPICE agent consists of vdservice and vdagent.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Installing_the_Guest_Agents_and_Drivers_on_Red_Hat_Enterprise_Linux">2.4.2. Installing the Guest Agents and Drivers on Enterprise Linux</h4>
<div class="paragraph">
<p>The oVirt guest agents and drivers are provided by the oVirt Agent repository.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Enterprise Linux 8 virtual machines use the <code>qemu-guest-agent</code> service, which is installed and enabled by default, instead of the <code>ovirt-guest-agent</code> service. If you need to manually install the guest agent on RHEL 8, follow the procedure below.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to the Enterprise Linux virtual machine.</p>
</li>
<li>
<p>Enable the oVirt Agent repository:</p>
<div class="ulist">
<ul>
<li>
<p>For Enterprise Linux 6</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos --enable=rhel-6-server-rhv-4-agent-rpms</pre>
</div>
</div>
</li>
<li>
<p>For Enterprise Linux 7</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos --enable=rhel-7-server-rh-common-rpms</pre>
</div>
</div>
</li>
<li>
<p>For Enterprise Linux 8</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos --enable=rhel-8-for-x86_64-appstream-rpms</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Install the guest agent and dependencies:</p>
<div class="ulist">
<ul>
<li>
<p>For Enterprise Linux 6 or 7, install the ovirt guest agent:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum install ovirt-guest-agent-common</pre>
</div>
</div>
</li>
<li>
<p>For Enterprise Linux 8, install the qemu guest agent:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum install qemu-guest-agent</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Start and enable the <code>ovirt-guest-agent</code> service:</p>
<div class="ulist">
<ul>
<li>
<p>For Enterprise Linux 6</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># service ovirt-guest-agent start
# chkconfig ovirt-guest-agent on</pre>
</div>
</div>
</li>
<li>
<p>For Enterprise Linux 7</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl start ovirt-guest-agent
# systemctl enable ovirt-guest-agent</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Start and enable the <code>qemu-guest-agent</code> service:</p>
<div class="ulist">
<ul>
<li>
<p>For Enterprise Linux 6</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># service qemu-ga start
# chkconfig qemu-ga on</pre>
</div>
</div>
</li>
<li>
<p>For Enterprise Linux 7 or 8</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl start qemu-guest-agent
# systemctl enable qemu-guest-agent</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The guest agent now passes usage information to the oVirt Engine. You can configure the guest agent in the <code>/etc/ovirt-guest-agent.conf</code> file.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chap-Installing_Windows_Virtual_Machines">3. Installing Windows virtual machines</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Installing a Windows virtual machine involves the following key steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a blank virtual machine on which to install an operating system.</p>
</li>
<li>
<p>Add a virtual disk for storage.</p>
</li>
<li>
<p>Add a network interface to connect the virtual machine to the network.</p>
</li>
<li>
<p>Attach the Windows guest tools CD to the virtual machine so that VirtIO-optimized device drivers can be installed during the operating system installation.</p>
</li>
<li>
<p>Install a Windows operating system on the virtual machine. See your operating system&#8217;s documentation for instructions.</p>
</li>
<li>
<p>During the installation, install guest agents and drivers for additional virtual machine functionality.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When all of these steps are complete, the new virtual machine is functional and ready to perform tasks.</p>
</div>
<div class="sect2">
<h3 id="Creating_a_virtual_machine_windows_vm">3.1. Creating a virtual machine</h3>
<div class="paragraph">
<p>When creating a new virtual machine, you specify its settings. You can edit some of these settings later, including the chipset and BIOS type. For more information, see <a href="https://ovirt.org/documentation//administration_guide/index#About_UEFI_Q35-cluster_opt_settings">UEFI and the Q35 chipset</a> in the <em>Administration Guide</em>.
.Prerequisites</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Before you can use this virtual machine, you must:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Install an operating system</p>
</li>
<li>
<p>Install a VirtIO-optimized disk and network drivers</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>You can change the default virtual machine name length with the <code>engine-config</code> tool. Run the following command on the Engine machine:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># engine-config --set MaxVmNameLength=<em>integer</em></pre>
</div>
</div>
</li>
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click <b class="button">New</b>. This opens the <strong>New Virtual Machine</strong> window.</p>
</li>
<li>
<p>Select an <strong>Operating System</strong> from the drop-down list.</p>
</li>
<li>
<p>Enter a <strong>Name</strong> for the virtual machine.</p>
</li>
<li>
<p>Add storage to the virtual machine: under <strong>Instance Images</strong>, click <b class="button">Attach</b> or <b class="button">Create</b> to select or create a virtual disk .</p>
<div class="ulist">
<ul>
<li>
<p>Click <strong>Attach</strong> and select an existing virtual disk.</p>
<div class="paragraph">
<p>or</p>
</div>
</li>
<li>
<p>Click <strong>Create</strong> and enter a <strong>Size(GB)</strong> and <strong>Alias</strong> for a new virtual disk. You can accept the default settings for all other fields, or change them if required. See <a href="https://ovirt.org/documentation//virtual_machine_management_guide/index#Add_Virtual_Disk_dialogue_entries">Explanation of settings in the New Virtual Disk and Edit Virtual Disk windows</a> for more details on the fields for all disk types.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Connect the virtual machine to the network. Add a network interface by selecting a vNIC profile from the <strong>nic1</strong> drop-down list at the bottom of the <strong>General</strong> tab.</p>
</li>
<li>
<p>Specify the virtual machine&#8217;s <strong>Memory Size</strong> on the <strong>System</strong> tab.</p>
</li>
<li>
<p>In the <strong>Boot Options</strong> tab, choose the <strong>First Device</strong> that the virtual machine will use to boot.</p>
</li>
<li>
<p>You can accept the default settings for all other fields, or change them if required. For more details on all fields in the <strong>New Virtual Machine</strong> window, see <a href="https://ovirt.org/documentation//virtual_machine_management_guide/index#sect-Explanation_of_Settings_in_the_New_Virtual_Machine_and_Edit_Virtual_Machine_Windows">Explanation of settings in the New Virtual Machine and Edit Virtual Machine Windows</a>.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The new virtual machine is created and displays in the list of virtual machines with a status of <code>Down</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sect-Starting_the_Virtual_Machine_Using_the_Run_Once_Option">3.2. Starting the virtual machine using Run Once</h3>
<div class="sect3">
<h4 id="Installing_Windows_on_Virtio_Optimized_Hardware">3.2.1. Installing Windows on VirtIO-optimized hardware</h4>
<div class="paragraph">
<p>Install VirtIO-optimized disk and network device drivers during your Windows installation by attaching the <code>virtio-win<em>_version</em>.iso</code> file to your virtual machine. These drivers provide a performance improvement over emulated device drivers.</p>
</div>
<div class="paragraph">
<p>Use the <strong>Run Once</strong> option to attach the <code>virtio-win<em>_version</em>.iso</code> file in a one-off boot different from the <strong>Boot Options</strong> defined in the <strong>New Virtual Machine</strong> window.</p>
</div>
<div class="paragraph">
<div class="title">Prerequisites</div>
<p>The following items have been added to the virtual machine:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a <strong>Red Hat VirtIO</strong> network interface.</p>
</li>
<li>
<p>a disk that uses the <strong>VirtIO</strong> interface. This disk can be on a</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can upload <code>virtio-win<em>_version</em>.iso</code> to a data storage domain.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>oVirt recommends uploading ISO images to the data domain with the Administration Portal or with the REST API. For more information, see <a href="https://ovirt.org/documentation/administration_guide/index#Uploading_Images_to_a_Data_Storage_Domain_storage_tasks">Uploading Images to a Data Storage Domain</a> in the <em>Administration Guide</em>.</p>
</div>
<div class="paragraph">
<p>If necessary, you can upload the <code>virtio-win</code> ISO file to an ISO storage domain that is hosted on the Engine. The ISO storage domain type is deprecated. For more information, see <a href="https://ovirt.org/documentation/administration_guide/index#Copy_ISO_to_ISO_domain-storage_tasks">Uploading images to an ISO domain</a> in the <em>Administration Guide</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To install the virtio-win drivers when installing Windows, complete the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <span class="menuseq"><b class="menu">Run</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Run Once</b></span>.</p>
</li>
<li>
<p>Expand the <strong>Boot Options</strong> menu.</p>
</li>
<li>
<p>Select the <strong>Attach CD</strong> check box, and select a Windows ISO from the drop-down list.</p>
</li>
<li>
<p>Select the <strong>Attach Windows guest tools CD</strong> check box.</p>
</li>
<li>
<p>Move <strong>CD-ROM</strong> to the top of the <strong>Boot Sequence</strong> field.</p>
</li>
<li>
<p>Configure other <strong>Run Once</strong> options as required. See <a href="#Virtual_Machine_Run_Once_settings_explained">Explanation of settings in the Run Once window</a> for more details.</p>
</li>
<li>
<p>Click <b class="button">OK</b>. The status of the virtual machine changes to <strong>Up</strong>, and the operating system installation begins.</p>
<div class="paragraph">
<p>Open a console to the virtual machine if one does not open automatically during the Windows installation.</p>
</div>
</li>
<li>
<p>When prompted to select a drive onto which you want to install Windows, click <b class="button">Load driver</b> and <b class="button">OK</b>.</p>
</li>
<li>
<p>Under <strong>Select the driver to install</strong>, select the appropriate driver for the version of Windows. For example, for Windows Server 2019, select <strong>Red Hat VirtIO SCSI controller (E:\amd64\2k19\viostor.inf)</strong></p>
</li>
<li>
<p>Click Next.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The rest of the installation proceeds as normal.</p>
</div>
</div>
<div class="sect3">
<h4 id="Opening_a_Console_to_a_Virtual_Machine_windows_vm">3.2.2. Opening a console to a virtual machine</h4>
<div class="paragraph">
<p>Use Remote Viewer to connect to a virtual machine.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Install Remote Viewer if it is not already installed. See <a href="#sect-Installing_Console_Components">Installing Console Components</a>.</p>
</li>
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Console</b>. By default, the browser prompts you to download a file named <code>console.vv</code>. When you click to open the file, a console window opens for the virtual machine. You can configure your browser to automatically open these files, such that clicking <b class="button">Console</b> simply opens the console.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>console.vv</code> expires after 120 seconds. If more than 120 seconds elapse between the time the file is downloaded and the time that you open the file, click <b class="button">Console</b> again.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="#Automatically_connecting_to_a_Virtual_Machine">Automatically Connecting to a Virtual Machine</a></p>
</li>
<li>
<p><a href="#sect-Configuring_Console_Options">Configuring Console Options</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Installing_Guest_Agents_and_Drivers_Windows">3.3. Installing guest agents and drivers</h3>
<div class="sect3">
<h4 id="Red_Hat_Virtualization_Guest_Agents_and_Drivers_windows_vm">3.3.1. oVirt Guest agents, tools, and drivers</h4>
<div class="paragraph">
<p>The oVirt guest agents, tools, and drivers provide additional functionality for virtual machines, such as gracefully shutting down or rebooting virtual machines from the VM Portal and Administration Portal. The tools and agents also provide information for virtual machines, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resource usage</p>
</li>
<li>
<p>IP addresses</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The guest agents, tools and drivers are distributed as an ISO file that you can attach to virtual machines. This ISO file is packaged as an RPM file that you can install and upgrade from the Engine machine.</p>
</div>
<div class="paragraph">
<p>You need to install the guest agents and drivers on a virtual machine to enable this functionality for that machine.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. oVirt Guest drivers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Driver</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Works on</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>virtio-net</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Paravirtualized network driver provides enhanced performance over emulated devices like rtl.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>virtio-block</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Paravirtualized HDD driver offers increased I/O performance over emulated devices like IDE by optimizing the coordination and communication between the virtual machine and the hypervisor. The driver complements the software implementation of the virtio-device used by the host to play the role of a hardware device.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>virtio-scsi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Paravirtualized iSCSI HDD driver offers similar functionality to the virtio-block device, with some additional enhancements. In particular, this driver supports adding hundreds of devices, and names devices using the standard SCSI device naming scheme.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>virtio-serial</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtio-serial provides support for multiple serial ports. The improved performance is used for fast communication between the virtual machine and the host that avoids network complications. This fast communication is required for the guest agents and for other features such as clipboard copy-paste between the virtual machine and the host and logging.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>virtio-balloon</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtio-balloon is used to control the amount of memory a virtual machine actually accesses. It offers improved memory overcommitment.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>qxl</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A paravirtualized display driver reduces CPU usage on the host and provides better performance through reduced network bandwidth on most workloads.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. oVirt Guest agents and tools</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Guest agent/tool</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Works on</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>qemu-guest-agent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used instead of <code>ovirt-guest-agent-common</code> on Enterprise Linux 8 virtual machines. It is installed and enabled by default.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>spice-agent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The SPICE agent supports multiple monitors and is responsible for client-mouse-mode support to provide a better user experience and improved responsiveness than the QEMU emulation. Cursor capture is not needed in client-mouse-mode. The SPICE agent reduces bandwidth usage when used over a wide area network by reducing the display level, including color depth, disabling wallpaper, font smoothing, and animation. The SPICE agent enables clipboard support allowing cut and paste operations for both text and images between client and virtual machine, and automatic guest display setting according to client-side settings. On Windows-based virtual machines, the SPICE agent consists of vdservice and vdagent.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Server and Desktop.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Installing_the_Guest_Agents_and_Drivers_on_Windows">3.3.2. Installing the guest agents, tools, and drivers on Windows</h4>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To install the guest agents, tools, and drivers on a Windows virtual machine, complete the following steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On the Engine machine, install the <code>virtio-win</code> package:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf install virtio-win*</pre>
</div>
</div>
<div class="paragraph">
<p>After you install the package, the ISO file is located in <code class="filename">/usr/share/virtio-win/virtio-win<em>_version</em>.iso</code> on the Engine machine.</p>
</div>
</li>
<li>
<p>Upload <code class="filename">virtio-win<em>_version</em>.iso</code> to a data storage domain. See <a href="https://ovirt.org/documentation/administration_guide/index#Uploading_Images_to_a_Data_Storage_Domain_storage_tasks">Uploading Images to a Data Storage Domain</a> in the <em>Administration Guide</em> for details.</p>
</li>
<li>
<p>In the Administration or VM Portal, if the virtual machine is running, use the <strong>Change CD</strong> button to attach the <code class="filename">virtio-win<em>_version</em>.iso</code> file to each of your virtual machines. If the virtual machine is powered off, click the <strong>Run Once</strong> button and attach the ISO as a CD.</p>
</li>
<li>
<p>Log in to the virtual machine.</p>
</li>
<li>
<p>Select the CD Drive containing the <code class="filename">virtio-win<em>_version</em>.iso</code> file. You can complete the installation with either the GUI or the command line.</p>
</li>
<li>
<p>Run the installer.</p>
<div class="dlist">
<dl>
<dt class="hdlist1">To install with the GUI, complete the following steps</dt>
<dd>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Double-click <code>virtio-win-gt-x64.msi</code> or <code>virtio-win-gt-x86.msi</code>.</p>
</li>
<li>
<p>Click <b class="button">Next</b> at the welcome screen.</p>
</li>
<li>
<p>Follow the prompts in the installation wizard.</p>
</li>
<li>
<p>When installation is complete, select <strong>Yes, I want to restart my computer now</strong> and click <strong>Finish</strong> to apply the changes.</p>
</li>
<li>
<p>After the virtual machine reboots, open the CD-ROM and go to the <code class="filename">guest-agent</code> directory and double-click <code class="filename">qemu-ga-x86_64.msi</code> or <code class="filename">qemu-ga-i386.msi</code>, to install qemu-ga, the Qemu guest agent.</p>
</li>
</ol>
</div>
</dd>
<dt class="hdlist1">To install silently with the command line, complete the following steps</dt>
<dd>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Open a command prompt with Administrator privileges.</p>
</li>
<li>
<p>Enter the <code class="cmd">msiexec</code> command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">D:\ msiexec /i "<em>PATH_TO_MSI</em>" /qn [/l*v "<em>PATH_TO_LOG</em>"][/norestart] ADDLOCAL=ALL</pre>
</div>
</div>
<div class="paragraph">
<p>Other possible values for ADDLOCAL are listed below.</p>
</div>
<div class="paragraph">
<p>For example, to run the installation when <code>virtio-win-gt-x64.msi</code> is on the <code>D:\</code> drive, without saving the log, and then immediately restart the virtual machine, enter the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">D:\ msiexec /i "virtio-win-gt-x64.msi" /qn ADDLOCAL=ALL</pre>
</div>
</div>
</li>
</ol>
</div>
</dd>
</dl>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>After installation completes, the guest agents and drivers pass usage information to the oVirt Engine and enable you to access USB devices and other functionality.</p>
</div>
<div class="sect4">
<h5 id="values-for-addlocal-to-customize-virtio-win-command-line-installation">Values for ADDLOCAL to customize virtio-win command-line installation</h5>
<div class="paragraph">
<p>When installing <code class="filename">virtio-win-gt-x64.msi</code> or <code class="filename">virtio-win-gt-x32.msi</code> with the command line, you can install any one driver, or any combination of drivers.</p>
</div>
<div class="paragraph">
<p>You can also install specific agents, but you must also install each agent&#8217;s corresponding drivers.</p>
</div>
<div class="paragraph">
<p>The <code>ADDLOCAL</code> parameter of the <code class="cmd">msiexec</code> command enables you to specify which drivers or agents to install. <code>ADDLOCAL=ALL</code> installs all drivers and agents. Other values are listed in the following tables.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Possible values for ADDLOCAL to install drivers</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Value for ADDLOCAL</th>
<th class="tableblock halign-left valign-top">Driver Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FE_network_driver</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>virtio-net</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Paravirtualized network driver provides enhanced performance over emulated devices like rtl.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FE_balloon_driver</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>virtio-balloon</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Controls the amount of memory a virtual machine actually accesses. It offers improved memory overcommitment.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FE_pvpanic_driver</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pvpanic</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QEMU pvpanic device driver.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FE_qemufwcfg_driver</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>qemufwcfg</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QEMU FWCfg device driver.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FE_qemupciserial_driver</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>qemupciserial</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QEMU PCI serial device driver.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FE_spice_driver</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Spice Driver</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A paravirtualized display driver reduces CPU usage on the host and provides better performance through reduced network bandwidth on most workloads.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FE_vioinput_driver</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vioinput</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VirtIO Input Driver.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FE_viorng_driver</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>viorng</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VirtIO RNG device driver.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FE_vioscsi_driver</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vioscsi</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VirtIO SCSI pass-through controller.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FE_vioserial_driver</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vioserial</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VirtIO Serial device driver.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FE_viostor_driver</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>viostor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VirtIO Block driver.</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Possible values for ADDLOCAL to install agents and required corresponding drivers</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Agent</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Corresponding driver(s)</th>
<th class="tableblock halign-left valign-top">Value for <code>ADDLOCAL</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spice Agent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Supports multiple monitors, responsible for client-mouse-mode support, reduces bandwidth usage, enables clipboard support between client and virtual machine, provide a better user experience and improved responsiveness.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>vioserial</code> and Spice driver</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FE_spice_Agent,FE_vioserial_driver,FE_spice_driver</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<div class="title">Examples</div>
<p>The following command installs only the VirtIO SCSI pass-through controller, the VirtIO Serial device driver, and the VirtIO Block driver:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">D:\ msiexec /i "virtio-win-gt-x64.msi" /qn ADDLOCAL=`FE_vioscsi_driver,FE_vioserial_driver,FE_viostor_driver</pre>
</div>
</div>
<div class="paragraph">
<p>The following command installs only the Spice Agent and its required corresponding drivers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">D:\ msiexec /i "virtio-win-gt-x64.msi" /qn ADDLOCAL = FE_spice_Agent,FE_vioserial_driver,FE_spice_driver</pre>
</div>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="#Updating_Win_Guest_Drivers_with_Windows_Updates">Updating Windows drivers with Windows Update</a></p>
</li>
<li>
<p><a href="#Updating_the_Guest_Agents_and_Drivers_on_Windows">Updating Windows guest agents and drivers using the command prompt</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Microsoft Developer website:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.microsoft.com/en-us/windows/win32/msi/windows-installer-portal">Windows Installer</a></p>
</li>
<li>
<p><a href="https://docs.microsoft.com/en-us/windows/win32/msi/command-line-options">Command-Line Options</a> for the Windows installer</p>
</li>
<li>
<p><a href="https://docs.microsoft.com/en-us/windows/win32/msi/property-reference">Property Reference</a> for the Windows installer</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chap-Additional_Configuration">4. Additional Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="Configuring_operating_systems_with_osinfo">4.1. Configuring Operating Systems with osinfo</h3>
<div class="paragraph">
<p>oVirt stores operating system configurations for virtual machines in <strong>/etc/ovirt-engine/osinfo.conf.d/00-defaults.properties</strong>. This file contains default values such as <code>os.other.devices.display.protocols.value = spice/qxl,vnc/vga,vnc/qxl</code>.</p>
</div>
<div class="paragraph">
<p>There are only a limited number of scenarios in which you would change these values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adding an operating system that does not appear in the list of supported guest operating systems</p>
</li>
<li>
<p>Adding a product key (for example, <code>os.windows_10x64.productKey.value =</code>)</p>
</li>
<li>
<p>Configuring the <code>sysprep</code> path for a Windows virtual machine (for example, <code>os.windows_10x64.sysprepPath.value = ${ENGINE_USR}/conf/sysprep/sysprep.w10x64</code>)</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not edit the actual <strong>00-defaults.properties</strong> file. Changes will be overwritten if you upgrade or restore the Engine.</p>
</div>
<div class="paragraph">
<p>Do not change values that come directly from the operating system or the Engine, such as maximum memory size.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>To change the operating system configurations, create an override file in <strong>/etc/ovirt-engine/osinfo.conf.d/</strong>. The file name must begin with a value greater than <code>00</code>, so that the file appears after <strong>/etc/ovirt-engine/osinfo.conf.d/00-defaults.properties</strong>, and ends with the extension, <strong>.properties</strong>.</p>
</div>
<div class="paragraph">
<p>For example, <strong>10-productkeys.properties</strong> overrides the default file, <strong>00-defaults.properties</strong>. The last file in the file list has precedence over earlier files.</p>
</div>
</div>
<div class="sect2">
<h3 id="sect-Configuring_Single_Sign-On_for_Virtual_Machines">4.2. Configuring Single Sign-On for Virtual Machines</h3>
<div class="paragraph">
<p>Configuring single sign-on, also known as password delegation, allows you to automatically log in to a virtual machine using the credentials you use to log in to the VM Portal. Single sign-on can be used on both Enterprise Linux and Windows virtual machines.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Single sign-on is not supported for virtual machines running Enterprise Linux 8.0.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If single sign-on to the VM Portal is enabled, single sign-on to virtual machines will not be possible. With single sign-on to the VM Portal enabled, the VM Portal does not need to accept a password, thus the password cannot be delegated to sign in to virtual machines.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="Configuring_Single_Sign-On_for_Red_Hat_Enterprise_Linux_Virtual_Machines">4.2.1. Configuring Single Sign-On for Enterprise Linux Virtual Machines Using IPA (IdM)</h4>
<div class="paragraph">
<p>To configure single sign-on for Enterprise Linux virtual machines using GNOME and KDE graphical desktop environments and IPA (IdM) servers, you must install the <code>ovirt-guest-agent</code> package on the virtual machine and install the packages associated with your window manager.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The following procedure assumes that you have a working IPA configuration and that the IPA domain is already joined to the Engine. You must also ensure that the clocks on the Engine, the virtual machine and the system on which IPA (IdM) is hosted are synchronized using NTP.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Single Sign-On (SSO) is deprecated for virtual machines running Enterprise Linux version 7 or earlier.</p>
</div>
<div class="paragraph">
<p>SSO is not supported for virtual machines running Enterprise Linux 8 or later, or for Windows operating systems.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="configure-sso-linux-74" class="paragraph">
<p>Configuring Single Sign-On for Enterprise Linux Virtual Machines</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in to the Enterprise Linux virtual machine.</p>
</li>
<li>
<p>Enable the repository:</p>
<div class="ulist">
<ul>
<li>
<p>For Enterprise Linux 6:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos --enable=rhel-6-server-rhv-4-agent-rpms</pre>
</div>
</div>
</li>
<li>
<p>For Enterprise Linux 7:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos --enable=rhel-7-server-rh-common-rpms</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Download and install the guest agent, single sign-on, and IPA packages:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum install ovirt-guest-agent-common ovirt-guest-agent-pam-module ovirt-guest-agent-gdm-plugin ipa-client</pre>
</div>
</div>
</li>
<li>
<p>Run the following command and follow the prompts to configure <code>ipa-client</code> and join the virtual machine to the domain:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ipa-client-install --permit --mkhomedir</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In environments that use DNS obfuscation, this command should be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># ipa-client-install --domain=<em>FQDN</em> --server=<em>FQDN</em></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>For Enterprise Linux 7.2 and later:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># authconfig --enablenis --update</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Enterprise Linux 7.2 has a new version of the System Security Services Daemon (SSSD), which introduces configuration that is incompatible with the oVirt Engine guest agent single sign-on implementation. This command ensures that single sign-on works.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Fetch the details of an IPA user:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># getent passwd <em>ipa-user</em></pre>
</div>
</div>
</li>
<li>
<p>Record the IPA user&#8217;s UID and GID:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"><em>ipa-user</em>:*:936600010:936600001::/home/<em>ipa-user</em>:/bin/sh</pre>
</div>
</div>
</li>
<li>
<p>Create a home directory for the IPA user:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># mkdir /home/<em>ipa-user</em></pre>
</div>
</div>
</li>
<li>
<p>Assign ownership of the directory to the IPA user:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chown 936600010:936600001 /home/<em>ipa-user</em></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Log in to the VM Portal using the user name and password of a user configured to use single sign-on and connect to the console of the virtual machine. You will be logged in automatically.</p>
</div>
</div>
<div class="sect3">
<h4 id="Configuring_Single_Sign_On_for_Windows_Virtual_Machines">4.2.2. Configuring single sign-on for Windows virtual machines</h4>
<div class="paragraph">
<p>To configure single sign-on for Windows virtual machines, the Windows guest agent must be installed on the guest virtual machine. The virtio-win ISO image provides this agent. If the <code>virtio-win<em>_version</em>.iso</code> image is not available in your storage domain, contact your system administrator.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Select the Windows virtual machine. Ensure the machine is powered up.</p>
</li>
<li>
<p>Click <strong>Change CD</strong>.</p>
</li>
<li>
<p>Select <code>virtio-win<em>_version</em>.iso</code> from the list of images.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
<li>
<p>Click <b class="button">Console</b> and log in to the virtual machine.</p>
</li>
<li>
<p>On the virtual machine, locate the CD drive to access the contents of the guest tools ISO file and launch <code>virtio-win<em>_version</em>.iso</code>. After the tools have been installed, you will be prompted to restart the machine to apply the changes.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Log in to the VM Portal using the user name and password of a user configured to use single sign-on and connect to the console of the virtual machine. You will be logged in automatically.</p>
</div>
</div>
<div class="sect3">
<h4 id="Disabling_Single_Sign-on_for_Virtual_Machines">4.2.3. Disabling Single Sign-on for Virtual Machines</h4>
<div class="paragraph">
<p>The following procedure explains how to disable single sign-on for a virtual machine.</p>
</div>
<div class="paragraph">
<p><strong>Disabling Single Sign-On for Virtual Machines</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select a virtual machine and click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>Console</strong> tab.</p>
</li>
<li>
<p>Select the <strong>Disable Single Sign On</strong> check box.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Configuring_USB_Devices">4.3. Configuring USB Devices</h3>
<div class="paragraph">
<p>A virtual machine connected with the SPICE protocol can be configured to connect directly to USB devices.</p>
</div>
<div class="paragraph">
<p>The USB device will only be redirected if the virtual machine is active, in focus and is run from the VM Portal. USB redirection can be manually enabled each time a device is plugged in or set to automatically redirect to active virtual machines in the Console Options window.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note the distinction between the client machine and guest machine. The client is the hardware from which you access a guest. The guest is the virtual desktop or virtual server which is accessed through the VM Portal or Administration Portal.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>USB redirection <strong>Enabled</strong> mode allows KVM/SPICE USB redirection for Linux and Windows virtual machines. Virtual (guest) machines require no guest-installed agents or drivers for native USB. On Enterprise Linux clients, all packages required for USB redirection are provided by the <code>virt-viewer</code> package. On Windows clients, you must also install the <code>usbdk</code> package. Enabled USB mode is supported on the following clients and guests:</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you have a 64-bit architecture PC, you must use the 64-bit version of Internet Explorer to install the 64-bit version of the USB driver. The USB redirection will not work if you install the 32-bit version on a 64-bit architecture. As long as you initially install the correct USB type, you can access USB redirection from both 32- and 64-bit browsers.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="Using_USB_Devices_on_a_Windows_Client">4.3.1. Using USB Devices on a Windows Client</h4>
<div class="paragraph">
<p>The <code>usbdk</code> driver must be installed on the Windows client for the USB device to be redirected to the guest. Ensure the version of <code>usbdk</code> matches the architecture of the client machine. For example, the 64-bit version of <code>usbdk</code> must be installed on 64-bit Windows machines.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>USB redirection is only supported when you open the virtual machine from the VM Portal.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>When the <code>usbdk</code> driver is installed, click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine that is configured to use the SPICE protocol.</p>
</li>
<li>
<p>Click the <strong>Console</strong> tab.</p>
</li>
<li>
<p>Select the <strong>USB enabled</strong> checkbox and click <b class="button">OK</b>.</p>
</li>
<li>
<p>Click <span class="menuseq"><b class="menu">Console</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Console Options</b></span>.</p>
</li>
<li>
<p>Select the <strong>Enable USB Auto-Share</strong> check box and click <b class="button">OK</b>.</p>
</li>
<li>
<p>Start the virtual machine from the VM Portal and click <b class="button">Console</b> to connect to that virtual machine.</p>
</li>
<li>
<p>Plug your USB device into the client machine to make it appear automatically on the guest machine.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Using_USB_Devices_on_a_Red_Hat_Enterprise_Linux_Client">4.3.2. Using USB Devices on a Enterprise Linux Client</h4>
<div class="paragraph">
<p>The <code>usbredir</code> package enables USB redirection from Enterprise Linux clients to virtual machines. <code>usbredir</code> is a dependency of the <code>virt-viewer</code> package, and is automatically installed together with that package.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>USB redirection is only supported when you open the virtual machine from the VM Portal.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Select a virtual machine that has been configured to use the SPICE protocol and click <b class="button">Edit</b>. This opens the <strong>Edit Virtual Machine</strong> window.</p>
</li>
<li>
<p>Click the <strong>Console</strong> tab.</p>
</li>
<li>
<p>Select the <strong>USB enabled</strong> checkbox and click <b class="button">OK</b>.</p>
</li>
<li>
<p>Click <span class="menuseq"><b class="menu">Console</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Console Options</b></span>.</p>
</li>
<li>
<p>Select the <strong>Enable USB Auto-Share</strong> check box and click <b class="button">OK</b>.</p>
</li>
<li>
<p>Start the virtual machine from the VM Portal and click <b class="button">Console</b> to connect to that virtual machine.</p>
</li>
<li>
<p>Plug your USB device into the client machine to make it appear automatically on the guest machine.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Configuring_Multiple_Monitors">4.4. Configuring Multiple Monitors</h3>
<div class="sect3">
<h4 id="Configuring_Multiple_Displays_for_Red_Hat_Enterprise_Linux_Guest_Virtual_Machines">4.4.1. Configuring Multiple Displays for Enterprise Linux Virtual Machines</h4>
<div class="paragraph">
<p>A maximum of four displays can be configured for a single Enterprise Linux virtual machine when connecting to the virtual machine using the SPICE protocol.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start a SPICE session with the virtual machine.</p>
</li>
<li>
<p>Open the <strong>View</strong> drop-down menu at the top of the SPICE client window.</p>
</li>
<li>
<p>Open the <strong>Display</strong> menu.</p>
</li>
<li>
<p>Click the name of a display to enable or disable that display.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, <strong>Display 1</strong> is the only display that is enabled on starting a SPICE session with a virtual machine. If no other displays are enabled, disabling this display will close the session.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="Configuring_Multiple_Displays_for_Windows_Virtual_Machines">4.4.2. Configuring Multiple Displays for Windows Virtual Machines</h4>
<div class="paragraph">
<p>A maximum of four displays can be configured for a single Windows virtual machine when connecting to the virtual machine using the SPICE protocol.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>With the virtual machine in a powered-down state, click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>Console</strong> tab.</p>
</li>
<li>
<p>Select the number of displays from the <strong>Monitors</strong> drop-down list.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This setting controls the maximum number of displays that can be enabled for the virtual machine. While the virtual machine is running, additional displays can be enabled up to this number.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
<li>
<p>Start a SPICE session with the virtual machine.</p>
</li>
<li>
<p>Open the <strong>View</strong> drop-down menu at the top of the SPICE client window.</p>
</li>
<li>
<p>Open the <strong>Display</strong> menu.</p>
</li>
<li>
<p>Click the name of a display to enable or disable that display.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>By default, <strong>Display 1</strong> is the only display that is enabled on starting a SPICE session with a virtual machine. If no other displays are enabled, disabling this display will close the session.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Configuring_Console_Options">4.5. Configuring Console Options</h3>
<div class="sect3">
<h4 id="sect-Console_Options">4.5.1. Console Options</h4>
<div class="paragraph">
<p>Connection protocols are the underlying technology used to provide graphical consoles for virtual machines and allow users to work with virtual machines in a similar way as they would with physical machines. oVirt currently supports the following connection protocols:</p>
</div>
<div class="paragraph">
<p><strong>SPICE</strong></p>
</div>
<div class="paragraph">
<p>Simple Protocol for Independent Computing Environments (SPICE) is the recommended connection protocol for both Linux virtual machines and Windows virtual machines. To open a console to a virtual machine using SPICE, use Remote Viewer.</p>
</div>
<div class="paragraph">
<p><strong>VNC</strong></p>
</div>
<div class="paragraph">
<p>Virtual Network Computing (VNC) can be used to open consoles to both Linux virtual machines and Windows virtual machines. To open a console to a virtual machine using VNC, use Remote Viewer or a VNC client.</p>
</div>
<div class="paragraph">
<p><strong>RDP</strong></p>
</div>
<div class="paragraph">
<p>Remote Desktop Protocol (RDP) can only be used to open consoles to Windows virtual machines, and is only available when you access a virtual machines from a Windows machine on which Remote Desktop has been installed. Before you can connect to a Windows virtual machine using RDP, you must set up remote sharing on the virtual machine and configure the firewall to allow remote desktop connections.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>SPICE is not supported on virtual machines running Windows 8 or Windows 8.1. If a virtual machine running one of these operating systems is configured to use the SPICE protocol, it detects the absence of the required SPICE drivers and runs in VGA compatibility mode.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="Accessing_console_options">4.5.2. Accessing Console Options</h4>
<div class="paragraph">
<p>You can configure several options for opening graphical consoles for virtual machines in the Administration Portal.</p>
</div>
<div class="paragraph">
<p><strong>Accessing Console Options</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a running virtual machine.</p>
</li>
<li>
<p>Click <span class="menuseq"><b class="menu">Console</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Console Options</b></span>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can configure the connection protocols and video type in the <strong>Console</strong> tab of the <strong>Edit Virtual Machine</strong> window in the Administration Portal. Additional options specific to each of the connection protocols, such as the keyboard layout when using the VNC connection protocol, can be configured. See <a href="#Virtual_Machine_Console_settings_explained">Virtual Machine Console Settings Explained</a> for more information.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="SPICE_Console_Options">4.5.3. SPICE Console Options</h4>
<div class="paragraph">
<p>When the SPICE connection protocol is selected, the following options are available in the <strong>Console Options</strong> window.</p>
</div>
<div class="paragraph">
<p>SPICE Options</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Map control-alt-del shortcut to ctrl+alt+end</strong>: Select this check box to map the <code>Ctrl</code> + <code>Alt</code> + <code>Del</code> key combination to <code>Ctrl</code> + <code>Alt</code> + <code>End</code> inside the virtual machine.</p>
</li>
<li>
<p><strong>Enable USB Auto-Share</strong>: Select this check box to automatically redirect USB devices to the virtual machine. If this option is not selected, USB devices will connect to the client machine instead of the guest virtual machine. To use the USB device on the guest machine, manually enable it in the SPICE client menu.</p>
</li>
<li>
<p><strong>Open in Full Screen</strong>: Select this check box for the virtual machine console to automatically open in full screen when you connect to the virtual machine. Press <code>SHIFT</code> + <code>F11</code> to toggle full screen mode on or off.</p>
</li>
<li>
<p><strong>Enable SPICE Proxy</strong>: Select this check box to enable the SPICE proxy.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="VNC_Console_Options">4.5.4. VNC Console Options</h4>
<div class="paragraph">
<p>When the VNC connection protocol is selected, the following options are available in the <strong>Console Options</strong> window.</p>
</div>
<div class="paragraph">
<p><strong>Console Invocation</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Native Client</strong>: When you connect to the console of the virtual machine, a file download dialog provides you with a file that opens a console to the virtual machine via Remote Viewer.</p>
</li>
<li>
<p><strong>noVNC</strong>: When you connect to the console of the virtual machine, a browser tab is opened that acts as the console.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>VNC Options</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Map control-alt-delete shortcut to ctrl+alt+end</strong>: Select this check box to map the <code>Ctrl</code> + <code>Alt</code> + <code>Del</code> key combination to <code>Ctrl</code> + <code>Alt</code> + <code>End</code> inside the virtual machine.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="RDP_Console_Options">4.5.5. RDP Console Options</h4>
<div class="paragraph">
<p>When the RDP connection protocol is selected, the following options are available in the <strong>Console Options</strong> window.</p>
</div>
<div class="paragraph">
<p><strong>Console Invocation</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Auto</strong>: The Engine automatically selects the method for invoking the console.</p>
</li>
<li>
<p><strong>Native client</strong>: When you connect to the console of the virtual machine, a file download dialog provides you with a file that opens a console to the virtual machine via Remote Desktop.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>RDP Options</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Use Local Drives</strong>: Select this check box to make the drives on the client machine accessible on the guest virtual machine.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="sect-Remote_Viewer_Options">4.5.6. Remote Viewer Options</h4>
<div class="sect4">
<h5 id="Remote_Viewer_Options">Remote Viewer Options</h5>
<div class="paragraph">
<p>When you specify the <strong>Native client</strong> console invocation option, you will connect to virtual machines using Remote Viewer. The Remote Viewer window provides a number of options for interacting with the virtual machine to which it is connected.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. Remote Viewer Options</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Option</th>
<th class="tableblock halign-left valign-top">Hotkey</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">File</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><strong>Screenshot</strong>: Takes a screen capture of the active window and saves it in a location of your specification.</p>
</li>
<li>
<p><strong>USB device selection</strong>: If USB redirection has been enabled on your virtual machine, the USB device plugged into your client machine can be accessed from this menu.</p>
</li>
<li>
<p><strong>Quit</strong>: Closes the console. The hot key for this option is <code>Shift</code> + <code>Ctrl</code> + <code>Q</code>.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">View</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><strong>Full screen</strong>: Toggles full screen mode on or off. When enabled, full screen mode expands the virtual machine to fill the entire screen. When disabled, the virtual machine is displayed as a window. The hot key for enabling or disabling full screen is <code>SHIFT</code> + <code>F11</code>.</p>
</li>
<li>
<p><strong>Zoom</strong>: Zooms in and out of the console window. <code>Ctrl</code> + <code>+</code> zooms in, <code>Ctrl</code> + <code>-</code> zooms out, and <code>Ctrl</code> + <code>0</code> returns the screen to its original size.</p>
</li>
<li>
<p><strong>Automatically resize</strong>: Select to enable the guest resolution to automatically scale according to the size of the console window.</p>
</li>
<li>
<p><strong>Displays</strong>: Allows users to enable and disable displays for the guest virtual machine.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Send key</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p><code>Ctrl</code> + <code>Alt</code> + <code>Del</code>: On a Enterprise Linux virtual machine, it displays a dialog with options to suspend, shut down or restart the virtual machine. On a Windows virtual machine, it displays the task manager or Windows Security dialog.</p>
</li>
<li>
<p><code>Ctrl</code> + <code>Alt</code> + <code>Backspace</code>: On a Enterprise Linux virtual machine, it restarts the X sever. On a Windows virtual machine, it does nothing.</p>
</li>
<li>
<p><code>Ctrl</code> + <code>Alt</code> + <code>F1</code></p>
</li>
<li>
<p><code>Ctrl</code> + <code>Alt</code> + <code>F2</code></p>
</li>
<li>
<p><code>Ctrl</code> + <code>Alt</code> + <code>F3</code></p>
</li>
<li>
<p><code>Ctrl</code> + <code>Alt</code> + <code>F4</code></p>
</li>
<li>
<p><code>Ctrl</code> + <code>Alt</code> + <code>F5</code></p>
</li>
<li>
<p><code>Ctrl</code> + <code>Alt</code> + <code>F6</code></p>
</li>
<li>
<p><code>Ctrl</code> + <code>Alt</code> + <code>F7</code></p>
</li>
<li>
<p><code>Ctrl</code> + <code>Alt</code> + <code>F8</code></p>
</li>
<li>
<p><code>Ctrl</code> + <code>Alt</code> + <code>F9</code></p>
</li>
<li>
<p><code>Ctrl</code> + <code>Alt</code> + <code>F10</code></p>
</li>
<li>
<p><code>Ctrl</code> + <code>Alt</code> + <code>F11</code></p>
</li>
<li>
<p><code>Ctrl</code> + <code>Alt</code> + <code>F12</code></p>
</li>
<li>
<p><code>Printscreen</code>: Passes the <strong>Printscreen</strong> keyboard option to the virtual machine.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Help</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <strong>About</strong> entry displays the version details of Virtual Machine Viewer that you are using.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Release Cursor from Virtual Machine</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SHIFT</code> + <code>F12</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="Remote_Viewer_Hotkeys">Remote Viewer Hotkeys</h5>
<div class="paragraph">
<p>You can access the hotkeys for a virtual machine in both full screen mode and windowed mode. If you are using full screen mode, you can display the menu containing the button for hotkeys by moving the mouse pointer to the middle of the top of the screen. If you are using windowed mode, you can access the hotkeys via the <strong>Send key</strong> menu on the virtual machine window title bar.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If <code>vdagent</code> is not running on the client machine, the mouse can become captured in a virtual machine window if it is used inside a virtual machine and the virtual machine is not in full screen. To unlock the mouse, press <code>Shift</code> + <code>F12</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="Manually_Associating_console.vv_Files_with_Remote_Viewer">Manually Associating console.vv Files with Remote Viewer</h5>
<div class="paragraph">
<p>If you are prompted to download a <strong>console.vv</strong> file when attempting to open a console to a virtual machine using the native client console option, and Remote Viewer is already installed, then you can manually associate <strong>console.vv</strong> files with Remote Viewer so that Remote Viewer can automatically use those files to open consoles.</p>
</div>
<div class="paragraph">
<p><strong>Manually Associating console.vv Files with Remote Viewer</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Start the virtual machine.</p>
</li>
<li>
<p>Open the <strong>Console Options</strong> window:</p>
<div class="ulist">
<ul>
<li>
<p>In the Administration Portal, click <span class="menuseq"><b class="menu">Console</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Console Options</b></span>.</p>
</li>
<li>
<p>In the VM Portal, click the virtual machine name and click the pencil icon beside <strong>Console</strong>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Change the console invocation method to <strong>Native client</strong> and click <b class="button">OK</b>.</p>
</li>
<li>
<p>Attempt to open a console to the virtual machine, then click <strong>Save</strong> when prompted to open or save the <strong>console.vv</strong> file.</p>
</li>
<li>
<p>Click the location on your local machine where you saved the file.</p>
</li>
<li>
<p>Double-click the <strong>console.vv</strong> file and select <strong>Select a program from a list of installed programs</strong> when prompted.</p>
</li>
<li>
<p>In the <strong>Open with</strong> window, select <strong>Always use the selected program to open this kind of file</strong> and click the <strong>Browse</strong> button.</p>
</li>
<li>
<p>Click the <strong>C:\Users_[user name]_\AppData\Local\virt-viewer\bin</strong> directory and select <strong>remote-viewer.exe</strong>.</p>
</li>
<li>
<p>Click <strong>Open</strong> and then click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>When you use the native client console invocation option to open a console to a virtual machine, Remote Viewer will automatically use the <strong>console.vv</strong> file that the oVirt Engine provides to open a console to that virtual machine without prompting you to select the application to use.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Configuring_a_Watchdog">4.6. Configuring a Watchdog</h3>
<div class="sect3">
<h4 id="Adding_a_Watchdog_Card_to_a_Virtual_machine">4.6.1. Adding a Watchdog Card to a Virtual Machine</h4>
<div class="paragraph">
<p>You can add a watchdog card to a virtual machine to monitor the operating system&#8217;s responsiveness.</p>
</div>
<div class="paragraph">
<p><strong>Adding Watchdog Cards to Virtual Machines</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>High Availability</strong> tab.</p>
</li>
<li>
<p>Select the watchdog model to use from the <strong>Watchdog Model</strong> drop-down list.</p>
</li>
<li>
<p>Select an action from the <strong>Watchdog Action</strong> drop-down list. This is the action that the virtual machine takes when the watchdog is triggered.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Installing_a_Watchdog">4.6.2. Installing a Watchdog</h4>
<div class="paragraph">
<p>To activate a watchdog card attached to a virtual machine, you must install the <code>watchdog</code> package on that virtual machine and start the <code>watchdog</code> service.</p>
</div>
<div class="paragraph">
<p><strong>Installing Watchdogs</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in to the virtual machine on which the watchdog card is attached.</p>
</li>
<li>
<p>Install the <code>watchdog</code> package and dependencies:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum install watchdog</pre>
</div>
</div>
</li>
<li>
<p>Edit the <strong>/etc/watchdog.conf</strong> file and uncomment the following line:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">watchdog-device = /dev/watchdog</pre>
</div>
</div>
</li>
<li>
<p>Save the changes.</p>
</li>
<li>
<p>Start the <code>watchdog</code> service and ensure this service starts on boot:</p>
<div class="ulist">
<ul>
<li>
<p>Enterprise Linux 6:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># service watchdog start
# chkconfig watchdog on</pre>
</div>
</div>
</li>
<li>
<p>Enterprise Linux 7:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl start watchdog.service
# systemctl enable watchdog.service</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Confirming_Watchdog_Functionality">4.6.3. Confirming Watchdog Functionality</h4>
<div class="paragraph">
<p>Confirm that a watchdog card has been attached to a virtual machine and that the <code>watchdog</code> service is active.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This procedure is provided for testing the functionality of watchdogs only and must not be run on production machines.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Confirming Watchdog Functionality</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in to the virtual machine on which the watchdog card is attached.</p>
</li>
<li>
<p>Confirm that the watchdog card has been identified by the virtual machine:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># lspci | grep watchdog -i</pre>
</div>
</div>
</li>
<li>
<p>Run one of the following commands to confirm that the watchdog is active:</p>
<div class="ulist">
<ul>
<li>
<p>Trigger a kernel panic:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># echo c &gt; /proc/sysrq-trigger</pre>
</div>
</div>
</li>
<li>
<p>Terminate the <code>watchdog</code> service:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># kill -9 <code>pgrep watchdog</code></pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>The watchdog timer can no longer be reset, so the watchdog counter reaches zero after a short period of time. When the watchdog counter reaches zero, the action specified in the <strong>Watchdog Action</strong> drop-down menu for that virtual machine is performed.</p>
</div>
</div>
<div class="sect3">
<h4 id="Parameters_for_Watchdogs_in_watchdog_conf">4.6.4. Parameters for Watchdogs in watchdog.conf</h4>
<div class="paragraph">
<p>The following is a list of options for configuring the <code>watchdog</code> service available in the <strong>/etc/watchdog.conf</strong> file. To configure an option, you must uncomment that option and restart the <code>watchdog</code> service after saving the changes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For a more detailed explanation of options for configuring the <code>watchdog</code> service and using the <code>watchdog</code> command, see the <code>watchdog</code> man page.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. watchdog.conf variables</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Variable name</th>
<th class="tableblock halign-left valign-top">Default Value</th>
<th class="tableblock halign-left valign-top">Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ping</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An IP address that the watchdog attempts to ping to verify whether that address is reachable. You can specify multiple IP addresses by adding additional <code>ping</code> lines.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interface</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A network interface that the watchdog will monitor to verify the presence of network traffic. You can specify multiple network interfaces by adding additional <code>interface</code> lines.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>file</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/log/messages</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A file on the local system that the watchdog will monitor for changes. You can specify multiple files by adding additional <code>file</code> lines.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>change</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1407</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of watchdog intervals after which the watchdog checks for changes to files. A <code>change</code> line must be specified on the line directly after each <code>file</code> line, and applies to the <code>file</code> line directly above that <code>change</code> line.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max-load-1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>24</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum average load that the virtual machine can sustain over a one-minute period. If this average is exceeded, then the watchdog is triggered. A value of <code>0</code> disables this feature.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max-load-5</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>18</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum average load that the virtual machine can sustain over a five-minute period. If this average is exceeded, then the watchdog is triggered. A value of <code>0</code> disables this feature. By default, the value of this variable is set to a value approximately three quarters that of <code>max-load-1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max-load-15</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>12</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum average load that the virtual machine can sustain over a fifteen-minute period. If this average is exceeded, then the watchdog is triggered. A value of <code>0</code> disables this feature. By default, the value of this variable is set to a value approximately one half that of <code>max-load-1</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>min-memory</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The minimum amount of virtual memory that must remain free on the virtual machine. This value is measured in pages. A value of <code>0</code> disables this feature.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>repair-binary</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/usr/sbin/repair</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path and file name of a binary file on the local system that will be run when the watchdog is triggered. If the specified file resolves the issues preventing the watchdog from resetting the watchdog counter, then the watchdog action is not triggered.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>test-binary</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path and file name of a binary file on the local system that the watchdog will attempt to run during each interval. A test binary allows you to specify a file for running user-defined tests.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>test-timeout</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time limit, in seconds, for which user-defined tests can run. A value of <code>0</code> allows user-defined tests to continue for an unlimited duration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>temperature-device</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path to and name of a device for checking the temperature of the machine on which the <code>watchdog</code> service is running.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>max-temperature</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>120</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum allowed temperature for the machine on which the <code>watchdog</code> service is running. The machine will be halted if this temperature is reached. Unit conversion is not taken into account, so you must specify a value that matches the watchdog card being used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>admin</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>root</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The email address to which email notifications are sent.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>interval</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>10</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The interval, in seconds, between updates to the watchdog device. The watchdog device expects an update at least once every minute, and if there are no updates over a one-minute period, then the watchdog is triggered. This one-minute period is hard-coded into the drivers for the watchdog device, and cannot be configured.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>logtick</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When verbose logging is enabled for the <code>watchdog</code> service, the <code>watchdog</code> service periodically writes log messages to the local system. The <code>logtick</code> value represents the number of watchdog intervals after which a message is written.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>realtime</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>yes</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies whether the watchdog is locked in memory. A value of <code>yes</code> locks the watchdog in memory so that it is not swapped out of memory, while a value of <code>no</code> allows the watchdog to be swapped out of memory. If the watchdog is swapped out of memory and is not swapped back in before the watchdog counter reaches zero, then the watchdog is triggered.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>priority</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>1</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The schedule priority when the value of <code>realtime</code> is set to <code>yes</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pidfile</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/var/run/syslogd.pid</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path and file name of a PID file that the watchdog monitors to see if the corresponding process is still active. If the corresponding process is not active, then the watchdog is triggered.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="Configuring_virtual_numa">4.7. Configuring Virtual NUMA</h3>
<div class="paragraph">
<p>In the Administration Portal, you can configure virtual NUMA nodes on a virtual machine and pin them to physical NUMA nodes on one or more hosts. The hosts default policy is to schedule and run virtual machines on any available resources on the host. As a result, the resources backing a large virtual machine that cannot fit within a single host socket could be spread out across multiple NUMA nodes. Over time these resources may be moved around, leading to poor and unpredictable performance. Configure and pin virtual NUMA nodes to avoid this outcome and improve performance.</p>
</div>
<div class="paragraph">
<p>Configuring virtual NUMA requires a NUMA-enabled host. To confirm whether NUMA is enabled on a host, log in to the host and run <code>numactl --hardware</code>. The output of this command should show at least two NUMA nodes. You can also view the host&#8217;s NUMA topology in the Administration Portal by selecting the host from the <strong>Hosts</strong> tab and clicking <strong>NUMA Support</strong>. This button is only available when the selected host has at least two NUMA nodes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you define <strong>NUMA Pinning</strong>, the default migration mode is <strong>Allow manual migration only</strong> by default.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Configuring Virtual NUMA</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click <b class="button">Show Advanced Options</b>.</p>
</li>
<li>
<p>Click the <strong>Host</strong> tab.</p>
</li>
<li>
<p>Select the <strong>Specific Host(s)</strong> radio button and select the host(s) from the list. The selected host(s) must have at least two NUMA nodes.</p>
</li>
<li>
<p>Click <strong>NUMA Pinning</strong>.</p>
</li>
<li>
<p>In the <strong>NUMA Topology</strong> window, click and drag virtual NUMA nodes from the box on the right to host NUMA nodes on the left as required, and click <b class="button">OK</b>.</p>
</li>
<li>
<p>Select <strong>Strict</strong>, <strong>Preferred</strong>, or <strong>Interleave</strong> from the <strong>Tune Mode</strong> drop-down list in each NUMA node. If the selected mode is <strong>Preferred</strong>, the <strong>NUMA Node Count</strong> must be set to <code>1</code>.</p>
</li>
<li>
<p>You can also set the NUMA pinning policy automatically by selecting an <strong>Auto Pinning Policy</strong> from the drop-down list:</p>
<div class="ulist">
<ul>
<li>
<p><strong>None</strong> - makes no changes to the virtual machine.</p>
</li>
<li>
<p><strong>Resize and Pin</strong> - maximizes the CPU topology and generates the CPU pinning and NUMA pinning configurations.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you do not pin the virtual NUMA node to a host NUMA node, the system defaults to the NUMA node that contains the host device&#8217;s memory-mapped I/O (MMIO), provided that there are one or more host devices and all of those devices are from a single NUMA node.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="Configuring_Satellite_Errata">4.8. Configuring Satellite errata viewing for a virtual machine</h3>
<div class="paragraph">
<p>In the Administration Portal, you can configure a virtual machine to display the available errata. The virtual machine needs to be associated with a Red Hat Satellite server to show available errata.</p>
</div>
<div class="paragraph">
<p>oVirt 4.4 supports viewing errata with Red Hat Satellite 6.6.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The Satellite server must be added as an external provider.</p>
</li>
<li>
<p>The Engine and any virtual machines on which you want to view errata must all be registered in the Satellite server by their respective FQDNs. This ensures that external content host IDs do not need to be maintained in oVirt.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Virtual machines added using an IP address cannot report errata.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>The host that the virtual machine runs on also needs to be configured to receive errata information from Satellite.</p>
</li>
<li>
<p>The virtual machine must have the <code>ovirt-guest-agent</code> package installed. This package enables the virtual machine to report its host name to the oVirt Engine, which enables the Red Hat Satellite server to identify the virtual machine as a content host and report the applicable errata.</p>
</li>
<li>
<p>The virtual machine must be registered to the Red Hat Satellite server as a content host.</p>
</li>
<li>
<p>Use Red Hat Satellite remote execution to manage packages on hosts.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Katello agent is deprecated and will be removed in a future Satellite version. Migrate your processes to use the remote execution feature to update clients remotely.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>Foreman/Satellite</strong> tab.</p>
</li>
<li>
<p>Select the required Satellite server from the <strong>Provider</strong> drop-down list.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://ovirt.org/documentation/administration_guide/index#Configuring_Satellite_Errata_Management_for_a_Host">Setting up Satellite errata viewing for a host</a> in the <em>Administration Guide</em></p>
</li>
<li>
<p><a href="https://ovirt.org/documentation/virtual_machine_management_guide/index#Installing_the_Guest_Agents_and_Drivers_on_Red_Hat_Enterprise_Linux">Installing the Guest Agents, Tools, and Drivers on Linux</a> in the <em>Virtual Machine Management Guide</em> for Enterprise Linux virtual machines.</p>
</li>
<li>
<p><a href="https://ovirt.org/documentation/virtual_machine_management_guide/index#Installing_the_Guest_Agents_and_Drivers_on_Windows">Installing the Guest Agents, Tools, and Drivers on Windows</a> in the <em>Virtual Machine Management Guide</em> for Windows virtual machines.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Configuring_Headless_Machines">4.9. Configuring Headless Virtual Machines</h3>
<div class="paragraph">
<p>You can configure a headless virtual machine when it is not necessary to access the machine via a graphical console. This headless machine will run without graphical and video devices. This can be  useful in situations where the host has limited resources, or to comply with virtual machine usage requirements such as real-time virtual machines.</p>
</div>
<div class="paragraph">
<p>Headless virtual machines can be administered via a Serial Console, SSH, or any other service for command line access. Headless mode is applied via the <strong>Console</strong> tab when creating or editing virtual machines and machine pools, and when editing templates. It is also available when creating or editing instance types.</p>
</div>
<div class="paragraph">
<p>If you are creating a new headless virtual machine, you can use the <strong>Run Once</strong> window to access the virtual machine via a graphical console for the first run only. See <a href="#Virtual_Machine_Run_Once_settings_explained">Explanation of settings in the Run Once window</a> for more details.</p>
</div>
<div class="paragraph">
<p>Prerequisites</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If you are editing an existing virtual machine, and the oVirt guest agent has not been installed, note the machine&#8217;s IP prior to selecting <strong>Headless Mode</strong>.</p>
</li>
<li>
<p>Before running a virtual machine in headless mode, the GRUB configuration for this machine must be set to console mode otherwise the guest operating system&#8217;s boot process will hang. To set console mode, comment out the spashimage flag in the GRUB menu configuration file:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"> #splashimage=(hd0,0)/grub/splash.xpm.gz serial --unit=0 --speed=9600 --parity=no --stop=1 terminal --timeout=2 serial</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Restart the virtual machine if it is running when selecting the <strong>Headless Mode</strong> option.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Configuring a Headless Virtual Machine</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>Console</strong> tab.</p>
</li>
<li>
<p>Select <strong>Headless Mode</strong>. All other fields in the <strong>Graphical Console</strong> section are disabled.</p>
</li>
<li>
<p>Optionally, select <strong>Enable VirtIO serial console</strong> to enable communicating with the virtual machine via serial console. This is highly recommended.</p>
</li>
<li>
<p>Reboot the virtual machine if it is running. See <a href="#Rebooting_a_Virtual_Machine">Rebooting or Resetting a Virtual Machine</a>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Configuring_High_Performance_Virtual_Machines_Templates_and_Pools">4.10. Configuring High Performance Virtual Machines, Templates, and Pools</h3>
<div class="paragraph">
<p>You can configure a virtual machine for high performance, so that it runs with performance metrics as close to bare metal as possible. When you choose high performance optimization, the virtual machine is configured with a set of automatic, and recommended manual, settings for maximum efficiency.</p>
</div>
<div class="paragraph">
<p>The high performance option is only accessible in the Administration Portal, by selecting <strong>High Performance</strong> from the <strong>Optimized for</strong> dropdown list in the <strong>Edit</strong> or <strong>New</strong> virtual machine, template, or pool window. This option is not available in the VM Portal.</p>
</div>
<div class="paragraph">
<p>The high performance option is supported by oVirt 4.2 and later. It is not available for earlier versions.</p>
</div>
<div class="paragraph">
<p><strong>Virtual Machines</strong></p>
</div>
<div class="paragraph">
<p>If you change the optimization mode of a running virtual machine to high performance, some configuration changes require restarting the virtual machine.</p>
</div>
<div class="paragraph">
<p>To change the optimization mode of a new or existing virtual machine to high performance, you may need to make manual changes to the cluster and to the pinned host configuration first.</p>
</div>
<div class="paragraph">
<p>A high performance virtual machine has certain limitations, because enhanced performance has a trade-off in decreased flexibility:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If pinning is set for CPU threads, I/O threads, emulator threads, or NUMA nodes, according to the recommended settings, only a subset of cluster hosts can be assigned to the high performance virtual machine.</p>
</li>
<li>
<p>Many devices are automatically disabled, which limits the virtual machine&#8217;s usability.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Templates and Pools</strong></p>
</div>
<div class="paragraph">
<p>High performance templates and pools are created and edited in the same way as virtual machines. If a high performance template or pool is used to create new virtual machines, those virtual machines inherits this property and its configurations. Certain settings, however, are not inherited and must be set manually:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>CPU pinning</p>
</li>
<li>
<p>Virtual NUMA and NUMA pinning topology</p>
</li>
<li>
<p>I/O and emulator threads pinning topology</p>
</li>
<li>
<p>Pass-through Host CPU</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="creating-a-high-performance-virtual-machine-template-or-pool">4.10.1. Creating a High Performance Virtual Machine, Template, or Pool</h4>
<div class="paragraph">
<p>To create a high performance virtual machine, template, or pool:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <strong>New</strong> or <strong>Edit</strong> window, select <strong>High Performance</strong> from the <strong>Optimized for</strong> drop-down menu.</p>
<div class="paragraph">
<p>Selecting this option automatically performs certain configuration changes to this virtual machine, which you can view by clicking different tabs. You can change them back to their original settings or override them. (See <a href="#Automatic_High_Performance_Configuration_Settings">Automatic High Performance Configuration Settings</a> for details.) If you change a setting, its latest value is saved.</p>
</div>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
<div class="paragraph">
<p>If you have not set any manual configurations, the <strong>High Performance Virtual Machine/Pool Settings</strong> screen describing the recommended manual configurations appears.</p>
</div>
<div class="paragraph">
<p>If you have set some of the manual configurations, the <strong>High Performance Virtual Machine/Pool Settings</strong> screen displays the settings you have not made.</p>
</div>
<div class="paragraph">
<p>If you have set all the recommended manual configurations, the <strong>High Performance Virtual Machine/Pool Settings</strong> screen does not appear.</p>
</div>
</li>
<li>
<p>If the <strong>High Performance Virtual Machine/Pool Settings</strong> screen appears, click <b class="button">Cancel</b> to return to the <strong>New</strong> or <strong>Edit</strong> window to perform the manual configurations. See <a href="#Configuring_Recommended_Manual_Settings">Configuring the Recommended Manual Settings</a> for details.</p>
<div class="paragraph">
<p>Alternatively, click <b class="button">OK</b> to ignore the recommendations. The result may be a drop in the level of performance.</p>
</div>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
<div class="paragraph">
<p>You can view the optimization type in the <strong>General</strong> tab of the details view of the virtual machine, pool, or template.</p>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Certain configurations can override the high performance settings. For example, if you select an instance type for a virtual machine before selecting <strong>High Performance</strong> from the <strong>Optimized for</strong> drop-down menu and performing the manual configuration, the instance type configuration will not affect the high performance configuration. If, however, you select the instance type after the high performance configurations, you should verify the final configuration in the different tabs to ensure that the high performance configurations have not been overridden by the instance type.</p>
</div>
<div class="paragraph">
<p>The last-saved configuration usually takes priority.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Support for instance types is now deprecated, and will be removed in a future release.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="Automatic_High_Performance_Configuration_Settings">Automatic High Performance Configuration Settings</h5>
<div class="paragraph">
<p>The following table summarizes the automatic settings. The <strong>Enabled (Y/N)</strong> column indicates configurations that are enabled or disabled. The <strong>Applies to</strong> column indicates the relevant resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>VM - Virtual machine</p>
</li>
<li>
<p>T - Template</p>
</li>
<li>
<p>P - Pool</p>
</li>
<li>
<p>C - Cluster</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. Automatic High Performance Configuration Settings</caption>
<colgroup>
<col style="width: 60%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Setting</th>
<th class="tableblock halign-center valign-top">Enabled (Y/N)</th>
<th class="tableblock halign-center valign-top">Applies to</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Headless Mode</strong> (Console tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T, P</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>USB Enabled</strong> (Console tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>N</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T, P</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Smartcard Enabled</strong> (Console tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>N</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T, P</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Soundcard Enabled</strong> (Console tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>N</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T, P</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Enable VirtIO serial console</strong> (Console tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T, P</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Allow manual migration only</strong> (Host tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T, P</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Pass-Through Host CPU</strong> (Host tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T, P</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Highly Available</strong> <sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup> (High Availability tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>N</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T, P</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>No-Watchdog</strong> (High Availability tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>N</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T, P</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Memory Balloon Device</strong> (Resource Allocation tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>N</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T, P</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>I/O Threads Enabled</strong> <sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup> (Resource Allocation tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T, P</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Paravirtualized Random Number Generator PCI (virtio-rng) device (Random Generator tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T, P</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">I/O and emulator threads pinning topology</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CPU cache layer 3</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T, P</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="IO_and_Emulator_Threads_Pinning_Topology">I/O and Emulator Threads Pinning Topology (Automatic Settings)</h5>
<div class="paragraph">
<p>The I/O and emulator threads pinning topology is a new configuration setting for oVirt 4.2. It requires that I/O threads, NUMA nodes, and NUMA pinning be enabled and set for the virtual machine. Otherwise, a warning will appear in the engine log.</p>
</div>
<div class="paragraph">
<p>Pinning topology:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The first two CPUs of each NUMA node are pinned.</p>
</li>
<li>
<p>If all vCPUs fit into one NUMA node of the host:</p>
<div class="ulist">
<ul>
<li>
<p>The first two vCPUs are automatically reserved/pinned</p>
</li>
<li>
<p>The remaining vCPUs are available for manual vCPU pinning</p>
</li>
</ul>
</div>
</li>
<li>
<p>If the virtual machine spans more than one NUMA node:</p>
<div class="ulist">
<ul>
<li>
<p>The first two CPUs of the NUMA node with the most pins are reserved/pinned</p>
</li>
<li>
<p>The remaining pinned NUMA node(s) are for vCPU pinning only</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Pools do not support I/O and emulator threads pinning.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If a host CPU is pinned to both a vCPU and I/O and emulator threads, a warning will appear in the log and you will be asked to consider changing the CPU pinning topology to avoid this situation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="high-performance-icons">High Performance Icons</h5>
<div class="paragraph">
<p>The following icons indicate the states of a high performance virtual machine in the <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> screen.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. High Performance Icons</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Icon</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/hp_vm.png" alt="hp vm"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High performance virtual machine</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/hp_vm_next_run.png" alt="hp vm next run"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">High performance virtual machine with Next Run configuration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/stateless_hp_vm.png" alt="stateless hp vm"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stateless, high performance virtual machine</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/stateless_hp_vm_next_run.png" alt="stateless hp vm next run"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Stateless, high performance virtual machine with Next Run configuration</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/vm_hp_pool.png" alt="vm hp pool"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtual machine in a high performance pool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="images/vm_hp_pool_next_run.png" alt="vm hp pool next run"></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Virtual machine in a high performance pool with Next Run configuration</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect3">
<h4 id="Configuring_Recommended_Manual_Settings">4.10.2. Configuring the Recommended Manual Settings</h4>
<div class="paragraph">
<p>You can configure the recommended manual settings in either the <strong>New</strong> or the <strong>Edit</strong> windows.</p>
</div>
<div class="paragraph">
<p>If a recommended setting is not performed, the <strong>High Performance Virtual Machine/Pool Settings</strong> screen displays the recommended setting when you save the resource.</p>
</div>
<div class="paragraph">
<p>The recommended manual settings are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#Pinning_CPU">Pinning CPUs</a></p>
</li>
<li>
<p><a href="#Setting_NUMA_Nodes">Setting the NUMA Pinning Policy</a></p>
</li>
<li>
<p><a href="#Configuring_Huge_Pages">Configuring Huge Pages</a></p>
</li>
<li>
<p><a href="#Disabling_KSM">Disabling KSM</a></p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="Manual_High_Performance_Configuration_Settings">Manual High Performance Configuration Settings</h5>
<div class="paragraph">
<p>The following table summarizes the recommended manual settings. The <strong>Enabled (Y/N)</strong> column indicates configurations that should be enabled or disabled. The <strong>Applies to</strong> column indicates the relevant resources:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>VM - Virtual machine</p>
</li>
<li>
<p>T - Template</p>
</li>
<li>
<p>P - Pool</p>
</li>
<li>
<p>C - Cluster</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. Manual High Performance Configuration Settings</caption>
<colgroup>
<col style="width: 60%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Setting</th>
<th class="tableblock halign-center valign-top">Enabled (Y/N)</th>
<th class="tableblock halign-center valign-top">Applies to</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>NUMA Node Count</strong> (Host tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Tune Mode</strong> (NUMA Pinning screen)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>NUMA Pinning</strong> (Host tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auto Pinning Policy</strong> (Host tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CPU Pinning topology</strong> (Resource Allocation tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, P</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>hugepages</strong> (Custom Properties tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>Y</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>VM, T, P</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>KSM</strong> (Optimization tab)</p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>N</code></p></td>
<td class="tableblock halign-center valign-top"><p class="tableblock"><code>C</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="Pinning_CPU">Pinning CPUs</h5>
<div class="paragraph">
<p>To pin vCPUs to a specific host&#8217;s physical CPU:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <strong>Host</strong> tab, select the <strong>Specific Host(s)</strong> radio button.</p>
</li>
<li>
<p>In the <strong>Resource Allocation</strong> tab, enter the <strong>CPU Pinning Topology</strong>, verifying that the configuration fits the pinned host&#8217;s configuration. See <a href="#Virtual_Machine_Resource_Allocation_settings_explained">Virtual Machine Resource Allocation Settings Explained</a> for information about the syntax of this field.</p>
<div class="paragraph">
<p>This field is populated automatically and the CPU topology is updated when automatic NUMA pinning is activated.</p>
</div>
</li>
<li>
<p>Verify that the virtual machine configuration is compatible with the host configuration:</p>
<div class="ulist">
<ul>
<li>
<p>A virtual machine&#8217;s number of sockets must not be greater than the host&#8217;s number of sockets.</p>
</li>
<li>
<p>A virtual machine&#8217;s number of cores per virtual socket must not be greater than the host&#8217;s number of cores.</p>
</li>
<li>
<p>CPU-intensive workloads perform best when the host and virtual machine expect the same cache usage. To achieve the best performance, a virtual machine&#8217;s number of threads per core must not be greater than that of the host.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>CPU pinning has the following requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the host is NUMA-enabled, the host&#8217;s NUMA settings (memory and CPUs) must be considered because the virtual machine has to fit the host&#8217;s NUMA configuration.</p>
</li>
<li>
<p>The <a href="#IO_and_Emulator_Threads_Pinning_Topology">I/O and emulator threads pinning topology</a> must be considered.</p>
</li>
<li>
<p>CPU pinning can only be set for virtual machines and pools, but not for templates. Therefore, you must set CPU pinning manually whenever you create a high performance virtual machine or pool, even if they are based on a high performance template.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="Setting_NUMA_Nodes">Setting the NUMA Pinning Policy</h5>
<div class="paragraph">
<p>To set the NUMA Pinning Policy, you need a NUMA-enabled pinned host with at least two NUMA nodes.
You can configure the NUMA topology manually, or use the <strong>Auto Pinning Policy</strong> option to configure the topology automatically.</p>
</div>
<div class="olist arabic">
<div class="title">To set the NUMA pinning policy manually:</div>
<ol class="arabic">
<li>
<p>Click <b class="button">NUMA Pinning</b>.</p>
</li>
<li>
<p>In the <strong>NUMA Topology</strong> window, click and drag virtual NUMA nodes from the box on the right to the host&#8217;s physical NUMA nodes on the left as required.</p>
</li>
<li>
<p>Select <strong>Strict</strong>, <strong>Preferred</strong>, or <strong>Interleave</strong> from the <strong>Tune Mode</strong> drop-down list in each NUMA node. If the selected mode is <strong>Preferred</strong>, the <strong>NUMA Node Count</strong> must be set to <code>1</code>.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">To set the NUMA pinning policy automatically:</div>
<ol class="arabic">
<li>
<p>In the <strong>Host</strong> tab, select the <strong>Specific Host(s)</strong> radio button and select the host(s) from the list. The selected host(s) must have at least two NUMA nodes.</p>
</li>
<li>
<p>Under <strong>Configure NUMA:</strong> select an <strong>Auto Pinning Policy</strong> from the drop-down list:</p>
<div class="ulist">
<ul>
<li>
<p><strong>None</strong> - makes no changes to the virtual machine.</p>
</li>
<li>
<p><strong>Resize and Pin</strong> - maximizes the CPU topology and generates the CPU pinning and NUMA pinning configurations.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The Engine calculates the CPU Pinning Topology, updates the CPU topology fields (Total Virtual CPUs, Cores per Virtual Socket, Threads per Core), and enters the topology configuration string in the <strong>CPU Pinning Topology</strong> field of the virtual machine.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The number of declared virtual NUMA nodes and the NUMA pinning policy must take into account:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The host&#8217;s NUMA settings (memory and CPUs)</p>
</li>
<li>
<p>The NUMA node in which the host devices are declared</p>
</li>
<li>
<p>The CPU pinning topology</p>
</li>
<li>
<p>The <a href="#IO_and_Emulator_Threads_Pinning_Topology">IO and emulator threads pinning topology</a></p>
</li>
<li>
<p>Huge page sizes</p>
</li>
<li>
<p>NUMA pinning can only be set for virtual machines, not for pools or templates. You must set NUMA pinning manually when you create a high performance virtual machine based on a template.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="Configuring_Huge_Pages">Configuring Huge Pages</h5>
<div class="paragraph">
<p>Huge pages are pre-allocated when a virtual machine starts to run (dynamic allocation is disabled by default).</p>
</div>
<div class="paragraph">
<p>To configure huge pages:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <strong>Custom Properties</strong> tab, select <strong>hugepages</strong> from the custom properties list, which displays <strong>Please select a key&#8230;&#8203;</strong> by default.</p>
</li>
<li>
<p>Enter the huge page size in KB.</p>
<div class="paragraph">
<p>You should set the huge page size to the largest size supported by the pinned host. The recommended size for x86_64 is 1 GiB.</p>
</div>
<div class="paragraph">
<p>The huge page size has the following requirements:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The virtual machine&#8217;s huge page size must be the same size as the pinned host&#8217;s huge page size.</p>
</li>
<li>
<p>The virtual machine&#8217;s memory size must fit into the selected size of the pinned host&#8217;s free huge pages.</p>
</li>
<li>
<p>The NUMA node size must be a multiple of the huge page&#8217;s selected size.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>To enable dynamic allocation of huge pages:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Disable the HugePages filter in the scheduler.</p>
</li>
<li>
<p>In the <code>[performance]</code> section in <code>/etc/vdsm/vdsm.conf</code> set the following:</p>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>use_dynamic_hugepages = true</p>
</div>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Comparison between dynamic and static hugepages</div>
<p>The following table outlines advantages and disadvantages of dynamic and static hugepages.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. Dynamic vs static hugepages</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 16.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Setting</th>
<th class="tableblock halign-left valign-top">Advantages</th>
<th class="tableblock halign-left valign-top">Disadvantages</th>
<th class="tableblock halign-left valign-top">Recommendations</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>dynamic hugepages</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Less configuration required</p>
</li>
<li>
<p>Less wasted memory (i.e. hugepages free on a host waiting for possible incoming migrations)</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Failure to allocate due to fragmentation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Use 2MB hugepages</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>static hugepages</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Predictable results</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Requires a kernel command line in the Edit Host configuration in the Administraion Portal. See <a href="https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/html-single/rest_api_guide/index#types-operating_system-attributes-custom_kernel_cmdline">Custom kernel command line</a></p>
</li>
<li>
<p>Requires a host reboot.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The following limitations apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Memory hotplug/unplug is disabled</p>
</li>
<li>
<p>The host&#8217;s memory resource is limited</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="Disabling_KSM">Disabling KSM</h5>
<div class="paragraph">
<p>To disable Kernel Same-page Merging (KSM) for the cluster:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Clusters</b></span> and select the cluster.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>In the <strong>Optimization</strong> tab, clear the <strong>Enable KSM</strong> check box.</p>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Configuring_timezones">4.11. Configuring the time zone</h3>
<div class="paragraph">
<p>oVirt stores time zone configurations for virtual machines in <code>/etc/ovirt-engine/conf/00-timezone.properties</code>. This file contains default time zone values such as <code>Etc/GMT=Greenwich Standard Time</code>. It features mappings that are valid for Windows and non-Windows time zones.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not edit the actual <code>00-timezone.properties</code> file. Changes will be overwritten if you upgrade or restore the Engine.</p>
</div>
<div class="paragraph">
<p>Do not change values that come directly from the operating system or the Engine.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Create an override file in <code>/etc/ovirt-engine/conf/</code>. The file name must begin with a value greater than <code>00</code>, so that the file appears after <code>/etc/ovirt-engine/conf/00-timezone.properties</code>, and ends with the extension, <code>.properties</code>.</p>
<div class="paragraph">
<p>For example, <code>10-timezone.properties</code> overrides the default file, <code>00-timezone.properties</code>. The last file in the file list has precedence over earlier files.</p>
</div>
</li>
<li>
<p>Add new time zones to that file. Be sure each key is a valid General time zone from the <a href="https://en.wikipedia.org/wiki/Tz_database">time zone database</a> and the value is a valid Windows time zone:</p>
<div class="dlist">
<dl>
<dt class="hdlist1">General</dt>
<dd>
<p>Time zones used for non-Windows operating system types, must follow the standard time zone format for example, <code>Etc/GMT</code> or <code>Asia/Jerusalem</code>.</p>
</dd>
<dt class="hdlist1">Windows</dt>
<dd>
<p>Time zones specifically supported on <a href="https://docs.microsoft.com/en-us/previous-versions/windows/embedded/ms912391(v=winembedded.11)?redirectedfrom=MSDN">Windows</a> for example, <code>GMT Standard Time</code> or <code>Israel Standard Time</code>.</p>
</dd>
</dl>
</div>
</li>
<li>
<p>Restart the <code>ovirt-engine</code> service:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart ovirt-engine</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chap-Editing_Virtual_Machines">5. Editing Virtual Machines</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="Editing_Virtual_Machine_Properties">5.1. Editing Virtual Machine Properties</h3>
<div class="paragraph">
<p>Changes to storage, operating system, or networking parameters can adversely affect the virtual machine. Ensure that you have the correct details before attempting to make any changes. Virtual machines can be edited while running, and some changes (listed in the procedure below) will be applied immediately. To apply all other changes, the virtual machine must be shut down and restarted.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>External virtual machines (marked with the prefix <strong>external</strong>) cannot be edited through the oVirt Engine.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Editing Virtual Machines</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Select the virtual machine to be edited.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Change settings as required.</p>
<div class="paragraph">
<p>Changes to the following settings are applied immediately:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Name</strong></p>
</li>
<li>
<p><strong>Description</strong></p>
</li>
<li>
<p><strong>Comment</strong></p>
</li>
<li>
<p><strong>Optimized for</strong> (Desktop/Server/High Performance)</p>
</li>
<li>
<p><strong>Delete Protection</strong></p>
</li>
<li>
<p><strong>Network Interfaces</strong></p>
</li>
<li>
<p><strong>Memory Size</strong> (Edit this field to hot plug virtual memory. See <a href="#Hot_Plugging_Virtual_Memory">Hot Plugging Virtual Memory</a>.)</p>
</li>
<li>
<p><strong>Virtual Sockets</strong> (Edit this field to hot plug CPUs. See <a href="#CPU_hot_plug">Hot Plugging vCPUs</a>.)</p>
</li>
<li>
<p><strong>Highly Available</strong></p>
</li>
<li>
<p><strong>Priority for Run/Migration queue</strong></p>
</li>
<li>
<p><strong>Disable strict user checking</strong></p>
</li>
<li>
<p><strong>Icon</strong></p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
<li>
<p>If the <strong>Next Start Configuration</strong> pop-up window appears, click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Some changes are applied immediately. All other changes are applied when you shut down and restart your virtual machine. Until then, the pending changes icon (<span class="image"><img src="common/images/pendingchanges.png" alt="pendingchanges"></span>) appears as a reminder to restart the virtual machine.</p>
</div>
</div>
<div class="sect2">
<h3 id="sect-Network_Interfaces">5.2. Network Interfaces</h3>
<div class="sect3">
<h4 id="Adding_a_Network_Interface">5.2.1. Adding a New Network Interface</h4>
<div class="paragraph">
<p>You can add multiple network interfaces to virtual machines. Doing so allows you to put your virtual machine on multiple logical networks.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can create an overlay network for your virtual machines, isolated from the hosts, by defining a logical network that is not attached to the physical interfaces of the host. For example, you can create a DMZ environment, in which the virtual machines communicate among themselves over the bridge created in the host.</p>
</div>
<div class="paragraph">
<p>The overlay network uses OVN, which must be installed as an external network provider. See the  <a href="https://ovirt.org/documentation/administration_guide/index#Adding_OVN_as_an_External_Network_Provider"><em>Administration Guide</em></a> for more information</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Adding Network Interfaces to Virtual Machines</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click a virtual machine name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Network Interfaces</strong> tab.</p>
</li>
<li>
<p>Click <strong>New</strong>.</p>
</li>
<li>
<p>Enter the <strong>Name</strong> of the network interface.</p>
</li>
<li>
<p>Select the <strong>Profile</strong> and the <strong>Type</strong> of network interface from the drop-down lists. The <strong>Profile</strong> and <strong>Type</strong> drop-down lists are populated in accordance with the profiles and network types available to the cluster and the network interface cards available to the virtual machine.</p>
</li>
<li>
<p>Select the <strong>Custom MAC address</strong> check box and enter a MAC address for the network interface card as required.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The new network interface is listed in the <strong>Network Interfaces</strong> tab in the details view of the virtual machine. The <strong>Link State</strong> is set to <strong>Up</strong> by default when the network interface card is defined on the virtual machine and connected to the network.</p>
</div>
<div class="paragraph">
<p>For more details on the fields in the <strong>New Network Interface</strong> window, see <a href="#Virtual_Machine_Network_Interface_dialogue_entries">Explanation of Settings in the New Network Interface and Edit Network Interface Windows</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="Editing_network_interfaces">5.2.2. Editing a Network Interface</h4>
<div class="paragraph">
<p>In order to change any network settings, you must edit the network interface. This procedure can be performed on virtual machines that are running, but some actions can be performed only on virtual machines that are not running.</p>
</div>
<div class="paragraph">
<p><strong>Editing Network Interfaces</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click a virtual machine name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Network Interfaces</strong> tab and select the network interface to edit.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Change settings as required. You can specify the <strong>Name</strong>, <strong>Profile</strong>, <strong>Type</strong>, and <strong>Custom MAC address</strong>. See <a href="#Adding_a_Network_Interface">Adding a New Network Interface</a>.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Hot_Plugging_Network_Interfaces">5.2.3. Hot Plugging a Network Interface</h4>
<div class="paragraph">
<p>You can hot plug network interfaces. Hot plugging means enabling and disabling devices while a virtual machine is running.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The guest operating system must support hot plugging network interfaces.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Hot Plugging Network Interfaces</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click the virtual machine&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Network Interfaces</strong> tab and select the network interface to hot plug.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Set the <strong>Card Status</strong> to <strong>Plugged</strong> to enable the network interface, or set it to <strong>Unplugged</strong> to disable the network interface.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Removing_a_Network_Interface">5.2.4. Removing a Network Interface</h4>
<div class="paragraph">
<p><strong>Removing Network Interfaces</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click a virtual machine name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Network Interfaces</strong> tab and select the network interface to remove.</p>
</li>
<li>
<p>Click <b class="button">Remove</b>.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Blacklisting_Network_Interfaces">5.2.5. Blacklisting Network Interfaces</h4>
<div class="paragraph">
<p>You can configure the <code>ovirt-guest-agent</code> on a virtual machine to ignore certain NICs. This prevents IP addresses associated with network interfaces created by certain software from appearing in reports. You must specify the name and number of the network interface you want to blacklist (for example, <code>eth0</code>, <code>docker0</code>).</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must blacklist NICs on the virtual machine before the guest agent is started for the first time.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Blacklisting Network Interfaces</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <code>/etc/ovirt-guest-agent.conf</code> configuration file on the virtual machine, insert the following line, with the NICs to be ignored separated by spaces:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">ignored_nics = <em>first_NIC_to_ignore</em> <em>second_NIC_to_ignore</em></pre>
</div>
</div>
</li>
<li>
<p>Start the agent:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl start ovirt-guest-agent</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Some virtual machine operating systems automatically start the guest agent during installation.</p>
</div>
<div class="paragraph">
<p>If your virtual machine&#8217;s operating system automatically starts the guest agent or if you need to configure the blacklist on many virtual machines, use the configured virtual machine as a template for creating additional virtual machines. See <a href="#Creating_a_template_from_an_existing_virtual_machine">Creating a Template</a> for details.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Virtual_Disks">5.3. Virtual Disks</h3>
<div class="sect3">
<h4 id="Adding_a_Virtual_Disk">5.3.1. Adding a New Virtual Disk</h4>
<div class="paragraph">
<p>You can add multiple virtual disks to a virtual machine.</p>
</div>
<div class="paragraph">
<p><strong>Image</strong> is the default type of disk. You can also add a <strong>Direct LUN</strong> disk. <strong>Image</strong> disk creation is managed entirely by the Engine. <strong>Direct LUN</strong> disks require externally prepared targets that already exist. Existing disks are either floating disks or shareable disks attached to virtual machines.</p>
</div>
<div class="paragraph">
<p><strong>Adding Disks to Virtual Machines</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click a virtual machine name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Disks</strong> tab.</p>
</li>
<li>
<p>Click <b class="button">New</b>.</p>
</li>
<li>
<p>Use the appropriate radio buttons to switch between <strong>Image</strong> and <strong>Direct LUN</strong>.</p>
</li>
<li>
<p>Enter a <strong>Size(GB)</strong>, <strong>Alias</strong>, and <strong>Description</strong> for the new disk.</p>
</li>
<li>
<p>Use the drop-down lists and check boxes to configure the disk. See <a href="#Add_Virtual_Disk_dialogue_entries">Explanation of settings in the New Virtual Disk and Edit Virtual Disk windows</a> for more details on the fields for all disk types.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The new disk appears in the details view after a short time.</p>
</div>
</div>
<div class="sect3">
<h4 id="Associating_a_Virtual_Disk_with_a_Virtual_Machine">5.3.2. Attaching an Existing Disk to a Virtual Machine</h4>
<div class="paragraph">
<p>Floating disks are disks that are not associated with any virtual machine.</p>
</div>
<div class="paragraph">
<p>Floating disks can minimize the amount of time required to set up virtual machines. Designating a floating disk as storage for a virtual machine makes it unnecessary to wait for disk preallocation at the time of a virtual machine&#8217;s creation.</p>
</div>
<div class="paragraph">
<p>Floating disks can be attached to a single virtual machine, or to multiple virtual machines if the disk is shareable. Each virtual machine that uses the shared disk can use a different disk interface type.</p>
</div>
<div class="paragraph">
<p>Once a floating disk is attached to a virtual machine, the virtual machine can access it.</p>
</div>
<div class="paragraph">
<p><strong>Attaching Virtual Disks to Virtual Machines</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click a virtual machine name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Disks</strong> tab.</p>
</li>
<li>
<p>Click <b class="button">Attach</b>.</p>
</li>
<li>
<p>Select one or more virtual disks from the list of available disks and select the required interface from the <strong>Interface</strong> drop-down.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>No Quota resources are consumed by attaching virtual disks to, or detaching virtual disks from, virtual machines.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="Extending_the_Available_Size_of_a_Virtual_Disk">5.3.3. Extending the Available Size of a Virtual Disk</h4>
<div class="paragraph">
<p>You can extend the available size of a virtual disk while the virtual disk is attached to a virtual machine. Resizing a virtual disk does not resize the underlying partitions or file systems on that virtual disk. Use the <code>fdisk</code> utility to resize the partitions and file systems as required. See <a href="https://access.redhat.com/articles/1190213">How to Resize a Partition using fdisk</a> for more information.</p>
</div>
<div class="paragraph">
<p><strong>Extending the Available Size of Virtual Disks</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click a virtual machine name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Disks</strong> tab and select the disk to edit.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Enter a value in the <code>Extend size by(GB)</code> field.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The target disk&#8217;s status becomes <code>locked</code> for a short time, during which the drive is resized. When the resizing of the drive is complete, the status of the drive becomes <code>OK</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="Hot_Plugging_a_Virtual_Disk">5.3.4. Hot Plugging a Virtual Disk</h4>
<div class="paragraph">
<p>You can hot plug virtual disks. Hot plugging means enabling or disabling devices while a virtual machine is running.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The guest operating system must support hot plugging virtual disks.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Hot Plugging Virtual Disks</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click a virtual machine name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Disks</strong> tab and select the virtual disk to hot plug.</p>
</li>
<li>
<p>Click <strong>More Actions</strong> (<span class="image"><img src="common/images/moreactions.png" alt="moreactions"></span>), then click <strong>Activate</strong> to enable the disk, or <strong>Deactivate</strong> to disable the disk.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Removing_Virtual_Disks_From_Virtual_Machines">5.3.5. Removing a Virtual Disk from a Virtual Machine</h4>
<div class="paragraph">
<p><strong>Removing Virtual Disks From Virtual Machines</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click a virtual machine name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Disks</strong> tab and select the virtual disk to remove.</p>
</li>
<li>
<p>Click <strong>More Actions</strong> (<span class="image"><img src="common/images/moreactions.png" alt="moreactions"></span>), then click <strong>Deactivate</strong>.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
<li>
<p>Click <b class="button">Remove</b>.</p>
</li>
<li>
<p>Optionally, select the <strong>Remove Permanently</strong> check box to completely remove the virtual disk from the environment. If you do not select this option - for example, because the disk is a shared disk - the virtual disk will remain in <span class="menuseq"><b class="menu">Storage</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Disks</b></span>.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the disk was created as block storage, for example iSCSI, and the <strong>Wipe After Delete</strong> check box was selected when creating the disk, you can view the log file on the host to confirm that the data has been wiped after permanently removing the disk. See <a href="https://ovirt.org/documentation/administration_guide/index#Settings_to_Wipe_Virtual_Disks_After_Deletion">Settings to Wipe Virtual Disks After Deletion</a> in the <em>Administration Guide</em>.</p>
</div>
<div class="paragraph">
<p>If the disk was created as block storage, for example iSCSI, and the <strong>Discard After Delete</strong> check box was selected on the storage domain before the disk was removed, a <code>blkdiscard</code> command is called on the logical volume when it is removed and the underlying storage is notified that the blocks are free. See <a href="https://ovirt.org/documentation/administration_guide/index#Setting_Discard_After_Delete_for_a_Storage_Domain">Setting Discard After Delete for a Storage Domain</a> in the <em>Administration Guide</em>. A <code>blkdiscard</code> is also called on the logical volume when a virtual disk is removed if the virtual disk is attached to at least one virtual machine with the <strong>Enable Discard</strong> check box selected.</p>
</div>
</div>
<div class="sect3">
<h4 id="importing-a-disk-image-from-an-imported-storage-domain">5.3.6. Importing a Disk Image from an Imported Storage Domain</h4>
<div class="paragraph">
<p>You can import floating virtual disks from an imported storage domain.</p>
</div>
<div class="paragraph">
<p>This procedure requires access to the Administration Portal.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only QEMU-compatible disks can be imported into the Engine.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Importing a Disk Image</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Storage</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Domains</b></span>.</p>
</li>
<li>
<p>Click an imported storage domain to go to the details view.</p>
</li>
<li>
<p>Click <strong>Disk Import</strong>.</p>
</li>
<li>
<p>Select one or more disk images and click <strong>Import</strong>. This opens the <strong>Import Disk(s)</strong> window.</p>
</li>
<li>
<p>Select the appropriate <strong>Disk Profile</strong> for each disk.</p>
</li>
<li>
<p>Click <b class="button">OK</b> to import the selected disks.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="importing-an-unregistered-disk-image-from-an-imported-storage-domain">5.3.7. Importing an Unregistered Disk Image from an Imported Storage Domain</h4>
<div class="paragraph">
<p>You can import floating virtual disks from a storage domain. Floating disks created outside of a oVirt environment are not registered with the Engine. Scan the storage domain to identify unregistered floating disks to be imported.</p>
</div>
<div class="paragraph">
<p>This procedure requires access to the Administration Portal.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Only QEMU-compatible disks can be imported into the Engine.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Importing a Disk Image</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Storage</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Domains</b></span>.</p>
</li>
<li>
<p>Click <strong>More Actions</strong> (<span class="image"><img src="common/images/moreactions.png" alt="moreactions"></span>), then click <strong>Scan Disks</strong> so that the Engine can identify unregistered disks.</p>
</li>
<li>
<p>Select an unregistered disk name and click <strong>Disk Import</strong>.</p>
</li>
<li>
<p>Select one or more disk images and click <strong>Import</strong>. This opens the <strong>Import Disk(s)</strong> window.</p>
</li>
<li>
<p>Select the appropriate <strong>Disk Profile</strong> for each disk.</p>
</li>
<li>
<p>Click <b class="button">OK</b> to import the selected disks.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Virtual_Memory">5.4. Virtual Memory</h3>
<div class="sect3">
<h4 id="Hot_Plugging_Virtual_Memory">5.4.1. Hot Plugging Virtual Memory</h4>
<div class="paragraph">
<p>You can hot plug virtual memory. Hot plugging means enabling or disabling devices while a virtual machine is running. Each time memory is hot plugged, it appears as a new memory device in the <strong>Vm Devices</strong> tab in the details view of the virtual machine, up to a maximum of 16 available slots. When the virtual machine is restarted, these devices are cleared from the <strong>Vm Devices</strong> tab without reducing the virtual machine&#8217;s memory, allowing you to hot plug more memory devices. If the hot plug fails (for example, if there are no more available slots), the memory increase will be applied when the virtual machine is restarted.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This feature is currently not supported for the self-hosted engine Engine virtual machine.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you might need to later hot unplug the memory that you are now hot plugging, see <a href="https://ovirt.org/documentation/virtual_machine_management_guide/index#Hot_Unplugging_Virtual_Memory">Hot Unplugging Virtual Memory</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a running virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>System</strong> tab.</p>
</li>
<li>
<p>Increase the <strong>Memory Size</strong> by entering the total amount required. Memory can be added in multiples of 256 MB. By default, the maximum memory allowed for the virtual machine is set to 4x the memory size specified. Though the value is changed in the user interface, the maximum value is not hot plugged, and you will see the pending changes icon (<span class="image"><img src="common/images/pendingchanges.png" alt="pendingchanges"></span>). To avoid that, you can change the maximum memory back to the original value.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
<div class="paragraph">
<p>This action opens the <strong>Pending Virtual Machine changes</strong> window, as some values such as <strong>maxMemorySizeMb</strong> and <strong>minAllocatedMem</strong> will not change until the virtual machine is restarted. However, the hot plug action is triggered by the change to the <strong>Memory Size</strong> value, which can be applied immediately.</p>
</div>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The virtual machine&#8217;s <strong>Defined Memory</strong> is updated in the <strong>General</strong> tab in the details view. You can see the newly added memory device in the <strong>Vm Devices</strong> tab in the details view.</p>
</div>
</div>
<div class="sect3">
<h4 id="Hot_Unplugging_Virtual_Memory">5.4.2. Hot Unplugging Virtual Memory</h4>
<div class="paragraph">
<p>You can hot unplug virtual memory. Hot unplugging disables devices while a virtual machine is running.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>Only memory added with hot plugging can be hot unplugged.</p>
</li>
<li>
<p>The virtual machine&#8217;s operating system must support memory hot unplugging.</p>
</li>
<li>
<p>The virtual machine must not have a memory balloon device enabled. This feature is disabled by default.</p>
</li>
<li>
<p>All blocks of the hot-plugged memory must be set to <strong>online_movable</strong> in the virtual machine&#8217;s device management rules. In virtual machines running up-to-date versions of Enterprise Linux or CoreOS, this rule is set by default. For information on device management rules, consult the documentation for the virtual machine&#8217;s operating system.</p>
</li>
<li>
<p>To ensure that hot plugged memory can be hot unplugged later, add the <code>movable_node</code> option to the kernel command line of the virtual machine as follows and reboot the virtual machine:</p>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="terminal"># grubby --update-kernel=ALL --args=&quot;movable_node&quot;</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information, see <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8//html-single/managing_monitoring_and_updating_the_kernel/configuring-kernel-command-line-parameters_managing-monitoring-and-updating-the-kernel#setting-kernel-command-line-parameters_configuring-kernel-command-line-parameters">Setting kernel command-line parameters</a> in the RHEL 8 document <em>Managing, monitoring and updating the kernel</em>.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a running virtual machine.</p>
</li>
<li>
<p>Click the <strong>Vm Devices</strong> tab.</p>
</li>
<li>
<p>In the <strong>Hot Unplug</strong> column, click <b class="button">Hot Unplug</b> beside the memory device to be removed.</p>
</li>
<li>
<p>Click <b class="button">OK</b> in the <strong>Memory Hot Unplug</strong> window.</p>
<div class="paragraph">
<p>The <strong>Physical Memory Guaranteed</strong> value for the virtual machine is decremented automatically if necessary.</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="CPU_hot_plug">5.5. Hot Plugging vCPUs</h3>
<div class="paragraph">
<p>You can hot plug vCPUs. Hot plugging means enabling or disabling devices while a virtual machine is running.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Hot unplugging a vCPU is only supported if the vCPU was previously hot plugged. A virtual machine&#8217;s vCPUs cannot be hot unplugged to less vCPUs than it was originally created with.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following prerequisites apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The virtual machine&#8217;s <strong>Operating System</strong> must be explicitly set in the <strong>New Virtual Machine</strong> or <strong>Edit Virtual Machine</strong> window.</p>
</li>
<li>
<p>The virtual machine&#8217;s operating system must support CPU hot plug. See the table below for support details.</p>
</li>
<li>
<p>Windows virtual machines must have the guest agents installed. See <a href="#Installing_the_Guest_Agents_and_Drivers_on_Windows">Installing the guest agents, tools, and drivers on Windows</a>.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Hot Plugging vCPUs</div>
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a running virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>System</strong> tab.</p>
</li>
<li>
<p>Change the value of <strong>Virtual Sockets</strong> as required.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<table id="CPU_hotplug_OS_support" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. Operating System Support Matrix for vCPU Hot Plug</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Operating System</th>
<th class="tableblock halign-left valign-top">Version</th>
<th class="tableblock halign-left valign-top">Architecture</th>
<th class="tableblock halign-left valign-top">Hot Plug Supported</th>
<th class="tableblock halign-left valign-top">Hot Unplug Supported</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enterprise Linux Atomic Host 7</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x86</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enterprise Linux 6.3+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x86</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enterprise Linux 7.0+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x86</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enterprise Linux 7.3+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PPC64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enterprise Linux 8.0+</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x86</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft Windows Server 2012 R2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft Windows Server 2016</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard, Datacenter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft Windows Server 2019</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Standard, Datacenter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft Windows 8.x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x86</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft Windows 8.x</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft Windows 10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x86</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Microsoft Windows 10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">x64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="Pinning_a_Virtual_Machine_to_Multiple_Hosts">5.6. Pinning a Virtual Machine to Multiple Hosts</h3>
<div class="paragraph">
<p>Virtual machines can be pinned to multiple hosts. Multi-host pinning allows a virtual machine to run on a specific subset of hosts within a cluster, instead of one specific host or all hosts in the cluster. The virtual machine cannot run on any other hosts in the cluster even if all of the specified hosts are unavailable. Multi-host pinning can be used to limit virtual machines to hosts with, for example, the same physical hardware configuration.</p>
</div>
<div class="paragraph">
<p>If a host fails, a highly available virtual machine is automatically restarted on one of the other hosts to which the virtual machine is pinned.</p>
</div>
<div class="paragraph">
<p><strong>Pinning Virtual Machines to Multiple Hosts</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>Host</strong> tab.</p>
</li>
<li>
<p>Select the <strong>Specific Host(s)</strong> radio button under <strong>Start Running On</strong> and select two or more hosts from the list.</p>
</li>
<li>
<p>Click the <strong>High Availability</strong> tab.</p>
</li>
<li>
<p>Select the <strong>Highly Available</strong> check box.</p>
</li>
<li>
<p>Select <strong>Low</strong>, <strong>Medium</strong>, or <strong>High</strong> from the <strong>Priority</strong> drop-down list. When migration is triggered, a queue is created in which the high priority virtual machines are migrated first. If a cluster is running low on resources, only the high priority virtual machines are migrated.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Viewing_Virtual_Machines_Pinned_to_a_Host">5.7. Viewing Virtual Machines Pinned to a Host</h3>
<div class="paragraph">
<p>You can view virtual machines pinned to a host even while the virtual machines are offline. Use the <strong>Pinned to Host</strong> list to see which virtual machines will be affected and which virtual machines will require a manual restart after the host becomes active again.</p>
</div>
<div class="paragraph">
<p><strong>Viewing Virtual Machines Pinned to a Host</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Hosts</b></span>.</p>
</li>
<li>
<p>Click a host name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Virtual Machines</strong> tab.</p>
</li>
<li>
<p>Click <b class="button">Pinned to Host</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Changing_the_CD_for_a_Virtual_Machine">5.8. Changing the CD for a Virtual Machine</h3>
<div class="paragraph">
<p>You can change the CD accessible to a virtual machine while that virtual machine is running, using ISO images that have been uploaded to the data domain of the virtual machine&#8217;s cluster. See <a href="https://ovirt.org/documentation/administration_guide/index#Uploading_Images_to_a_Data_Storage_Domain">Uploading Images to a Data Storage Domain</a> in the <em>Administration Guide</em> for details.</p>
</div>
<div class="paragraph">
<p><strong>Changing the CD for a Virtual Machine</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a running virtual machine.</p>
</li>
<li>
<p>Click <strong>More Actions</strong> (<span class="image"><img src="common/images/moreactions.png" alt="moreactions"></span>), then click <strong>Change CD</strong>.</p>
</li>
<li>
<p>Select an option from the drop-down list:</p>
<div class="ulist">
<ul>
<li>
<p>Select an ISO file from the list to eject the CD currently accessible to the virtual machine and mount that ISO file as a CD.</p>
</li>
<li>
<p>Select <strong>[Eject]</strong> from the list to eject the CD currently accessible to the virtual machine.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Enabling_and_Disabling_Smartcards">5.9. Smart Card Authentication</h3>
<div class="paragraph">
<p>Smart cards are an external hardware security feature, most commonly seen in credit cards, but also used by many businesses as authentication tokens. Smart cards can be used to protect oVirt virtual machines.</p>
</div>
<div class="paragraph">
<p><strong>Enabling Smart Cards</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the smart card hardware is plugged into the client machine and is installed according to manufacturer&#8217;s directions.</p>
</li>
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>Console</strong> tab and select the <strong>Smartcard enabled</strong> check box.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
<li>
<p>Connect to the running virtual machine by clicking the <strong>Console</strong> button. Smart card authentication is now passed from the client hardware to the virtual machine.</p>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the Smart card hardware is not correctly installed, enabling the Smart card feature will result in the virtual machine failing to load properly.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Disabling Smart Cards</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>Console</strong> tab, and clear the <strong>Smartcard enabled</strong> check box.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Configuring Client Systems for Smart Card Sharing</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Smart cards may require certain libraries in order to access their certificates. These libraries must be visible to the NSS library, which <code>spice-gtk</code> uses to provide the smart card to the guest. NSS expects the libraries to provide the PKCS #11 interface.</p>
</li>
<li>
<p>Make sure that the module architecture matches the  <code>spice-gtk</code> / <code>remote-viewer</code> architecture. For instance, if you have only the 32b PKCS #11 library available, you must install the 32b build of virt-viewer in order for smart cards to work.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Configuring RHEL Clients for Smart Card support</strong></p>
</div>
<div class="paragraph">
<p>Enterprise Linux provides support for Smart cards. Install the <code>Smart card support</code> group. If the Smart Card Support group is installed on a Enterprise Linux system, smart cards are redirected to the guest when Smart Cards are enabled.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To install the <code>Smart card support</code> group, run the following command:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf groupinstall "Smart card support"</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Configuring RHEL Clients with Other Smart Card Middleware</strong></p>
</div>
<div class="paragraph">
<p>Enterprise Linux provides a system-wide registry of pkcs11 modules in the <strong>p11-kit</strong>, and these are accessible to all applications.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>To register the third party PKCS#11 library in the p11-kit database, run the following command as root:</p>
<div class="listingblock">
<div class="content">
<pre># echo "module: /path/to/library.so" &gt; /etc/pkcs11/modules/my.module</pre>
</div>
</div>
</li>
<li>
<p>To verify the Smart card is visible for p11-kit through this library run the following command:</p>
<div class="listingblock">
<div class="content">
<pre>$ p11-kit list-modules</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Configuring Windows Clients</strong></p>
</div>
<div class="paragraph">
<p>Red Hat does not provide PKCS #11 support to Windows clients. Libraries that provide PKCS #11 support must be obtained from third parties.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When such libraries are obtained, register them by running the following command as a user with elevated privileges:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">modutil -dbdir %PROGRAMDATA%\pki\nssdb -add "<em>module name</em>" -libfile C:_\Path\to\module_.dll</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chap-Administrative_Tasks">6. Administrative Tasks</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="Shutting_down_a_virtual_machine">6.1. Shutting Down a Virtual Machine</h3>
<div class="paragraph">
<p>You can turn off a virtual machine using <strong>Shutdown</strong> or <strong>Power Off</strong>. <strong>Shutdown</strong> gracefully shuts down a virtual machine. <strong>Power Off</strong> executes a hard shutdown. A graceful shutdown is usually preferable to a hard shutdown.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If an exclamation point appears next to the virtual machine, a snapshot deletion process has failed, and you may not be able to restart the machine after shutting it down. Try to delete the snapshot again and ensure that the explanation mark disappears before shutting down the virtual machine. See <a href="#Deleting_a_snapshot">Deleting a Snapshot</a> for more information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a running virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Shutdown</b> or right-click the virtual machine and select <strong>Shutdown</strong> from the pop-up menu.</p>
</li>
<li>
<p>Optionally in the Administration Portal, enter a <strong>Reason</strong> for shutting down the virtual machine in the <strong>Shut down Virtual Machine(s)</strong> confirmation window. This allows you to provide an explanation for the shutdown, which will appear in the logs and when the virtual machine is powered on again.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The virtual machine shutdown <strong>Reason</strong> field will only appear if it has been enabled in the cluster settings. For more information, see <a href="https://ovirt.org/documentation/administration_guide/index#sect-Cluster_Tasks">Explanation of Settings and Controls in the New Cluster and Edit Cluster Windows</a> in the <em>Administration Guide</em>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Click <b class="button">OK</b> in the <strong>Shut down Virtual Machine(s)</strong> confirmation window.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the virtual machine gracefully shuts down, the <strong>Status</strong> of the virtual machine changes to <code>Down</code>. If the virtual machine does not gracefully shut down, click the down arrow next to <b class="button">Shutdown</b> and then click <b class="button">Power Off</b> to execute a hard shutdown, or right-click the virtual machine and select <strong>Power Off</strong> from the pop-up menu.</p>
</div>
</div>
<div class="sect2">
<h3 id="Suspending_a_virtual_machine">6.2. Suspending a Virtual Machine</h3>
<div class="paragraph">
<p>Suspending a virtual machine is equal to placing that virtual machine into <strong>Hibernate</strong> mode.</p>
</div>
<div class="paragraph">
<p><strong>Suspending a Virtual Machine</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a running virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Suspend</b> or right-click the virtual machine and select <strong>Suspend</strong> from the pop-up menu.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The <strong>Status</strong> of the virtual machine changes to <code>Suspended</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="Rebooting_a_Virtual_Machine">6.3. Rebooting or Resetting a Virtual Machine</h3>
<div class="paragraph">
<p>You can restart your virtual machines in two different ways; either using reboot or reset.</p>
</div>
<div class="paragraph">
<p>Several situations can occur where you need to reboot the virtual machine, such as after an update or configuration change. When you reboot, the virtual machine&#8217;s console remains open while the guest operating system is restarted.</p>
</div>
<div class="paragraph">
<p>If a guest operating system can not be loaded or has become unresponsive, you need to reset the virtual machine. When you reset, the virtual machine&#8217;s console remains open while the guest operating system is restarted.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The reset reset operation can only be performed from the Administration Portal.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Rebooting a Virtual Machine</strong></p>
</div>
<div class="paragraph">
<p>To reboot a virtual machine:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a running virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Reboot</b> or right-click the virtual machine and select <strong>Reboot</strong> from the pop-up menu.</p>
</li>
<li>
<p>Click <b class="button">OK</b> in the <strong>Reboot Virtual Machine(s)</strong> confirmation window.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Resetting a Virtual Machine</strong></p>
</div>
<div class="paragraph">
<p>To reset a virtual machine:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a running virtual machine.</p>
</li>
<li>
<p>Click the down arrow next to <b class="button">Reboot</b>, then click <strong>Reset</strong>, or right-click the virtual machine and select <strong>Reset</strong> from the pop-up menu.</p>
</li>
<li>
<p>Click <b class="button">OK</b> in the <strong>Reset Virtual Machine(s)</strong> confirmation window.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>During reboot and reset operations, the <strong>Status</strong> of the virtual machine changes to <code>Reboot In Progress</code> before returning to <code>Up</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="Removing_a_virtual_machine">6.4. Removing a Virtual Machine</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <b class="button">Remove</b> button is disabled while virtual machines are running; you must shut down a virtual machine before you can remove it.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Removing Virtual Machines</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select the virtual machine to remove.</p>
</li>
<li>
<p>Click <b class="button">Remove</b>.</p>
</li>
<li>
<p>Optionally, select the <strong>Remove Disk(s)</strong> check box to remove the virtual disks attached to the virtual machine together with the virtual machine. If the <strong>Remove Disk(s)</strong> check box is cleared, then the virtual disks remain in the environment as floating disks.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Cloning_a_Virtual_Machine">6.5. Cloning a Virtual Machine</h3>
<div class="paragraph">
<p>You can clone virtual machines without having to create a template or a snapshot first.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <strong>Clone VM</strong> button is disabled while virtual machines are running; you must shut down a virtual machine before you can clone it.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Cloning Virtual Machines</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select the virtual machine to clone.</p>
</li>
<li>
<p>Click <strong>More Actions</strong> (<span class="image"><img src="common/images/moreactions.png" alt="moreactions"></span>), then click <strong>Clone VM</strong>.</p>
</li>
<li>
<p>Enter a <strong>Clone Name</strong> for the new virtual machine.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="sect-Updating_Virtual_Machine_Guest_Agents_and_Drivers">6.6. Updating Virtual Machine Guest Agents and Drivers</h3>
<div class="paragraph">
<p>The oVirt guest agents, tools, and drivers provide additional functionality for virtual machines, such as gracefully shutting down or rebooting virtual machines from the VM Portal and Administration Portal. The tools and agents also provide information for virtual machines, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resource usage</p>
</li>
<li>
<p>IP addresses</p>
</li>
<li>
<p>Installed applications</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The guest tools are distributed as an ISO file that you can attach to virtual machines. This ISO file is packaged as an RPM file that you can install and update from the Engine machine.</p>
</div>
<div class="sect3">
<h4 id="Updating_the_Guest_Agents_and_Drivers_on_Red_Hat_Enterprise_Linux">6.6.1. Updating the Guest Agents and Drivers on Enterprise Linux</h4>
<div class="paragraph">
<p>Update the guest agents and drivers on your Enterprise Linux virtual machines to use the latest version.</p>
</div>
<div class="paragraph">
<p><strong>Updating the Guest Agents and Drivers on Enterprise Linux</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in to the Enterprise Linux virtual machine.</p>
</li>
<li>
<p>Update the <code>ovirt-guest-agent-common</code> package:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum update ovirt-guest-agent-common</pre>
</div>
</div>
</li>
<li>
<p>Restart the service:</p>
<div class="ulist">
<ul>
<li>
<p>For Enterprise Linux 6</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># service ovirt-guest-agent restart</pre>
</div>
</div>
</li>
<li>
<p>For Enterprise Linux 7</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart ovirt-guest-agent.service</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Updating_Win_Guest_Drivers_with_Windows_Updates">6.6.2. Updating Windows drivers with Windows Update</h4>
<div class="paragraph">
<p>When you need to update the drivers for a Windows virtual machine, the simplest method is to use Windows Update.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Log in to the virtual machine.</p>
</li>
<li>
<p>Ensure that Windows Update is enabled so you can get updates.</p>
</li>
<li>
<p>Check Windows Update for updates from <strong>Red Hat, Inc</strong>.</p>
</li>
<li>
<p>Manually install any updates that have not been automatically installed.</p>
</li>
</ol>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="#Updating_the_Guest_Agents_and_Drivers_on_Windows">Updating Windows guest agents and drivers using the command prompt</a></p>
</li>
<li>
<p>See the Microsoft documentation for details on using Windows Update.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="Updating_the_Guest_Agents_and_Drivers_on_Windows">6.6.3. Updating Windows guest agents and drivers using the command prompt</h4>
<div class="paragraph">
<p>When you do not have access to Windows Update to update Windows drivers, or when you need to update the Windows guest agents, you can do so from the <code>virtio-win</code> package by using the virtual machine&#8217;s command prompt. During this procedure, you must remove and reinstall the drivers, which can lead to network disruption. This procedure restores your settings after reinstalling the drivers.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>If you are updating the drivers, on the Windows virtual machine, use the <code>netsh</code> utility to save TCP settings before uninstalling the netkvm driver:</p>
<div class="listingblock">
<div class="content">
<pre>C:\WINDOWS\system32&gt;netsh dump &gt; filename.txt</pre>
</div>
</div>
</li>
<li>
<p>On the Engine machine, update the <code>virtio-win</code> package to the latest version:</p>
<div class="listingblock">
<div class="content">
<pre># dnf upgrade -y virtio-win</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>virtio-win<em>_version</em>.iso</code> file is located in <code>/usr/share/virtio-win/</code> on the Engine machine.</p>
</div>
</li>
<li>
<p>Upload the ISO file to a data domain. For more information, see <a href="https://ovirt.org/documentation/administration_guide/index#Uploading_Images_to_a_Data_Storage_Domain_storage_tasks">Uploading Images to a Data Storage Domain</a> in the <em>Administration Guide</em>.</p>
</li>
<li>
<p>In the Administration or VM Portal, if the virtual machine is running, use the <strong>Change CD</strong> drop-down list to attach the virtio-win<em>_version</em>.iso file to each of your virtual machines. If the virtual machine is powered off, click the <b class="button">Run Once</b> button and attach the ISO as a CD.</p>
</li>
<li>
<p>Log in to the virtual machine.</p>
</li>
<li>
<p>Select the CD Drive (<code>D:\</code> for this example) containing the virtio-win<em>_version</em>.iso file.</p>
</li>
<li>
<p>Reinstall the guest agents or drivers:</p>
<div class="ulist">
<ul>
<li>
<p>To reinstall only the guest agents, use <code>qemu-ga-x86_64.msi</code>:</p>
<div class="listingblock">
<div class="content">
<pre>C:\WINDOWS\system32&gt;msiexec.exe /i D:\guest-agent\qemu-ga-x86_64.msi /passive /norestart</pre>
</div>
</div>
</li>
<li>
<p>To install the guest agents and drivers, or just the drivers, use <code>virtio-win-gt-x64.msi</code>:</p>
<div class="listingblock">
<div class="content">
<pre>C:\WINDOWS\system32&gt;msiexec.exe /i D:\virtio-win-gt-x64.msi /passive /norestart</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>If you are updating the drivers, restore the settings you saved using <code>netsh</code>:</p>
<div class="listingblock">
<div class="content">
<pre>C:\WINDOWS\system32&gt;netsh -f filename.txt</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Viewing_Satellite_Errata">6.7. Viewing Red Hat Satellite Errata for a Virtual Machine</h3>
<div class="paragraph">
<p>Errata for each virtual machine can be viewed after the oVirt virtual machine has been configured to receive errata information from the Red Hat Satellite server.</p>
</div>
<div class="paragraph">
<p>For more information on configuring a virtual machine to display available errata see <a href="#Configuring_Satellite_Errata">Configuring Satellite errata viewing for a virtual machine</a></p>
</div>
<div class="paragraph">
<p><strong>Viewing Red Hat Satellite Errata</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click the virtual machine&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click <strong>Errata</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="sect-Virtual_Machines_and_Permissions">6.8. Virtual Machines and Permissions</h3>
<div class="sect3">
<h4 id="Managing_System_Permissions_for_a_Virtual_Machine">6.8.1. Managing System Permissions for a Virtual Machine</h4>
<div class="paragraph">
<p>As the <strong>SuperUser</strong>, the system administrator manages all aspects of the Administration Portal. More specific administrative roles can be assigned to other users. These restricted administrator roles are useful for granting a user administrative privileges that limit them to a specific resource. For example, a <strong>DataCenterAdmin</strong> role has administrator privileges only for the assigned data center with the exception of the storage for that data center, and a <strong>ClusterAdmin</strong> has administrator privileges only for the assigned cluster.</p>
</div>
<div class="paragraph">
<p>A <strong>UserVmManager</strong> is a system administration role for virtual machines in a data center. This role can be applied to specific virtual machines, to a data center, or to the whole virtualized environment; this is useful to allow different users to manage certain virtual resources.</p>
</div>
<div class="paragraph">
<p>The user virtual machine administrator role permits the following actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create, edit, and remove virtual machines.</p>
</li>
<li>
<p>Run, suspend, shutdown, and stop virtual machines.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can only assign roles and permissions to existing users.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Many end users are concerned solely with the virtual machine resources of the virtualized environment. As a result, oVirt provides several user roles which enable the user to manage virtual machines specifically, but not other resources in the data center.</p>
</div>
</div>
<div class="sect3">
<h4 id="Virtual_Machine_Administrator_Roles_Explained">6.8.2. Virtual Machine Administrator Roles Explained</h4>
<div class="paragraph">
<p>The table below describes the administrator roles and privileges applicable to virtual machine administration.</p>
</div>
<table id="Virtual_Machine_Administrator_Roles" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. oVirt System Administrator Roles</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Privileges</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DataCenterAdmin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Data Center Administrator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Possesses administrative permissions for all objects underneath a specific data center except for storage.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ClusterAdmin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Cluster Administrator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Possesses administrative permissions for all objects underneath a specific cluster.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NetworkAdmin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network Administrator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Possesses administrative permissions for all operations on a specific logical network. Can configure and manage networks attached to virtual machines. To configure port mirroring on a virtual machine network, apply the <strong>NetworkAdmin</strong> role on the network and the <strong>UserVmManager</strong> role on the virtual machine.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="virtual-machine-user-roles-explained">6.8.3. Virtual Machine User Roles Explained</h4>
<div class="paragraph">
<p>The table below describes the user roles and privileges applicable to virtual machine users. These roles allow access to the VM Portal for managing and accessing virtual machines, but they do not confer any permissions for the Administration Portal.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. oVirt System User Roles</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Privileges</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UserRole</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can access and use virtual machines and pools.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can log in to the VM Portal and use virtual machines and pools.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PowerUserRole</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can create and manage virtual machines and templates.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apply this role to a user for the whole environment with the <strong>Configure</strong> window, or for specific data centers or clusters. For example, if a PowerUserRole is applied on a data center level, the PowerUser can create virtual machines and templates in the data center. Having a <strong>PowerUserRole</strong> is equivalent to having the <strong>VmCreator</strong>, <strong>DiskCreator</strong>, and <strong>TemplateCreator</strong> roles.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UserVmManager</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">System administrator of a virtual machine.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can manage virtual machines and create and use snapshots. A user who creates a virtual machine in the VM Portal is automatically assigned the UserVmManager role on the machine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UserTemplateBasedVm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Limited privileges to only use Templates.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Level of privilege to create a virtual machine by means of a template.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VmCreator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can create virtual machines in the VM Portal.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This role is not applied to a specific virtual machine; apply this role to a user for the whole environment with the <strong>Configure</strong> window. When applying this role to a cluster, you must also apply the <strong>DiskCreator</strong> role on an entire data center, or on specific storage domains.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VnicProfileUser</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical network and network interface user for virtual machines.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the <strong>Allow all users to use this Network</strong> option was selected when a logical network is created, <strong>VnicProfileUser</strong> permissions are assigned to all users for the logical network. Users can then attach or detach virtual machine network interfaces to or from the logical network.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Assigning_virtual_machines_to_users">6.8.4. Assigning Virtual Machines to Users</h4>
<div class="paragraph">
<p>If you are creating virtual machines for users other than yourself, you have to assign roles to the users before they can use the virtual machines. Note that permissions can only be assigned to existing users. See <a href="https://ovirt.org/documentation/administration_guide/index#chap-Users_and_Roles">Users and Roles</a> in the <em>Administration Guide</em> for details on creating user accounts.</p>
</div>
<div class="paragraph">
<p>The VM Portal supports three default roles: User, PowerUser and UserVmManager. However, customized roles can be configured via the Administration Portal. The default roles are described below.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <strong>User</strong> can connect to and use virtual machines. This role is suitable for desktop end users performing day-to-day tasks.</p>
</li>
<li>
<p>A <strong>PowerUser</strong> can create virtual machines and view virtual resources. This role is suitable if you are an administrator or manager who needs to provide virtual resources for your employees.</p>
</li>
<li>
<p>A <strong>UserVmManager</strong> can edit and remove virtual machines, assign user permissions, use snapshots and use templates. It is suitable if you need to make configuration changes to your virtual environment.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you create a virtual machine, you automatically inherit <strong>UserVmManager</strong> privileges. This enables you to make changes to the virtual machine and assign permissions to the users you manage, or users who are in your Identity Management (IdM) or RHDS group. See the  <a href="https://ovirt.org/documentation/administration_guide/index#Introduction_to_Directory_Servers"><em>Administration Guide</em></a> for more information.</p>
</div>
<div class="paragraph">
<p><strong>Assigning Permissions to Users</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click the virtual machine&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Permissions</strong> tab.</p>
</li>
<li>
<p>Click <b class="button">Add</b>.</p>
</li>
<li>
<p>Enter a name, or user name, or part thereof in the <strong>Search</strong> text box, and click <strong>Go</strong>. A list of possible matches display in the results list.</p>
</li>
<li>
<p>Select the check box of the user to be assigned the permissions.</p>
</li>
<li>
<p>Select <strong>UserRole</strong> from the <strong>Role to Assign</strong> drop-down list.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The user&#8217;s name and role display in the list of users permitted to access this virtual machine.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If a user is assigned permissions to only one virtual machine, single sign-on (SSO) can be configured for the virtual machine. With single sign-on enabled, when a user logs in to the VM Portal, and then connects to a virtual machine through, for example, a SPICE console, users are automatically logged in to the virtual machine and do not need to type in the user name and password again. Single sign-on can be enabled or disabled on a per virtual machine basis. See <a href="#sect-Configuring_Single_Sign-On_for_Virtual_Machines">Configuring Single Sign-On for Virtual Machines</a> for more information on how to enable and disable single sign-on for virtual machines.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="Removing_Access_to_Virtual_Machines_from_Users">6.8.5. Removing Access to Virtual Machines from Users</h4>
<div class="paragraph">
<p><strong>Removing Access to Virtual Machines from Users</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click the virtual machine&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click <strong>Permissions</strong>.</p>
</li>
<li>
<p>Click <b class="button">Remove</b>. A warning message displays, asking you to confirm removal of the selected permissions.</p>
</li>
<li>
<p>To proceed, click <b class="button">OK</b>. To abort, click <strong>Cancel</strong>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Snapshots">6.9. Snapshots</h3>
<div class="sect3">
<h4 id="Creating_a_snapshot_of_a_virtual_machine">6.9.1. Creating a Snapshot of a Virtual Machine</h4>
<div class="paragraph">
<p>A snapshot is a view of a virtual machine&#8217;s operating system and applications on any or all available disks at a given point in time. Take a snapshot of a virtual machine before you make a change to it that may have unintended consequences. You can use a snapshot to return a virtual machine to a previous state.</p>
</div>
<div class="paragraph">
<p><strong>Creating a Snapshot of a Virtual Machine</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click a virtual machine&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Snapshots</strong> tab and click <strong>Create</strong>.</p>
</li>
<li>
<p>Enter a description for the snapshot.</p>
</li>
<li>
<p>Select <strong>Disks to include</strong> using the check boxes.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If no disks are selected, a partial snapshot of the virtual machine, without a disk, is created. You can preview this snapshot to view the configuration of the virtual machine. Note that committing a partial snapshot will result in a virtual machine without a disk.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Select <strong>Save Memory</strong> to include a running virtual machine&#8217;s memory in the snapshot.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The virtual machine&#8217;s operating system and applications on the selected disk(s) are stored in a snapshot that can be previewed or restored. The snapshot is created with a status of <code>Locked</code>, which changes to <code>Ok</code>. When you click the snapshot, its details are shown on the <strong>General</strong>, <strong>Disks</strong>, <strong>Network Interfaces</strong>, and <strong>Installed Applications</strong> drop-down views in the <strong>Snapshots</strong> tab.</p>
</div>
</div>
<div class="sect3">
<h4 id="Using_a_snapshot_to_restore_a_virtual_machine">6.9.2. Using a Snapshot to Restore a Virtual Machine</h4>
<div class="paragraph">
<p>A snapshot can be used to restore a virtual machine to its previous state.</p>
</div>
<div class="paragraph">
<p><strong>Using Snapshots to Restore Virtual Machines</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click the virtual machine&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Snapshots</strong> tab to list the available snapshots.</p>
</li>
<li>
<p>Select a snapshot to restore in the upper pane. The snapshot details display in the lower pane.</p>
</li>
<li>
<p>Click the <b class="button">Preview drop-down menu</b> button and select <strong>Custom</strong>.</p>
</li>
<li>
<p>Use the check boxes to select the <strong>VM Configuration</strong>, <strong>Memory</strong>, and disk(s) you want to restore, then click <b class="button">OK</b>. This allows you to create and restore from a customized snapshot using the configuration and disk(s) from multiple snapshots.</p>
<div class="paragraph">
<p>The status of the snapshot changes to <code>Preview Mode</code>. The status of the virtual machine briefly changes to <code>Image Locked</code> before returning to <code>Down</code>.</p>
</div>
</li>
<li>
<p>Shut down the virtual machine.</p>
</li>
<li>
<p>Start the virtual machine; it runs using the disk image of the snapshot.</p>
</li>
<li>
<p>Click <strong>Commit</strong> to permanently restore the virtual machine to the condition of the snapshot. Any subsequent snapshots are erased.</p>
<div class="paragraph">
<p>Alternatively, click the <strong>Undo</strong> button to deactivate the snapshot and return the virtual machine to its previous state.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Creating_a_Virtual_Machine_from_a_Snapshot_vm_guide_administrative_tasks">6.9.3. Creating a Virtual Machine from a Snapshot</h4>
<div class="paragraph">
<p>You can use a snapshot to create another virtual machine.</p>
</div>
<div class="paragraph">
<p><strong>Creating a Virtual Machine from a Snapshot</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click the virtual machine&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Snapshots</strong> tab to list the available snapshots.</p>
</li>
<li>
<p>Select a snapshot in the list displayed and click <strong>Clone</strong>.</p>
</li>
<li>
<p>Enter the <strong>Name</strong> of the virtual machine.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>After a short time, the cloned virtual machine appears in the <strong>Virtual Machines</strong> tab in the navigation pane with a status of <code>Image Locked</code>. The virtual machine remains in this state until oVirt completes the creation of the virtual machine. A virtual machine with a preallocated 20 GB hard drive takes about fifteen minutes to create. Sparsely-allocated virtual disks take less time to create than do preallocated virtual disks.</p>
</div>
<div class="paragraph">
<p>When the virtual machine is ready to use, its status changes from <code>Image Locked</code> to <code>Down</code> in <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</div>
</div>
<div class="sect3">
<h4 id="Deleting_a_snapshot">6.9.4. Deleting a Snapshot</h4>
<div class="paragraph">
<p>You can delete a virtual machine snapshot and permanently remove it from your oVirt environment.</p>
</div>
<div class="paragraph">
<p><strong>Deleting a Snapshot</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click the virtual machine&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Snapshots</strong> tab to list the snapshots for that virtual machine.</p>
</li>
<li>
<p>Select the snapshot to delete.</p>
</li>
<li>
<p>Click <strong>Delete</strong>.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the deletion fails, fix the underlying problem (for example, a failed host, an inaccessible storage device, or a temporary network issue) and try again.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Host_Devices">6.10. Host Devices</h3>
<div class="sect3">
<h4 id="Adding_Host_Devices_to_a_Virtual_Machine">6.10.1. Adding a Host Device to a Virtual Machine</h4>
<div class="paragraph">
<p>To improve performance, you can attach a host device to a virtual machine.</p>
</div>
<div class="paragraph">
<p>Host devices are physical devices connected to a particular host machine, such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SCSI tape drives, disks, and changers</p>
</li>
<li>
<p>PCI NICs, GPUs, and HBAs</p>
</li>
<li>
<p>USB mice, cameras, and disks</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To add a host device to a virtual machine, you use the virtual machine&#8217;s <strong>Host Devices</strong> properties. First, you select one of the cluster hosts and a device type. Then, you choose and attach one or more of the host devices on that host.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When you change the <strong>Pinned Host</strong> setting, it removes the current host devices. When you save these changes, in the virtual machine&#8217;s <strong>Host</strong> settings, it sets <strong>Start Running On</strong> to <strong>Specific Host(s)</strong> and specifies the host you selected earlier using the <strong>Pinned Host</strong> setting.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you finish attaching one or more host devices, you run the virtual machine to apply the changes. The virtual machine starts on the host that has the attached host devices.</p>
</div>
<div class="paragraph">
<p>If the virtual machine cannot start on the specified host or access the host device, it cancels the start operation and produces an error message with information about the cause.</p>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The state of the host is <code>Up</code>.</p>
</li>
<li>
<p>The host is configured for direct device assignment.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>In the Administration Portal, click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Shut down the virtual machine.</p>
</li>
<li>
<p>Click the name of the virtual machine to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Host Devices</strong> tab.</p>
</li>
<li>
<p>Click <b class="button">Add device</b>. This opens the <strong>Add Host Devices</strong> pane.</p>
</li>
<li>
<p>Use <strong>Pinned Host</strong> to select the host where the virtual machine runs.</p>
</li>
<li>
<p>Use <strong>Capability</strong> to list <code>pci</code>, <code>scsi</code>, <code>nvdimm</code>, or <code>usb_device</code> devices.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>nvdimm</code> option is a technical preview feature. For more information, see <a href="#conc-nvdimm-host-devices_vm_guide_administrative_tasks">NVDIMM host devices</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Use <strong>Available Host Devices</strong> to select devices.</p>
</li>
<li>
<p>Click the down arrow to move devices to <strong>Host Devices to be attached</strong>.</p>
</li>
<li>
<p>Click <b class="button">OK</b> to attach these devices to the virtual machine and close the window.</p>
</li>
<li>
<p>Optional: If you attach a SCSI host device, configure the optimal driver.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click the <b class="button">Edit</b> button. This opens the <strong>Edit Virtual Machine</strong> pane.</p>
</li>
<li>
<p>Click the <strong>Custom Properties</strong> tab.</p>
</li>
<li>
<p>Click the <strong>Please select a key</strong> and select <strong>scsi_hostdev</strong> from the bottom of the drop-down list.</p>
</li>
<li>
<p>In most cases, select <strong>scsi-hd</strong>. Otherwise, for tape or CD changer devices, select the <strong>scsi_generic</strong> option. For more details, see <a href="https://ovirt.org/documentation/virtual_machine_management_guide/index#Virtual_Machine_Custom_Properties_settings_explained">Virtual Machine Custom Properties Settings Explained</a>.</p>
</li>
<li>
<p>Click the <b class="button">OK</b> button.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Run the virtual machine.</p>
</li>
<li>
<p>While the virtual machine starts running, watch for <strong>Operation Canceled</strong> error messages.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Troubleshooting</div>
<p>If you cannot add a host device to a virtual machine, or a virtual machine cannot start running with the attached host devices, it generates <strong>Operation Canceled</strong> error messages. For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>Operation Canceled
Error while executing action:

&lt;vm name&gt;:
* Cannot run VM. There is no host that satisfies current scheduling constraints. See below for details:
* The host &lt;first_hostname&gt; did not satisfy internal filter HostDevice because it does not support host device passthrough.
* The host &lt;second_hostname&gt; did not satisfy internal filter HostDevice because the host does not provide requested host devices.</pre>
</div>
</div>
<div class="paragraph">
<p>You can fix the error by removing the host device from the virtual machine or correcting the issues the error message describes. For example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Respond to a <code>The host &lt;hostname&gt; did not satisfy internal filter HostDevice because it does not support host device passthrough</code> message by configuring the host for device passthrough and restarting the virtual machine.</p>
</li>
<li>
<p>Respond to the <code>The host &lt;hostname&gt; did not satisfy internal filter HostDevice because the host does not provide requested host devices</code> message by adding the host device to the host.</p>
</li>
<li>
<p>Respond to a <code>Cannot add Host devices because the VM is in Up status</code> message by shutting down the virtual machine before adding a host device.</p>
</li>
<li>
<p>Verify that the state of the host is <code>Up</code>.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://ovirt.org/documentation/virtual_machine_management_guide/index#sect-host_devices">Host Devices</a> in the <em>Virtual Machine Management Guide</em>.</p>
</li>
<li>
<p><a href="https://ovirt.org/documentation/virtual_machine_management_guide/index#pinning_a_virtual_machine_to_multiple_hosts">Pinning a Virtual Machine to Multiple Hosts</a></p>
</li>
<li>
<p><a href="https://ovirt.org/documentation/administration_guide/index#Configuring_a_Host_for_PCI_Passthrough_host_tasks">Configuring a Host for PCI Passthrough</a></p>
</li>
<li>
<p><a href="https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/html-single/hardware_considerations_for_implementing_sr-iov/">Additional Hardware Considerations for Using Device Assignment</a> in <em>Hardware Considerations for Implementing SR-IOV</em>.</p>
</li>
<li>
<p><a href="#conc-nvdimm-host-devices_vm_guide_administrative_tasks">NVDIMM host devices</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="Removing_Host_Devices_from_a_Virtual_Machine">6.10.2. Removing Host Devices from a Virtual Machine</h4>
<div class="paragraph">
<p>If you are removing all host devices directly attached to the virtual machine in order to add devices from a different host, you can instead add the devices from the desired host, which will automatically remove all of the devices already attached to the virtual machine.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Select a virtual machine to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Host Devices</strong> tab to list the host devices attached to the virtual machine.</p>
</li>
<li>
<p>Select the host device to detach from the virtual machine, or hold <code>Ctrl</code> to select multiple devices, and click <b class="button">Remove device</b>. This opens the <strong>Remove Host Device(s)</strong> window.</p>
</li>
<li>
<p>Click <b class="button">OK</b> to confirm and detach these devices from the virtual machine.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Pinning_a_Virtual_Machine_to_Another_Host">6.10.3. Pinning a Virtual Machine to Another Host</h4>
<div class="paragraph">
<p>You can use the <strong>Host Devices</strong> tab in the details view of a virtual machine to pin it to a specific host.</p>
</div>
<div class="paragraph">
<p>If the virtual machine has any host devices attached to it, pinning it to another host automatically removes the host devices from the virtual machine.</p>
</div>
<div class="paragraph">
<p><strong>Pinning a Virtual Machine to a Host</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click a virtual machine name and click the <strong>Host Devices</strong> tab.</p>
</li>
<li>
<p>Click <strong>Pin to another host</strong>. This opens the <strong>Pin VM to Host</strong> window.</p>
</li>
<li>
<p>Use the <strong>Host</strong> drop-down menu to select a host.</p>
</li>
<li>
<p>Click <b class="button">OK</b> to pin the virtual machine to the selected host.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="conc-nvdimm-host-devices_vm_guide_administrative_tasks">6.10.4. NVDIMM host devices</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>NVDIMM devices are Technology Preview features only. Technology Preview features are not supported with Red Hat production service-level agreements (SLAs) and might not be functionally complete, and Red Hat does not recommend using them for production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process. For more information, see <a href="https://access.redhat.com/support/offerings/techpreview/">Red Hat Technology Preview Features Support Scope</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can add emulated NVDIMM devices to virtual machines. Elsewhere, this type of memory is also known as <em>virtual NVDIMM</em> or <em>vNVDIMM</em>.</p>
</div>
<div class="paragraph">
<p>The emulated NVDIMM you can attach to a virtual machine is backed by real NVDIMM on the host machine where the virtual machine runs. Therefore, when you attach NVDIMM to a virtual machine, you also pin the virtual machine to a specific host.</p>
</div>
<div class="paragraph">
<p>You can reconfigure the mode, partitioning, and other properties of the emulated NVDIMM device in the virtual machine without affecting the settings of the physical NVDIMM on the host device.</p>
</div>
<div class="paragraph">
<p>To add emulated NVDIMM to a virtual machine, see <a href="#Adding_Host_Devices_to_a_Virtual_Machine">Adding a Host Device to a Virtual Machine</a></p>
</div>
<div class="ulist">
<div class="title">Limitations</div>
<ul>
<li>
<p>Memory snapshots are disabled when an NVDIMM device is present in a virtual machine. There is no way to make a snapshot of NVDIMM content, and a memory snapshot cannot work correctly without having the corresponding NVDIMM data.</p>
</li>
<li>
<p>In oVirt, each NVDIMM device passed to a virtual machine has an automatically-assigned label area with a fixed size of 128 KB. IBM POWER hardware, and 128 KB is the minimum label size allowed by QEMU.</p>
</li>
<li>
<p>By default, the virtual machine uses the whole NVDIMM device. You cannot configure the size of the NVDIMM from the virtual machine. To configure its size, partition the NVDIMM device on the host and add the partition to the virtual machine.</p>
</li>
<li>
<p>The size of the NVDIMM device on the virtual machine may be slightly lower than on the host to comply with libvirt and QEMU alignment and size adjustments. Precise sizing is also needed to make memory hotplug work.</p>
</li>
<li>
<p>libvirt and QEMU adjust their size and label placement. If those internal arrangements change, it can cause data loss.</p>
</li>
<li>
<p>NVDIMM hotplug is not supported by the platform.</p>
</li>
<li>
<p>Virtual machines with NVDIMM devices cannot migrate because they are pinned to a host.</p>
</li>
<li>
<p>SELinux currently prevents access to NVDIMM devices in <code>devdax</code> mode, see <a href="https://bugzilla.redhat.com/1855336" class="bare">https://bugzilla.redhat.com/1855336</a>.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Avoid using NVDIMM on IBM POWER hardware. This combination is currently not expected to be stable until further work is completed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://github.com/qemu/qemu/blob/master/docs/nvdimm.txt">QEMU NVDIMM documentation</a></p>
</li>
<li>
<p><a href="#Adding_Host_Devices_to_a_Virtual_Machine">Adding a Host Device to a Virtual Machine</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Affinity_Groups">6.11. Affinity Groups</h3>
<div class="paragraph">
<p>Affinity groups help you determine where selected virtual machines run in relation to each other and specified hosts. This capability helps manage workload scenarios such as licensing requirements, high-availability workloads, and disaster recovery.</p>
</div>
<div class="paragraph">
<div class="title">The VM Affinity Rule</div>
<p>When you create an affinity group, you select the virtual machines that belong to the group. To define <em>where these virtual machines can run in relation to each other</em>, you enable a <strong>VM Affinity Rule</strong>: A positive rule tries to run the virtual machines together on a single host; a negative affinity rule tries to run the virtual machines apart on separate hosts. If the rule cannot be fulfilled, the outcome depends on whether the weight or filter module is enabled.</p>
</div>
<div class="paragraph">
<div class="title">The Host Affinity Rule</div>
<p>Optionally, you can add hosts to the affinity group. To define <em>where virtual machines in the group can run in relation to hosts in the group</em>, you enable a <strong>Host Affinity Rule</strong>: A positive rule tries to run the virtual machines on hosts in the affinity group; a negative affinity rule tries to run the virtual machines on hosts that are not in the affinity group. If the rule cannot be fulfilled, the outcome depends on whether the weight or filter module is enabled.</p>
</div>
<div class="paragraph">
<div class="title">The Default Weight Module</div>
<p>By default, both rules apply the <em>weight module</em> in the cluster&#8217;s scheduling policy. With the weight module, the scheduler attempts to fulfill a rule, but allows the virtual machines in the affinity group to run anyway if the rule cannot be fulfilled.</p>
</div>
<div class="paragraph">
<p>For example, with a positive <strong>VM Affinity Rule</strong> and the weight module enabled, the scheduler <em>tries</em> to run all of the affinity group&#8217;s virtual machines on a single host. However, if a single host does not have sufficient resources for this, the scheduler runs the virtual machines on multiple hosts.</p>
</div>
<div class="paragraph">
<p>For this module to work, the <strong>weight module</strong> section of the scheduling policies must contain the <code>VmAffinityGroups</code> and <code>VmToHostsAffinityGroups</code> keywords.</p>
</div>
<div class="paragraph">
<div class="title">The Enforcing Option and Filter Module</div>
<p>Both rules have an <strong>Enforcing</strong> option which applies the <em>filter module</em> in the cluster&#8217;s scheduling policy. The filter module overrides the weight module. With the filter module enabled, the scheduler <em>requires</em> that a rule be fulfilled. If a rule cannot be fulfilled, the filter module prevents the virtual machines in the affinity group from running.</p>
</div>
<div class="paragraph">
<p>For example, with a positive <strong>Host Affinity Rule</strong> and <strong>Enforcing</strong> enabled (the filter module enabled), the scheduler <em>requires</em> the affinity group&#8217;s virtual machines to run on hosts that are part of the affinity group. However, if those hosts are down, the scheduler does not run the virtual machines at all.</p>
</div>
<div class="paragraph">
<p>For this module to work, the <strong>filter module</strong> section of the scheduling policies must contain the <code>VmAffinityGroups</code> and <code>VmToHostsAffinityGroups</code> keywords.</p>
</div>
<div class="paragraph">
<div class="title">Examples</div>
<p>To see how these rules and options can be used with one another, see <a href="#Affinity_groups_examples">Affinity Groups Examples</a>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>An <em>affinity label</em> is functionally the same as an affinity group with a positive <strong>Host Affinity Rule</strong> and <strong>Enforcing</strong> enabled.</p>
</li>
<li>
<p>For affinity labels to work, the <strong>filter module</strong> section of the scheduling policies must contain <code>Label</code>.</p>
</li>
<li>
<p>If an affinity group and affinity label conflict with each other, the affected virtual machines do not run. To help prevent, troubleshoot, and resolve conflicts, see <a href="#Affinity_groups_troubleshooting">Affinity Groups Troubleshooting</a>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Each rule is affected by the weight and filter modules in the cluster&#8217;s scheduling policy.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For the <strong>VM Affinity Rule</strong> rule to work, the scheduling policy must have the <code>VmAffinityGroups</code> keyword in its <strong>Weight module</strong> and <strong>Filter module</strong> sections.</p>
</li>
<li>
<p>For the <strong>Host Affinity Rule</strong> to work, the scheduling policy must have the <code>VmToHostsAffinityGroups</code> keyword in its <strong>Weight module</strong> and <strong>Filter module</strong> sections.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information, see <a href="https://ovirt.org/documentation/administration_guide/index#sect-scheduling_policies">Scheduling Policies</a> in the <em>Administration Guide</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="ulist">
<ul>
<li>
<p>Affinity groups apply to virtual machines in a cluster. Moving a virtual machine from one cluster to another removes it from the affinity groups in the original cluster.</p>
</li>
<li>
<p>Virtual machines do not have to restart for the affinity group rules to take effect.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="Creating_an_Affinity_Group">6.11.1. Creating an Affinity Group</h4>
<div class="paragraph">
<p>You can create new affinity groups in the Administration Portal.</p>
</div>
<div class="paragraph">
<p><strong>Creating Affinity Groups</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click the virtual machine&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Affinity Groups</strong> tab.</p>
</li>
<li>
<p>Click <strong>New</strong>.</p>
</li>
<li>
<p>Enter a <strong>Name</strong> and <strong>Description</strong> for the affinity group.</p>
</li>
<li>
<p>From the <strong>VM Affinity Rule</strong> drop-down, select <strong>Positive</strong> to apply positive affinity or <strong>Negative</strong> to apply negative affinity. Select <strong>Disable</strong> to disable the affinity rule.</p>
</li>
<li>
<p>Select the <strong>Enforcing</strong> check box to apply hard enforcement, or ensure this check box is cleared to apply soft enforcement.</p>
</li>
<li>
<p>Use the drop-down list to select the virtual machines to be added to the affinity group. Use the <strong>+</strong> and <strong>-</strong> buttons to add or remove additional virtual machines.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Editing_an_Affinity_Group">6.11.2. Editing an Affinity Group</h4>
<div class="paragraph">
<p><strong>Editing Affinity Groups</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click the virtual machine&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Affinity Groups</strong> tab.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Change the <strong>VM Affinity Rule</strong> drop-down and <strong>Enforcing</strong> check box to the preferred values and use the <strong>+</strong> and <strong>-</strong> buttons to add or remove virtual machines to or from the affinity group.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Removing_an_Affinity_Group">6.11.3. Removing an Affinity Group</h4>
<div class="paragraph">
<p><strong>Removing Affinity Groups</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click the virtual machine&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Affinity Groups</strong> tab.</p>
</li>
<li>
<p>Click <b class="button">Remove</b>.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The affinity policy that applied to the virtual machines that were members of that affinity group no longer applies.</p>
</div>
</div>
<div class="sect3">
<h4 id="Affinity_groups_examples">6.11.4. Affinity Groups Examples</h4>
<div class="paragraph">
<p>The following examples illustrate how to apply affinity rules for various scenarios, using the different features of the affinity group capability described in this chapter.</p>
</div>
<div id="Affinity_high_availability" class="exampleblock">
<div class="title">Example 1. High Availability</div>
<div class="content">
<div class="paragraph">
<p>Dalia is the DevOps engineer for a startup. For high availability, a particular system&#8217;s two virtual machines should run on separate hosts anywhere in the cluster.</p>
</div>
<div class="paragraph">
<p>Dalia creates an affinity group named "high availability" and does the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adds the two virtual machines, <strong>VM01</strong> and <strong>VM02</strong>, to the affinity group.</p>
</li>
<li>
<p>Sets <strong>VM Affinity</strong> to <strong>Negative</strong> so the virtual machines try to run on separate hosts.</p>
</li>
<li>
<p>Leaves <strong>Enforcing</strong> cleared (disabled) so that both virtual machines can continue running in case only one host is available during an outage.</p>
</li>
<li>
<p>Leaves the <strong>Hosts</strong> list empty so the virtual machines run on any host in the cluster.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="Affinity_performance" class="exampleblock">
<div class="title">Example 2. Performance</div>
<div class="content">
<div class="paragraph">
<p>Sohni is a software developer who uses two virtual machines to build and test his software many times each day. There is heavy network traffic between these two virtual machines. Running the machines on the same host reduces both network traffic and the effects of network latency on the build and test process. Using high-specification hosts (faster CPUs, SSDs, and more memory) further accelerates this process.</p>
</div>
<div class="paragraph">
<p>Sohni creates an affinity group called "build and test" and does the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adds <strong>VM01</strong> and <strong>VM02</strong>, the build and test virtual machines, to the affinity group.</p>
</li>
<li>
<p>Adds the high-specification hosts, <strong>host03</strong>, <strong>host04</strong>, and <strong>host05</strong>, to the affinity group.</p>
</li>
<li>
<p>Sets <strong>VM affinity</strong> to <strong>Positive</strong> so the virtual machines try to run on the same host, reducing network traffic and latency effects.</p>
</li>
<li>
<p>Sets <strong>Host affinity</strong> to <strong>Positive</strong> so the virtual machines try to run on the high specification hosts, accelerating the process.</p>
</li>
<li>
<p>Leaves <strong>Enforcing</strong> cleared (disabled) for both rules so the virtual machines can run if the high-specification hosts are not available.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="Affinity_licensing" class="exampleblock">
<div class="title">Example 3. Licensing</div>
<div class="content">
<div class="paragraph">
<p>Bandile, a software asset manager, helps his organization comply with the restrictive licensing requirements of a 3D imaging software vendor. These terms require the virtual machines for its licensing server, <strong>VM-LS</strong>, and imaging workstations, <strong>VM-WS<em>#</em></strong>, to run on the same host. Additionally, the physical CPU-based licensing model requires that the workstations run on either of two GPU-equipped hosts, <strong>host-gpu-primary</strong> or <strong>host-gpu-backup</strong>.</p>
</div>
<div class="paragraph">
<p>To meet these requirements, Bandile creates an affinity group called "3D seismic imaging" and does the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Adds the previously mentioned virtual machines and hosts to the affinity group.</p>
</li>
<li>
<p>Sets <strong>VM affinity</strong> to <strong>Positive</strong> and selects <strong>Enforcing</strong> so the licensing server and workstations <em>must</em> run together on one of the hosts, not on multiple hosts.</p>
</li>
<li>
<p>Sets <strong>Host affinity</strong> to <strong>Positive</strong> and selects <strong>Enforcing</strong> so the virtual machines <em>must</em> run on either of the GPU-equipped the hosts, not other hosts in the cluster.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Affinity_groups_troubleshooting">6.11.5. Affinity Groups Troubleshooting</h4>
<div class="ulist">
<div class="title">To help prevent problems with affinity groups</div>
<ul>
<li>
<p>Plan and document the scenarios and outcomes you expect when using affinity groups.</p>
</li>
<li>
<p>Verify and test the outcomes under a range of conditions.</p>
</li>
<li>
<p>Follow change management best practices.</p>
</li>
<li>
<p>Only use the <strong>Enforcing</strong> option if it is required.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">If you observe problems with virtual machines not running</div>
<ul>
<li>
<p>Verify that the cluster has a scheduling policy whose <strong>weight module</strong> and <strong>filter module</strong> sections contain <code>VmAffinityGroups</code> and <code>VmToHostsAffinityGroups</code>. For more information, see <a href="https://ovirt.org/documentation/administration_guide/index#Explanation_of_Settings_in_the_New_Scheduling_Policy_and_Edit_Scheduling_Policy_Window">Explanation of Settings in the New Scheduling Policy and Edit Scheduling Policy Window</a> in the <em>Administration Guide</em>.</p>
</li>
<li>
<p>Check for conflicts between affinity labels and affinity groups.</p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">For possible conflicts between affinity labels and affinity groups</div>
<ul>
<li>
<p>Understand that an <em>affinity label</em> is the equivalent of an affinity group with a <strong>Host affinity rule</strong> that is <strong>Positive</strong> and has <strong>Enforcing</strong> enabled.</p>
</li>
<li>
<p>Understand that if an affinity label and affinity group conflict with each other, the intersecting set of virtual machines do not run.</p>
</li>
<li>
<p>Determine whether a conflict is possible:</p>
<div class="ulist">
<ul>
<li>
<p>Inspect the <strong>filter module</strong> section of the cluster&#8217;s scheduling policies. These must contain both a <code>Label</code> keyword and a <code>VmAffinityGroups</code> OR <code>VmToHostsAffinityGroups</code> keyword. Otherwise, a conflict is <em>not possible</em>. (The presence of <code>VmAffinityGroups</code> and <code>VmToHostsAffinityGroups</code> in the <strong>weight module</strong> section does not matter because <code>Label</code> in a <strong>filter module</strong> section would override them.)</p>
</li>
<li>
<p>Inspect the affinity groups. They must contain a rule that has <strong>Enforcing</strong> enabled. Otherwise, a conflict is <em>not possible</em>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If a conflict is possible, identify the set of virtual machines that might be involved:</p>
<div class="ulist">
<ul>
<li>
<p>Inspect the affinity labels and groups. Make a list of virtual machines that are members of both an affinity label <strong>and</strong> an affinity group with an <strong>Enforcing</strong> option enabled.</p>
</li>
<li>
<p>For each host and virtual machine in this intersecting set, analyze the conditions under which a potential conflict occurs.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Determine whether the actual non-running virtual machines match the ones in the analysis.</p>
</li>
<li>
<p>Finally, restructure the affinity groups and affinity labels to help avoid unintended conflicts.</p>
</li>
<li>
<p>Verify that any changes produce the expected results under a range of conditions.</p>
</li>
<li>
<p>If you have overlapping affinity groups and affinity labels, it can be easier to view them in one place as affinity groups. Consider converting an affinity label into an equivalent affinity group, which has a <strong>Host affinity rule</strong> with <strong>Positive</strong> selected and <strong>Enforcing</strong> enabled.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Affinity_Labels">6.12. Affinity Labels</h3>
<div class="paragraph">
<p>You can create and modify affinity labels in the Administration Portal.</p>
</div>
<div class="paragraph">
<p>Affinity labels are used to set hard (Enforced) positive affinity between virtual machines and hosts. See the <a href="#sect-Affinity_Groups">Affinity Groups</a> section for more information about affinity hardness and polarity.</p>
</div>
<div class="paragraph">
<p>Labels function identically to a hard positive affinity group, but simplify configuration in certain use cases. For example, if you have virtual machines that require specific host hardware, you can use affinity labels to ensure that those virtual machines run on the required hosts. If you use software that is license-limited to a certain number of physical machines, you can use affinity labels to ensure that virtual machines running that software are limited to the required physical hosts.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Affinity labels are a subset of affinity groups and can conflict with them. If there is a conflict, the virtual machine will not start.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="Creating_an_Affinity_Label">6.12.1. Creating an Affinity Label</h4>
<div class="paragraph">
<p>You can create affinity labels from the details view of a virtual machine, host, or cluster. This procedure uses the cluster details view.</p>
</div>
<div class="paragraph">
<p><strong>Creating an Affinity Label</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Clusters</b></span> and select the appropriate cluster.</p>
</li>
<li>
<p>Click the cluster&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Affinity Labels</strong> tab.</p>
</li>
<li>
<p>Click <strong>New</strong>.</p>
</li>
<li>
<p>Enter a <strong>Name</strong> for the affinity label.</p>
</li>
<li>
<p>Use the drop-down lists to select the virtual machines and hosts to be associated with the label. Use the <strong>+</strong> button to add additional virtual machines and hosts.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Editing_an_Affinity_Label">6.12.2. Editing an Affinity Label</h4>
<div class="paragraph">
<p>You can edit affinity labels from the details view of a virtual machine, host, or cluster. This procedure uses the cluster details view.</p>
</div>
<div class="paragraph">
<p><strong>Editing an Affinity Label</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Clusters</b></span> and select the appropriate cluster.</p>
</li>
<li>
<p>Click the cluster&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Affinity Labels</strong> tab.</p>
</li>
<li>
<p>Select the label you want to edit.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Use the <strong>+</strong> and <strong>-</strong> buttons to add or remove virtual machines and hosts to or from the affinity label.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Removing_an_Affinity_Label">6.12.3. Removing an Affinity Label</h4>
<div class="paragraph">
<p>You can remove affinity labels only from the details view of a cluster.</p>
</div>
<div class="paragraph">
<p><strong>Removing an Affinity Label</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Clusters</b></span> and select the appropriate cluster.</p>
</li>
<li>
<p>Click the cluster&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Affinity Labels</strong> tab.</p>
</li>
<li>
<p>Select the label you want to remove.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Use the <strong>-</strong> buttons to remove all virtual machines and hosts from the label.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
<li>
<p>Click <b class="button">Delete</b>.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Exporting_and_Importing_Virtual_Machines_and_Templates">6.13. Exporting and Importing Virtual Machines and Templates</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The export storage domain is deprecated. Storage data domains can be unattached from a data center and imported to another data center in the same environment, or in a different environment. Virtual machines, floating virtual disks, and templates can then be uploaded from the imported storage domain to the attached data center. See the <a href="https://ovirt.org/documentation/administration_guide#sect-Importing_Existing_Storage_Domains">Importing Existing Storage Domains</a> section in the <em>oVirt Administration Guide</em> for information on importing storage domains.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can export virtual machines and templates from, and import them to, data centers in the same or different Red Hat Virtualization environment. You can export or import virtual machines by using an export domain, a data domain, or by using a Red Hat Virtualization host.</p>
</div>
<div class="paragraph">
<p>When you export or import a virtual machine or template, properties including basic details such as the name and description, resource allocation, and high availability settings of that virtual machine or template are preserved.</p>
</div>
<div class="paragraph">
<p>The permissions and user roles of virtual machines and templates are included in the OVF files, so that when a storage domain is detached from one data center and attached to another, the virtual machines and templates can be imported with their original permissions and user roles. In order for permissions to be registered successfully, the users and roles related to the permissions of the virtual machines or templates must exist in the data center before the registration process.</p>
</div>
<div class="paragraph">
<p>You can also use the V2V feature to import virtual machines from other virtualization providers, such as RHEL 5 Xen or VMware, or import Windows virtual machines. V2V converts virtual machines so that they can be hosted by oVirt. For more information on installing and using V2V, see <a href="https://access.redhat.com/articles/1351473">Converting Virtual Machines from Other Hypervisors to KVM with virt-v2v</a>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Virtual machines must be shut down before being imported.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="Exporting_individual_virtual_machines_to_the_export_domain">6.13.1. Exporting a Virtual Machine to the Export Domain</h4>
<div class="paragraph">
<p>Export a virtual machine to the export domain so that it can be imported into a different data center. Before you begin, the export domain must be attached to the data center that contains the virtual machine to be exported.</p>
</div>
<div class="paragraph">
<p><strong>Exporting a Virtual Machine to the Export Domain</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <strong>More Actions</strong> (<span class="image"><img src="common/images/moreactions.png" alt="moreactions"></span>), then click <strong>Export to Export Domain</strong>.</p>
</li>
<li>
<p>Optionally, select the following check boxes in the <strong>Export Virtual Machine</strong> window:</p>
<div class="ulist">
<ul>
<li>
<p><strong>Force Override</strong>: overrides existing images of the virtual machine on the export domain.</p>
</li>
<li>
<p><strong>Collapse Snapshots</strong>: creates a single export volume per disk. This option removes snapshot restore points and includes the template in a template-based virtual machine, and removes any dependencies a virtual machine has on a template. For a virtual machine that is dependent on a template, either select this option, export the template with the virtual machine, or make sure the template exists in the destination data center.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When you create a virtual machine from a template by clicking <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Templates</b></span> and clicking <b class="button">New VM</b>, you wll see two storage allocation options in the <strong>Storage Allocation</strong> section in the <strong>Resource Allocation</strong> tab:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If <strong>Clone</strong> is  selected, the virtual machine is not dependent on the template. The template does not have to exist in the destination data center.</p>
</li>
<li>
<p>If <strong>Thin</strong> is selected, the virtual machine is dependent on the template, so the template must exist in the destination data center or be exported with the virtual machine. Alternatively, select the <strong>Collapse Snapshots</strong> check box to collapse the template disk and virtual disk into a single disk.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To check which option was selected, click a virtual machine&#8217;s name and click the <strong>General</strong> tab in the details view.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The export of the virtual machine begins. The virtual machine displays in <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> with an <code>Image Locked</code> status while it is exported. Depending on the size of your virtual machine hard disk images, and your storage hardware, this can take up to an hour. Click the <strong>Events</strong> tab to view  progress. When complete, the virtual machine has been exported to the export domain and displays in the <strong>VM Import</strong> tab of the export domain&#8217;s details view.</p>
</div>
</div>
<div class="sect3">
<h4 id="proc_Exporting_individual_virtual_machines_to_a_data_domain_vm_guide_administrative_tasks">6.13.2. Exporting a Virtual Machine to a Data Domain</h4>
<div class="paragraph">
<p>You can export a virtual machine to a data domain to store a clone of the virtual machine as a backup.</p>
</div>
<div class="paragraph">
<p>When you export a virtual machine that is dependent on a template, the target storage domain should include that template.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When you create a virtual machine from a template, you can choose from either of two storage allocation options:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Clone</strong>: The virtual machine is not dependent on the template. The template does not have to exist in the destination storage domain.</p>
</li>
<li>
<p><strong>Thin</strong>: The virtual machine is dependent on the template, so the template must exist in the destination storage domain.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To check which option is selected, click a virtual machine&#8217;s name and click the <strong>General</strong> tab in the details view.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The data domain is attached to a data center.</p>
</li>
<li>
<p>The virtual machine is powered off.</p>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Export</b>.</p>
</li>
<li>
<p>Specify a name for the exported virtual machine.</p>
</li>
<li>
<p>Select a target storage domain from the <strong>Storage domain</strong> pop-up menu.</p>
</li>
<li>
<p>(Optional) Check <strong>Collapse snapshots</strong> to export the virtual machine without any snapshots.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The Engine clones the virtual machine, including all its disks, to the target domain.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When you move a disk from one type of data domain another, the disk format changes accordingly. For example, if the disk is on an NFS data domain, and it is in sparse format, then if you move the disk to an iSCSI domain its format changes to preallocated. This is different from using an export domain, because an export domain is NFS.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The virtual machine appears with an <strong>Image Locked</strong> status while it is exported. Depending on the size of your virtual machine hard disk images, and your storage hardware, this can take up to an hour. Click the <strong>Events</strong> tab to view  progress. When complete, the virtual machine has been exported to the data domain and appears in the list of virtual machines.</p>
</div>
<div class="ulist">
<div class="title">Additional resources</div>
<ul>
<li>
<p><a href="https://ovirt.org/documentation/virtual_machine_management_guide/index#Creating_a_Virtual_Machine_Based_on_a_Template">Creating a Virtual Machine Based on a Template</a> in the <em>Virtual Machine Management Guide</em></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="Importing_the_virtual_machine_from_the_export_domain">6.13.3. Importing a Virtual Machine from the Export Domain</h4>
<div class="paragraph">
<p>You have a virtual machine on an export domain. Before the virtual machine can be imported to a new data center, the export domain must be attached to the destination data center.</p>
</div>
<div class="paragraph">
<p><strong>Importing a Virtual Machine into the Destination Data Center</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Storage</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Domains</b></span> and select the export domain. The export domain must have a status of <code>Active</code>.</p>
</li>
<li>
<p>Click the export domain&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>VM Import</strong> tab to list the available virtual machines to import.</p>
</li>
<li>
<p>Select one or more virtual machines to import and click <b class="button">Import</b>.</p>
</li>
<li>
<p>Select the <strong>Target Cluster</strong>.</p>
</li>
<li>
<p>Select the <strong>Collapse Snapshots</strong> check box to remove snapshot restore points and include templates in template-based virtual machines.</p>
</li>
<li>
<p>Click the virtual machine to be imported and click the <strong>Disks</strong> sub-tab. From this tab, you can use the <strong>Allocation Policy</strong> and <strong>Storage Domain</strong> drop-down lists to select whether the disk used by the virtual machine will be thinly provisioned or preallocated, and can also select the storage domain on which the disk will be stored. An icon is also displayed to indicate which of the disks to be imported acts as the boot disk for that virtual machine.</p>
</li>
<li>
<p>Click <b class="button">OK</b> to import the virtual machines.</p>
<div class="paragraph">
<p>The <strong>Import Virtual Machine Conflict</strong> window opens if the virtual machine exists in the virtualized environment.</p>
</div>
<div class="paragraph">
<p>Choose one of the following radio buttons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Don&#8217;t import</strong></p>
</li>
<li>
<p><strong>Import as cloned</strong> and enter a unique name for the virtual machine in the <strong>New Name</strong> field.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Optionally select the <strong>Apply to all</strong> check box to import all duplicated virtual machines with the same suffix, and then enter a suffix in the <strong>Suffix to add to the cloned VMs</strong> field.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>During a single import operation, you can only import virtual machines that share the same architecture. If any of the virtual machines to be imported have a different architecture to that of the other virtual machines to be imported, a warning will display and you will be prompted to change your selection so that only virtual machines with the same architecture will be imported.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="Importing_a_Virtual_Machine_from_a_Data_Domain">6.13.4. Importing a Virtual Machine from a Data Domain</h4>
<div class="paragraph">
<p>You can import a virtual machine into one or more clusters from a data storage domain.</p>
</div>
<div class="ulist">
<div class="title">Prerequisite</div>
<ul>
<li>
<p>If you are importing a virtual machine from an imported data storage domain, the imported storage domain must be attached to a data center and activated.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Storage</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Domains</b></span>.</p>
</li>
<li>
<p>Click the imported storage domain&#8217;s name. This opens the details view.</p>
</li>
<li>
<p>Click the <strong>VM Import</strong> tab.</p>
</li>
<li>
<p>Select one or more virtual machines to import.</p>
</li>
<li>
<p>Click <strong>Import</strong>.</p>
</li>
<li>
<p>For each virtual machine in the <strong>Import Virtual Machine(s)</strong> window, ensure the correct target cluster is selected in the <strong>Cluster</strong> list.</p>
</li>
<li>
<p>Map external virtual machine vNIC profiles to profiles that are present on the target cluster(s):</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click <strong>vNic Profiles Mapping</strong>.</p>
</li>
<li>
<p>Select the vNIC profile to use from the <strong>Target vNic Profile</strong> drop-down list.</p>
</li>
<li>
<p>If multiple target clusters are selected in the <strong>Import Virtual Machine(s)</strong> window, select each target cluster in the <strong>Target Cluster</strong> drop-down list and ensure the mappings are correct.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>If a MAC address conflict is detected, an exclamation mark appears next to the name of the virtual machine. Mouse over the icon to view a tooltip displaying the type of error that occurred.</p>
<div class="paragraph">
<p>Select the <strong>Reassign Bad MACs</strong> check box to reassign new MAC addresses to all problematic virtual machines. Alternatively, you can select the <strong>Reassign</strong> check box per virtual machine.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If there are no available addresses to assign, the import operation will fail. However, in the case of MAC addresses that are outside the cluster&#8217;s MAC address pool range, it is possible to import the virtual machine without reassigning a new MAC address.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The imported virtual machines no longer appear in the list under the <strong>VM Import</strong> tab.</p>
</div>
</div>
<div class="sect3">
<h4 id="Importing_a_Virtual_Machine_from_a_VMware_Provider">6.13.5. Importing a Virtual Machine from a VMware Provider</h4>
<div class="paragraph">
<p>Import virtual machines from a VMware vCenter provider to your oVirt environment. You can import from a VMware provider by entering its details in the <strong>Import Virtual Machine(s)</strong> window during each import operation, or you can add the VMware provider as an external provider, and select the preconfigured provider during import operations. To add an external provider, see <a href="https://ovirt.org/documentation/administration_guide/index#sect-Adding_External_Providers">Adding a VMware Instance as a Virtual Machine Provider</a>.</p>
</div>
<div class="paragraph">
<p>oVirt uses V2V to import VMware virtual machines. For OVA files, the only disk format oVirt supports is VMDK.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>virt-v2v</code> package is not available on the ppc64le architecture and these hosts cannot be used as proxy hosts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the import fails, refer to the relevant log file in <code>/var/log/vdsm/import/</code> and to <code>/var/log/vdsm/vdsm.log</code> on the proxy host for details.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<div class="title">Prerequisites</div>
<ul>
<li>
<p>The <code>virt-v2v</code> package must be installed on at least one host, referred to in this procedure as the proxy host. The <code>virt-v2v</code> package is available by default on oVirt Nodes and is installed on Enterprise Linux hosts as a dependency of VDSM when added to the oVirt environment.</p>
</li>
<li>
<p>Enterprise Linux hosts must be Enterprise Linux 7.2 or later.</p>
</li>
<li>
<p>At least one data and one ISO storage domain are connected to the data center.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can only migrate to shared storage, such as NFS, iSCSI, or FCP. Local storage is not supported.</p>
</div>
<div class="paragraph">
<p>Although the ISO storage domain has been deprecated, it is required for migration.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>The <code>virtio-win<em>_version</em>.iso</code> image file for Windows virtual machines is uploaded to the ISO storage domain. This image includes the guest tools that are required for migrating Windows virtual machines.</p>
</li>
<li>
<p>The virtual machine must be shut down before being imported. Starting the virtual machine through VMware during the import process can result in data corruption.</p>
</li>
<li>
<p>An import operation can only include virtual machines that share the same architecture. If any virtual machine to be imported has a different architecture, a warning appears and you are prompted to change your selection to include only virtual machines with the same architecture.</p>
</li>
</ul>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click <strong>More Actions</strong> (<span class="image"><img src="common/images/moreactions.png" alt="moreactions"></span>) and select <strong>Import</strong>. This opens the <strong>Import Virtual Machine(s)</strong> window.</p>
</li>
<li>
<p>Select <strong>VMware</strong> from the <strong>Source</strong> list.</p>
</li>
<li>
<p>If you have configured a VMware provider as an external provider, select it from the <strong>External Provider</strong> list. Verify that the provider credentials are correct. If you did not specify a destination data center or proxy host when configuring the external provider, select those options now.</p>
</li>
<li>
<p>If you have not configured a VMware provider, or want to import from a new VMware provider, provide the following details:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select from the list the <strong>Data Center</strong> in which the virtual machine will be available.</p>
</li>
<li>
<p>Enter the IP address or fully qualified domain name of the VMware vCenter instance in the <strong>vCenter</strong> field.</p>
</li>
<li>
<p>Enter the IP address or fully qualified domain name of the host from which the virtual machines will be imported in the <strong>ESXi</strong> field.</p>
</li>
<li>
<p>Enter the name of the data center and the cluster in which the specified ESXi host resides in the <strong>Data Center</strong> field.</p>
</li>
<li>
<p>If you have exchanged the SSL certificate between the ESXi host and the Engine, leave <strong>Verify server&#8217;s SSL certificate</strong> checked to verify the ESXi host&#8217;s certificate. If not, clear the option.</p>
</li>
<li>
<p>Enter the <strong>Username</strong> and <strong>Password</strong> for the VMware vCenter instance. The user must have access to the VMware data center and ESXi host on which the virtual machines reside.</p>
</li>
<li>
<p>Select a host in the chosen data center with <code>virt-v2v</code> installed to serve as the <strong>Proxy Host</strong> during virtual machine import operations. This host must also be able to connect to the network of the VMware vCenter external provider.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <strong>Load</strong> to list the virtual machines on the VMware provider that can be imported.</p>
</li>
<li>
<p>Select one or more virtual machines from the <strong>Virtual Machines on Source</strong> list, and use the arrows to move them to the <strong>Virtual Machines to Import</strong> list. Click <b class="button">Next</b>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If a virtual machine&#8217;s network device uses the driver type e1000 or rtl8139, the virtual machine will use the same driver type after it has been imported to oVirt.</p>
</div>
<div class="paragraph">
<p>If required, you can change the driver type to VirtIO manually after the import. To change the driver type after a virtual machine has been imported, see <a href="#Editing_network_interfaces">Editing a Network Interface</a>. If the network device uses driver types other than e1000 or rtl8139, the driver type is changed to VirtIO automatically during the import. The <strong>Attach VirtIO-drivers</strong> option allows the VirtIO drivers to be injected to the imported virtual machine files so that when the driver is changed to VirtIO, the device will be properly detected by the operating system.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Select the <strong>Cluster</strong> in which the virtual machines will reside.</p>
</li>
<li>
<p>Select a <strong>CPU Profile</strong> for the virtual machines.</p>
</li>
<li>
<p>Select the <strong>Collapse Snapshots</strong> check box to remove snapshot restore points and include templates in template-based virtual machines.</p>
</li>
<li>
<p>Select the <strong>Clone</strong> check box to change the virtual machine name and MAC addresses, and clone all disks, removing all snapshots. If a virtual machine appears with a warning symbol beside its name or has a tick in the <strong>VM in System</strong> column, you must clone the virtual machine and change its name.</p>
</li>
<li>
<p>Click each virtual machine to be imported and click the <strong>Disks</strong> sub-tab. Use the <strong>Allocation Policy</strong> and <strong>Storage Domain</strong> lists to select whether the disk used by the virtual machine will be thinly provisioned or preallocated, and select the storage domain on which the disk will be stored. An icon is also displayed to indicate which of the disks to be imported acts as the boot disk for that virtual machine.</p>
</li>
<li>
<p>If you selected the <strong>Clone</strong> check box, change the name of the virtual machine in the <strong>General</strong> sub-tab.</p>
</li>
<li>
<p>Click <b class="button">OK</b> to import the virtual machines.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The CPU type of the virtual machine must be the same as the CPU type of the cluster into which it is being imported. To view the cluster&#8217;s <strong>CPU Type</strong> in the Administration Portal:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Clusters</b></span>.</p>
</li>
<li>
<p>Select a cluster.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>General</strong> tab.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the CPU type of the virtual machine is different, configure the imported virtual machine&#8217;s CPU type:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Select the virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>System</strong> tab.</p>
</li>
<li>
<p>Click the <strong>Advanced Parameters</strong> arrow.</p>
</li>
<li>
<p>Specify the <strong>Custom CPU Type</strong> and click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Exporting_a_virtual_machine_to_a_host">6.13.6. Exporting a Virtual Machine to a Host</h4>
<div class="paragraph">
<p>You can export a virtual machine to a specific path or mounted NFS shared storage on a host in the oVirt data center. The export will produce an Open Virtual Appliance (OVA) package.</p>
</div>
<div class="paragraph">
<p><strong>Exporting a Virtual Machine to a Host</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <strong>More Actions</strong> (<span class="image"><img src="common/images/moreactions.png" alt="moreactions"></span>), then click <strong>Export to OVA</strong>.</p>
</li>
<li>
<p>Select the host from the <strong>Host</strong> drop-down list.</p>
</li>
<li>
<p>Enter the absolute path to the export directory in the <strong>Directory</strong> field, including the trailing slash. For example: <code class="filename">/images2/ova/</code></p>
</li>
<li>
<p>Optionally change the default name of the file in the <strong>Name</strong> field.</p>
</li>
<li>
<p>Click <b class="button">OK</b></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The status of the export can be viewed in the <strong>Events</strong> tab.</p>
</div>
</div>
<div class="sect3">
<h4 id="Importing_a_virtual_machine_from_a_host">6.13.7. Importing a Virtual Machine from a Host</h4>
<div class="paragraph">
<p>Import an Open Virtual Appliance (OVA) file into your oVirt environment. You can import the file from any oVirt Node in the data center.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Currently, only oVirt and VMware OVAs can be imported. KVM and Xen are not supported.</p>
</div>
<div class="paragraph">
<p>The import process uses <code>virt-v2v</code>. Only virtual machines running operating systems compatible with <code>virt-v2v</code> can be successfully imported. For a current list of compatible operating systems, see <a href="https://access.redhat.com/articles/1351473" class="bare">https://access.redhat.com/articles/1351473</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Importing an OVA File</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Copy the OVA file to a host in your cluster, in a file system location such as <strong>/var/tmp</strong>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The location can be a local directory or a remote nfs mount, as long as it has sufficient space and is accessible to the qemu user (UID 36).</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Ensure that the OVA file has permissions allowing read/write access to the <strong>qemu</strong> user (UID 36) and the <strong>kvm</strong> group (GID 36):</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># chown 36:36 <em>path_to_OVA_file/file.OVA</em></pre>
</div>
</div>
</li>
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click <strong>More Actions</strong> (<span class="image"><img src="common/images/moreactions.png" alt="moreactions"></span>) and select <strong>Import</strong>. This opens the <strong>Import Virtual Machine(s)</strong> window.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select <strong>Virtual Appliance (OVA)</strong> from the <strong>Source</strong> list.</p>
</li>
<li>
<p>Select a host from the <strong>Host</strong> list.</p>
</li>
<li>
<p>In the <strong>Path</strong> field, specify the absolute path of the OVA file.</p>
</li>
<li>
<p>Click <strong>Load</strong> to list the virtual machine to be imported.</p>
</li>
<li>
<p>Select the virtual machine from the <strong>Virtual Machines on Source</strong> list, and use the arrows to move it to the <strong>Virtual Machines to Import</strong> list.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <b class="button">Next</b>.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select the <strong>Storage Domain</strong> for the virtual machine.</p>
</li>
<li>
<p>Select the <strong>Target Cluster</strong> where the virtual machines will reside.</p>
</li>
<li>
<p>Select the <strong>CPU Profile</strong> for the virtual machines.</p>
</li>
<li>
<p>Select the <strong>Allocation Policy</strong> for the virtual machines.</p>
</li>
<li>
<p>Optionally, select the <strong>Attach VirtIO-Drivers</strong> check box and select the appropriate image on the list to add VirtIO drivers.</p>
</li>
<li>
<p>Select the <strong>Allocation Policy</strong> for the virtual machines.</p>
</li>
<li>
<p>Select the virtual machine, and on the <strong>General</strong> tab select the <strong>Operating System</strong>.</p>
</li>
<li>
<p>On the <strong>Network Interfaces</strong> tab, select the <strong>Network Name</strong> and <strong>Profile Name</strong>.</p>
</li>
<li>
<p>Click the <strong>Disks</strong> tab to view the <strong>Alias</strong>, <strong>Virtual Size</strong>, and <strong>Actual Size</strong> of the virtual machine.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Click <b class="button">OK</b> to import the virtual machines.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Importing_a_Virtual_Machine_from_Xen">6.13.8. Importing a virtual machine from a RHEL 5 Xen host</h4>
<div class="paragraph">
<p>Import virtual machines from Xen on Enterprise Linux 5 to your oVirt environment. oVirt uses V2V to import QCOW2 or raw virtual machine disk formats.</p>
</div>
<div class="paragraph">
<p>The <code>virt-v2v</code> package must be installed on at least one host (referred to in this procedure as the proxy host). The <code>virt-v2v</code> package is available by default on oVirt Nodes (oVirt Node) and is installed on Enterprise Linux hosts as a dependency of VDSM when added to the oVirt environment. Enterprise Linux hosts must be Enterprise Linux 7.2 or later.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are importing a Windows virtual machine from a RHEL 5 Xen host and you are using VirtIO devices, install the VirtIO drivers before importing the virtual machine. If the drivers are not installed, the virtual machine may not boot after import.</p>
</div>
<div class="paragraph">
<p>The VirtIO drivers can be installed from the <code>virtio-win<em>_version</em>.iso</code> or the <code>RHV-toolsSetup<em>_version</em>.iso</code>. See <a href="#Installing_the_Guest_Agents_and_Drivers_on_Windows">Installing the guest agents, tools, and drivers on Windows</a> for details.</p>
</div>
<div class="paragraph">
<p>If you are not using VirtIO drivers, review the configuration of the virutal machine before first boot to ensure that VirtIO devices are not being used.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>virt-v2v</code> package is not available on the ppc64le architecture and these hosts cannot be used as proxy hosts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>An import operation can only include virtual machines that share the same architecture. If any virtual machine to be imported has a different architecture, a warning appears and you are prompted to change your selection to include only virtual machines with the same architecture.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the import fails, refer to the relevant log file in <code>/var/log/vdsm/import/</code> and to <code>/var/log/vdsm/vdsm.log</code> on the proxy host for details.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<div class="title">Procedure</div>
<p>To import a virtual machine from RHEL 5 Xen, follow these steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Shut down the virtual machine. Starting the virtual machine through Xen during the import process can result in data corruption.</p>
</li>
<li>
<p>Enable public key authentication between the proxy host and the RHEL 5 Xen host:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Log in to the proxy host and generate SSH keys for the <strong>vdsm</strong> user.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># sudo -u vdsm ssh-keygen</pre>
</div>
</div>
</li>
<li>
<p>Copy the <strong>vdsm</strong> user&#8217;s public key to the RHEL 5 Xen host.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># sudo -u vdsm ssh-copy-id root@<em>xenhost.example.com</em></pre>
</div>
</div>
</li>
<li>
<p>Log in to the RHEL 5 Xen host to verify that the login works correctly.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># sudo -u vdsm ssh root@<em>xenhost.example.com</em></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Log in to the Administration Portal.</p>
</li>
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click <strong>More Actions</strong> (<span class="image"><img src="common/images/moreactions.png" alt="moreactions"></span>) and select <strong>Import</strong>. This opens the <strong>Import Virtual Machine(s)</strong> window.</p>
</li>
<li>
<p>Select the <strong>Data Center</strong> that contains the proxy host.</p>
</li>
<li>
<p>Select <strong>XEN (via RHEL)</strong> from the <strong>Source</strong> drop-down list.</p>
</li>
<li>
<p>Optionally, select a RHEL 5 Xen <strong>External Provider</strong> from the drop-down list. The URI will be pre-filled with the correct URI. See <a href="https://ovirt.org/documentation/administration_guide/index#Adding_Xen_as_an_External_Provider">Adding a RHEL 5 Xen Host as a Virtual Machine Provider</a> in the <em>Administration Guide</em> for more information.</p>
</li>
<li>
<p>Enter the <strong>URI</strong> of the RHEL 5 Xen host. The required format is pre-filled; you must replace <code>&lt;hostname&gt;</code> with the host name of the RHEL 5 Xen host.</p>
</li>
<li>
<p>Select the proxy host from the <strong>Proxy Host</strong> drop-down list.</p>
</li>
<li>
<p>Click <strong>Load</strong> to list the virtual machines on the RHEL 5 Xen host that can be imported.</p>
</li>
<li>
<p>Select one or more virtual machines from the <strong>Virtual Machines on Source</strong> list, and use the arrows to move them to the <strong>Virtual Machines to Import</strong> list.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Due to current limitations, Xen virtual machines with block devices do not appear in the <strong>Virtual Machines on Source</strong> list. They must be imported manually. See <a href="#Importing_Block_Based_Virtual_Machine_from_Xen_host">Importing a Block-Based Virtual Machine from a RHEL 5 Xen Host</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Click <b class="button">Next</b>.</p>
</li>
<li>
<p>Select the <strong>Cluster</strong> in which the virtual machines will reside.</p>
</li>
<li>
<p>Select a <strong>CPU Profile</strong> for the virtual machines.</p>
</li>
<li>
<p>Use the <strong>Allocation Policy</strong> and <strong>Storage Domain</strong> lists to select whether the disk used by the virtual machine will be thinly provisioned or preallocated, and select the storage domain on which the disk will be stored.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The target storage domain must be a file-based domain. Due to current limitations, specifying a block-based domain causes the V2V operation to fail.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>If a virtual machine appears with a warning symbol beside its name, or has a tick in the <strong>VM in System</strong> column, select the <strong>Clone</strong> check box to clone the virtual machine.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Cloning a virtual machine changes its name and MAC addresses and clones all of its disks, removing all snapshots.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Click <b class="button">OK</b> to import the virtual machines.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The CPU type of the virtual machine must be the same as the CPU type of the cluster into which it is being imported. To view the cluster&#8217;s <strong>CPU Type</strong> in the Administration Portal:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Clusters</b></span>.</p>
</li>
<li>
<p>Select a cluster.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>General</strong> tab.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the CPU type of the virtual machine is different, configure the imported virtual machine&#8217;s CPU type:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Select the virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>System</strong> tab.</p>
</li>
<li>
<p>Click the <strong>Advanced Parameters</strong> arrow.</p>
</li>
<li>
<p>Specify the <strong>Custom CPU Type</strong> and click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div id="Importing_Block_Based_Virtual_Machine_from_Xen_host" class="olist arabic">
<div class="title">Importing a Block-Based Virtual Machine from a RHEL 5 Xen Host</div>
<ol class="arabic">
<li>
<p>Enable public key authentication between the proxy host and the RHEL 5 Xen host:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Log in to the proxy host and generate SSH keys for the <strong>vdsm</strong> user.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># sudo -u vdsm ssh-keygen</pre>
</div>
</div>
</li>
<li>
<p>Copy the <strong>vdsm</strong> user&#8217;s public key to the RHEL 5 Xen host.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># sudo -u vdsm ssh-copy-id root@<em>xenhost.example.com</em></pre>
</div>
</div>
</li>
<li>
<p>Log in to the RHEL 5 Xen host to verify that the login works correctly.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># sudo -u vdsm ssh root@<em>xenhost.example.com</em></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Attach an export domain. See <a href="https://ovirt.org/documentation/administration_guide/index#Attaching_an_export_domain">Attaching an Existing Export Domain to a Data Center</a> in the <em>Administration Guide</em> for details.</p>
</li>
<li>
<p>On the proxy host, copy the virtual machine from the RHEL 5 Xen host:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># virt-v2v-copy-to-local -ic xen+ssh://root@<em>xenhost.example.com</em> <em>vmname</em></pre>
</div>
</div>
</li>
<li>
<p>Convert the virtual machine to libvirt XML and move the file to your export domain:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># virt-v2v -i libvirtxml <em>vmname</em>.xml -o rhev -of raw -os <em>storage.example.com:/exportdomain</em></pre>
</div>
</div>
</li>
<li>
<p>In the Administration Portal, click <span class="menuseq"><b class="menu">Storage</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Domains</b></span>, click the export domain&#8217;s name, and click the <strong>VM Import</strong> tab in the details view to verify that the virtual machine is in your export domain.</p>
</li>
<li>
<p>Import the virtual machine into the destination data domain. See <a href="#Importing_the_virtual_machine_from_the_export_domain">Importing a Virtual Machine from the Export Domain</a> for details.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Importing_a_Virtual_Machine_from_KVM">6.13.9. Importing a Virtual Machine from a KVM Host</h4>
<div class="paragraph">
<p>Import virtual machines from KVM to your oVirt environment. oVirt converts KVM virtual machines to the correct format before they are imported. You must enable public key authentication between the KVM host and at least one host in the destination data center (this host is referred to in the following procedure as the proxy host).</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The virtual machine must be shut down before being imported. Starting the virtual machine through KVM during the import process can result in data corruption.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>An import operation can only include virtual machines that share the same architecture. If any virtual machine to be imported has a different architecture, a warning appears and you are prompted to change your selection to include only virtual machines with the same architecture.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the import fails, refer to the relevant log file in <strong>/var/log/vdsm/import/</strong> and to <strong>/var/log/vdsm/vdsm.log</strong> on the proxy host for details.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Importing a Virtual Machine from KVM</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enable public key authentication between the proxy host and the KVM host:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Log in to the proxy host and generate SSH keys for the <strong>vdsm</strong> user.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># sudo -u vdsm ssh-keygen</pre>
</div>
</div>
</li>
<li>
<p>Copy the <strong>vdsm</strong> user&#8217;s public key to the KVM host. The proxy host&#8217;s <strong>known_hosts</strong> file will also be updated to include the host key of the KVM host.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># sudo -u vdsm ssh-copy-id root@<em>kvmhost.example.com</em></pre>
</div>
</div>
</li>
<li>
<p>Log in to the KVM host to verify that the login works correctly.</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># sudo -u vdsm ssh root@<em>kvmhost.example.com</em></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Log in to the Administration Portal.</p>
</li>
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click <strong>More Actions</strong> (<span class="image"><img src="common/images/moreactions.png" alt="moreactions"></span>) and select <strong>Import</strong>. This opens the <strong>Import Virtual Machine(s)</strong> window.</p>
</li>
<li>
<p>Select the <strong>Data Center</strong> that contains the proxy host.</p>
</li>
<li>
<p>Select <strong>KVM (via Libvirt)</strong> from the <strong>Source</strong> drop-down list.</p>
</li>
<li>
<p>Optionally, select a KVM provider <strong>External Provider</strong> from the drop-down list. The URI will be pre-filled with the correct URI. See <a href="https://ovirt.org/documentation/administration_guide/index#Adding_KVM_as_an_External_Provider">Adding a KVM Host as a Virtual Machine Provider</a> in the <em>Administration Guide</em> for more information.</p>
</li>
<li>
<p>Enter the <strong>URI</strong> of the KVM host in the following format:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">qemu+ssh://root@<em>kvmhost.example.com</em>/system</pre>
</div>
</div>
</li>
<li>
<p>Keep the <strong>Requires Authentication</strong> check box selected.</p>
</li>
<li>
<p>Enter <code>root</code> in the <strong>Username</strong> field.</p>
</li>
<li>
<p>Enter the <strong>Password</strong> of the KVM host&#8217;s root user.</p>
</li>
<li>
<p>Select the <strong>Proxy Host</strong> from the drop-down list.</p>
</li>
<li>
<p>Click <strong>Load</strong> to list the virtual machines on the KVM host that can be imported.</p>
</li>
<li>
<p>Select one or more virtual machines from the <strong>Virtual Machines on Source</strong> list, and use the arrows to move them to the <strong>Virtual Machines to Import</strong> list.</p>
</li>
<li>
<p>Click <b class="button">Next</b>.</p>
</li>
<li>
<p>Select the <strong>Cluster</strong> in which the virtual machines will reside.</p>
</li>
<li>
<p>Select a <strong>CPU Profile</strong> for the virtual machines.</p>
</li>
<li>
<p>Optionally, select the <strong>Collapse Snapshots</strong> check box to remove snapshot restore points and include templates in template-based virtual machines.</p>
</li>
<li>
<p>Optionally, select the <strong>Clone</strong> check box to change the virtual machine name and MAC addresses, and clone all disks, removing all snapshots. If a virtual machine appears with a warning symbol beside its name or has a tick in the <strong>VM in System</strong> column, you must clone the virtual machine and change its name.</p>
</li>
<li>
<p>Click each virtual machine to be imported and click the <strong>Disks</strong> sub-tab. Use the <strong>Allocation Policy</strong> and <strong>Storage Domain</strong> lists to select whether the disk used by the virtual machine will be thin provisioned or preallocated, and select the storage domain on which the disk will be stored. An icon is also displayed to indicate which of the disks to be imported acts as the boot disk for that virtual machine. See <a href="https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/html-single/technical_reference/index#Preallocated_Storage">Virtual Disk Storage Allocation Policies</a> in the <em>Technical Reference</em> for more information.</p>
</li>
<li>
<p>If you selected the <strong>Clone</strong> check box, change the name of the virtual machine in the <strong>General</strong> tab.</p>
</li>
<li>
<p>Click <b class="button">OK</b> to import the virtual machines.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The CPU type of the virtual machine must be the same as the CPU type of the cluster into which it is being imported. To view the cluster&#8217;s <strong>CPU Type</strong> in the Administration Portal:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Clusters</b></span>.</p>
</li>
<li>
<p>Select a cluster.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>General</strong> tab.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If the CPU type of the virtual machine is different, configure the imported virtual machine&#8217;s CPU type:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Select the virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>System</strong> tab.</p>
</li>
<li>
<p>Click the <strong>Advanced Parameters</strong> arrow.</p>
</li>
<li>
<p>Specify the <strong>Custom CPU Type</strong> and click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Importing_a_Red_Hat_KVM_Guest_Image">6.13.10. Importing a Red Hat KVM Guest Image</h4>
<div class="paragraph">
<p>You can import a Red Hat-provided KVM virtual machine image. This image is a virtual machine snapshot with a preconfigured instance of Enterprise Linux installed.</p>
</div>
<div class="paragraph">
<p>You can configure this image with the <strong>cloud-init</strong> tool, and use it to provision new virtual machines. This eliminates the need to install and configure the operating system and provides virtual machines that are ready for use.</p>
</div>
<div class="paragraph">
<p><strong>Importing a Red Hat KVM Guest Image</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download the most recent KVM virtual machine image from the <a href="https://access.redhat.com/downloads/content/69/ver=/rhel---7/7.5/x86_64/product-software">Download Enterprise Linux</a> list, in the Product Software tab.</p>
</li>
<li>
<p>Upload the virtual machine image using the Engine or the REST API. See <a href="https://ovirt.org/documentation/administration_guide/index#Uploading_a_Disk_Image_to_a_Storage_Domain">Uploading a Disk Image to a Storage Domain</a> in the <em>Administration Guide</em>.</p>
</li>
<li>
<p>Create a new virtual machine and attach the uploaded disk image to it. See <a href="#Creating_a_virtual_machine_linux_vm">Creating a virtual machine</a>.</p>
</li>
<li>
<p>Optionally, use <strong>cloud-init</strong> to configure the virtual machine. See <a href="#Using_Cloud-Init_to_Automate_the_Configuration_of_Virtual_Machines">Using Cloud-Init to Automate the Configuration of Virtual Machines</a> for details.</p>
</li>
<li>
<p>Optionally, create a template from the virtual machine. You can generate new virtual machines from this template. See <a href="#chap-Templates">Templates</a> for information about creating templates and generating virtual machines from templates.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Migrating_Virtual_Machines_Between_Hosts">6.14. Migrating Virtual Machines Between Hosts</h3>
<div class="paragraph">
<p>Live migration provides the ability to move a running virtual machine between physical hosts with no interruption to service. The virtual machine remains powered on and user applications continue to run while the virtual machine is relocated to a new physical host. In the background, the virtual machine&#8217;s RAM is copied from the source host to the destination host. Storage and network connectivity are not altered.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A virtual machine that is using a vGPU cannot be migrated to a different host.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="Live_migration_prerequisites">6.14.1. Live Migration Prerequisites</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This is one in a series of topics that show how to set up and configure SR-IOV on oVirt. For more information, see <a href="https://ovirt.org/documentation/administration_guide/index#setting-up-and-configuring-sr-iov">Setting Up and Configuring SR-IOV</a></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can use live migration to seamlessly move virtual machines to support a number of common maintenance tasks. Your oVirt environment must be correctly configured to support live migration well in advance of using it.</p>
</div>
<div class="paragraph">
<p>At a minimum, the following prerequisites must be met to enable successful live migration of virtual machines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The source and destination hosts are members of the same cluster, ensuring CPU compatibility between them.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Live migrating virtual machines between different clusters is generally not recommended.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>The source and destination hosts' status is <code>Up</code>.</p>
</li>
<li>
<p>The source and destination hosts have access to the same virtual networks and VLANs.</p>
</li>
<li>
<p>The source and destination hosts have access to the data storage domain on which the virtual machine resides.</p>
</li>
<li>
<p>The destination host has sufficient CPU capacity to support the virtual machine&#8217;s requirements.</p>
</li>
<li>
<p>The destination host has sufficient unused RAM to support the virtual machine&#8217;s requirements.</p>
</li>
<li>
<p>The migrating virtual machine does not have the <code>cache!=none</code> custom property set.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Live migration is performed using the management network and involves transferring large amounts of data between hosts. Concurrent migrations have the potential to saturate the management network. For best performance, create separate logical networks for management, storage, display, and virtual machine data to minimize the risk of network saturation.</p>
</div>
</div>
<div class="sect3">
<h4 id="Configuring_virtual_machines_with_SR-IOV-Enabled_vNICs">6.14.2. Configuring Virtual Machines with SR-IOV-Enabled vNICs to Reduce Network Outage during Migration</h4>
<div class="paragraph">
<p>Virtual machines with vNICs that are directly connected to a virtual function (VF) of an SR-IOV-enabled host NIC can be further configured to reduce network outage during live migration:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the destination host has an available VF.</p>
</li>
<li>
<p>Set the <strong>Passthrough</strong> and <strong>Migratable</strong> options in the passthrough vNIC&#8217;s profile. See <a href="https://ovirt.org/documentation/administration_guide/#Enabling_Passthrough_on_a_vNIC_Profile">Enabling Passthrough on a vNIC Profile</a> in the <em>Administration Guide</em>.</p>
</li>
<li>
<p>Enable hotplugging for the virtual machine&#8217;s network interface.</p>
</li>
<li>
<p>Ensure that the virtual machine has a backup VirtIO vNIC, in addition to the passthrough vNIC, to maintain the virtual machine&#8217;s network connection during migration.</p>
</li>
<li>
<p>Set the VirtIO vNIC&#8217;s <code>No Network Filter</code> option before configuring the bond. See <a href="https://ovirt.org/documentation/administration_guide/#Explanation_of_Settings_in_the_VM_Interface_Profile_Window">Explanation of Settings in the VM Interface Profile Window</a> in the <em>Administration Guide</em>.</p>
</li>
<li>
<p>Add both vNICs as slaves under an <code>active-backup</code> bond on the virtual machine, with the passthrough vNIC as the primary interface.</p>
<div class="paragraph">
<p>The bond and vNIC profiles can be configured in one of the following ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The bond is not configured with <code>fail_over_mac=active</code> and the VF vNIC is the primary slave (recommended).</p>
<div class="paragraph">
<p>Disable the VirtIO vNIC profile&#8217;s MAC-spoofing filter to ensure that traffic passing through the VirtIO vNIC is not dropped because it uses the VF vNIC MAC address.</p>
</div>
</li>
<li>
<p>The bond is configured with <code>fail_over_mac=active</code>.</p>
<div class="paragraph">
<p>This failover policy ensures that the MAC address of the bond is always the MAC address of the active slave. During failover, the virtual machine&#8217;s MAC address changes, with a slight disruption in traffic.</p>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Configuring_virtual_machines_with_SR-IOV-Enabled_vNICs_minimal_downtime">6.14.3. Configuring Virtual Machines with SR-IOV-Enabled vNICs with minimal downtime.</h4>
<div class="paragraph">
<p>To configure virtual machines for migration with SR-IOV enabled vNICs and minimal downtime follow the procedure described below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The following steps are provided only as a Technology Preview. For more information see <a href="https://access.redhat.com/support/offerings/techpreview/">Red Hat Technology Preview Features Support Scope</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a vNIC profile with SR-IOV enabled vNICS.
See <a href="https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/html-single/administration_guide/index#Creating_a_VNIC_Profile">Creating a vNIC profile</a> and <a href="https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/html/administration_guide/sect-hosts_and_networking#setting-up-and-configuring-sr-iov">Setting up and configuring SR-IOV</a>.</p>
</li>
<li>
<p>In the Administration Portal, go to <span class="menuseq"><b class="menu">Network</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">VNIC profiles</b></span>, select the vNIC profile, click <b class="button">Edit</b> and select a <code>Failover vNIC profile</code> from the drop down list.</p>
</li>
<li>
<p>Click <b class="button">OK</b> to save the profile settings.</p>
</li>
<li>
<p>Hotplug a network interface with the failover vNIC profile you created into the virtual machine, or start a virtual machine with this network interface plugged in.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The virtual machine will have three interfaces available, in order for migration to work properly, the main interface should be activated and used for connection. The main interface acts as a master for the remaining two interfaces.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>For automatic deployment of virtual machines with this configuration, use the following <code>udev</code> rule:</p>
<div class="listingblock">
<div class="content">
<pre>  UBSYSTEM=="net",
  ACTION=="add|change",
  ENV{ID_NET_DRIVER}!="net_failover",
  ENV{NM_UNMANAGED}="1",
  RUN+="/bin/sh -c '/sbin/ip link set up $INTERFACE'"</pre>
</div>
</div>
<div class="paragraph">
<p>This <code>udev</code> rule works only on systems that manage interfaces with <code>NetworkManager</code>. This rule ensures that only the master interface is activated.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Optimizing_Live_Migration">6.14.4. Optimizing Live Migration</h4>
<div class="paragraph">
<p>Live virtual machine migration can be a resource-intensive operation. To optimize live migration, you can set the following two options globally for every virtual machine in an environment, for every virtual machine in a cluster, or for an individual virtual machine.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For cluster levels 4.3 or later, auto converge is enabled by default for all built-in migration policies, and migration compression is enabled by default for only the <code>Suspend workload if needed</code> migration policy. You can change these parameters when adding a new migration policy, or by modifying the <code>MigrationPolicies</code> configuration value.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <strong>Auto Converge migrations</strong> option allows you to set whether auto-convergence is used during live migration of virtual machines. Large virtual machines with high workloads can dirty memory more quickly than the transfer rate achieved during live migration, and prevent the migration from converging. Auto-convergence capabilities in QEMU allow you to force convergence of virtual machine migrations. QEMU automatically detects a lack of convergence and triggers a throttle-down of the vCPUs on the virtual machine.</p>
</div>
<div class="paragraph">
<p>The <strong>Enable migration compression</strong> option allows you to set whether migration compression is used during live migration of the virtual machine. This feature uses Xor Binary Zero Run-Length-Encoding to reduce virtual machine downtime and total live migration time for virtual machines running memory write-intensive workloads or for any application with a sparse memory update pattern.</p>
</div>
<div class="paragraph">
<p>Both options are disabled globally by default.</p>
</div>
<div class="paragraph">
<p><strong>Configuring Auto-convergence and Migration Compression for Virtual Machine Migration</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Configure the optimization settings at the global level:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Enable auto-convergence at the global level:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># engine-config -s DefaultAutoConvergence=True</pre>
</div>
</div>
</li>
<li>
<p>Enable migration compression at the global level:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># engine-config -s DefaultMigrationCompression=True</pre>
</div>
</div>
</li>
<li>
<p>Restart the <strong>ovirt-engine</strong> service to apply the changes:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># systemctl restart ovirt-engine.service</pre>
</div>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Configure the optimization settings for a cluster:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Clusters</b></span> and select a cluster.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>Migration Policy</strong> tab.</p>
</li>
<li>
<p>From the <strong>Auto Converge migrations</strong> list, select <strong>Inherit from global setting</strong>, <strong>Auto Converge</strong>, or <strong>Don&#8217;t Auto Converge</strong>.</p>
</li>
<li>
<p>From the <strong>Enable migration compression</strong> list, select <strong>Inherit from global setting</strong>, <strong>Compress</strong>, or <strong>Don&#8217;t Compress</strong>.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Configure the optimization settings at the virtual machine level:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>Host</strong> tab.</p>
</li>
<li>
<p>From the <strong>Auto Converge migrations</strong> list, select <strong>Inherit from cluster setting</strong>, <strong>Auto Converge</strong>, or <strong>Don&#8217;t Auto Converge</strong>.</p>
</li>
<li>
<p>From the <strong>Enable migration compression</strong> list, select <strong>Inherit from cluster setting</strong>, <strong>Compress</strong>, or <strong>Don&#8217;t Compress</strong>.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Guest_Agent_Hooks">6.14.5. Guest Agent Hooks</h4>
<div class="paragraph">
<p>Hooks are scripts that trigger activity within a virtual machine when key events occur:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Before migration</p>
</li>
<li>
<p>After migration</p>
</li>
<li>
<p>Before hibernation</p>
</li>
<li>
<p>After hibernation</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The hooks configuration base directory is <code>/etc/ovirt-guest-agent/hooks.d</code> on Linux systems.</p>
</div>
<div class="paragraph">
<p>Each event has a corresponding subdirectory: <code>before_migration</code> and <code>after_migration</code>, <code>before_hibernation</code> and <code>after_hibernation</code>. All files or symbolic links in that directory will be executed.</p>
</div>
<div class="paragraph">
<p>The executing user on Linux systems is <code>ovirtagent</code>. If the script needs <code>root</code> permissions, the elevation must be executed by the creator of the hook script.</p>
</div>
</div>
<div class="sect3">
<h4 id="Automatic_virtual_machine_migration">6.14.6. Automatic Virtual Machine Migration</h4>
<div class="paragraph">
<p>oVirt Engine automatically initiates live migration of all virtual machines running on a host when the host is moved into maintenance mode. The destination host for each virtual machine is assessed as the virtual machine is migrated, in order to spread the load across the cluster.</p>
</div>
<div class="paragraph">
<p>From version 4.3, all virtual machines defined with manual or automatic migration modes are migrated when the host is moved into maintenance mode. However, for high performance and/or pinned virtual machines, a <strong>Maintenance Host</strong> window is displayed, asking you to confirm the action because the performance on the target host may be less than the performance on the current host.</p>
</div>
<div class="paragraph">
<p>The Engine automatically initiates live migration of virtual machines in order to maintain load-balancing or power-saving levels in line with scheduling policy. Specify the scheduling policy that best suits the needs of your environment. You can also disable automatic, or even manual, live migration of specific virtual machines where required.</p>
</div>
<div class="paragraph">
<p>If your virtual machines are configured for high performance, and/or if they have been pinned (by setting Passthrough Host CPU, CPU Pinning, or NUMA Pinning), the migration mode is set to <strong>Allow manual migration only</strong>. However, this can be changed to <strong>Allow Manual and Automatic</strong> mode if required. Special care should be taken when changing the default migration setting so that it does not result in a virtual machine migrating to a host that does not support high performance or pinning.</p>
</div>
</div>
<div class="sect3">
<h4 id="Preventing_automatic_migration_of_a_virtual_machine">6.14.7. Preventing Automatic Migration of a Virtual Machine</h4>
<div class="paragraph">
<p>oVirt Engine allows you to disable automatic migration of virtual machines. You can also disable manual migration of virtual machines by setting the virtual machine to run only on a specific host.</p>
</div>
<div class="paragraph">
<p>The ability to disable automatic migration and require a virtual machine to run on a particular host is useful when using application high availability products, such as Red Hat High Availability or Cluster Suite.</p>
</div>
<div class="paragraph">
<p><strong>Preventing Automatic Migration of Virtual Machines</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>Host</strong> tab.</p>
</li>
<li>
<p>In the <strong>Start Running On</strong> section, select <strong>Any Host in Cluster</strong> or <strong>Specific Host(s)</strong>, which enables you to select multiple hosts.</p>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Explicitly assigning a virtual machine to a specific host and disabling migration are mutually exclusive with oVirt high availability.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the virtual machine has host devices directly attached to it, and a different host is specified, the host devices from the previous host will be automatically removed from the virtual machine.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Select <strong>Allow manual migration only</strong> or <strong>Do not allow migration</strong> from the <strong>Migration Options</strong> drop-down list.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Manually_migrating_virtual_machines">6.14.8. Manually Migrating Virtual Machines</h4>
<div class="paragraph">
<p>A running virtual machine can be live migrated to any host within its designated host cluster. Live migration of virtual machines does not cause any service interruption. Migrating virtual machines to a different host is especially useful if the load on a particular host is too high. For live migration prerequisites, see <a href="#Live_migration_prerequisites">Live Migration Prerequisites</a>.</p>
</div>
<div class="paragraph">
<p>For high performance virtual machines and/or virtual machines defined with <strong>Pass-Through Host CPU</strong>, <strong>CPU Pinning</strong>, or <strong>NUMA Pinning</strong>, the default migration mode is <strong>Manual</strong>. Select <strong>Select Host Automatically</strong> so that the virtual machine migrates to the host that offers the best performance.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When you place a host into maintenance mode, the virtual machines running on that host are automatically migrated to other hosts in the same cluster. You do not need to manually migrate these virtual machines.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Live migrating virtual machines between different clusters is generally not recommended. The only supported use case is documented at <a href="https://access.redhat.com/articles/1390733" class="bare">https://access.redhat.com/articles/1390733</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure</div>
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a running virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Migrate</b>.</p>
</li>
<li>
<p>Use the radio buttons to select whether to <strong>Select Host Automatically</strong> or to <strong>Select Destination Host</strong>, specifying the host using the drop-down list.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When the <strong>Select Host Automatically</strong> option is selected, the system determines the host to which the virtual machine is migrated according to the load balancing and power management rules set up in the scheduling policy.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>During migration, progress is shown in the <strong>Migration</strong> progress bar. Once migration is complete the <strong>Host</strong> column will update to display the host the virtual machine has been migrated to.</p>
</div>
</div>
<div class="sect3">
<h4 id="Setting_migration_priority">6.14.9. Setting Migration Priority</h4>
<div class="paragraph">
<p>oVirt Engine queues concurrent requests for migration of virtual machines off of a given host. The load balancing process runs every minute. Hosts already involved in a migration event are not included in the migration cycle until their migration event has completed. When there is a migration request in the queue and available hosts in the cluster to action it, a migration event is triggered in line with the load balancing policy for the cluster.</p>
</div>
<div class="paragraph">
<p>You can influence the ordering of the migration queue by setting the priority of each virtual machine; for example, setting mission critical virtual machines to migrate before others. Migrations will be ordered by priority; virtual machines with the highest priority will be migrated first.</p>
</div>
<div class="paragraph">
<p><strong>Setting Migration Priority</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Select the <strong>High Availability</strong> tab.</p>
</li>
<li>
<p>Select <strong>Low</strong>, <strong>Medium</strong>, or <strong>High</strong> from the <strong>Priority</strong> drop-down list.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Canceling_ongoing_virtual_machine_migrations">6.14.10. Canceling Ongoing Virtual Machine Migrations</h4>
<div class="paragraph">
<p>A virtual machine migration is taking longer than you expected. You&#8217;d like to be sure where all virtual machines are running before you make any changes to your environment.</p>
</div>
<div class="paragraph">
<p><strong>Canceling Ongoing Virtual Machine Migrations</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select the migrating virtual machine. It is displayed in <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> with a status of <strong>Migrating from</strong>.</p>
</li>
<li>
<p>Click <strong>More Actions</strong> (<span class="image"><img src="common/images/moreactions.png" alt="moreactions"></span>), then click <strong>Cancel Migration</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The virtual machine status returns from <strong>Migrating from</strong> to <strong>Up</strong>.</p>
</div>
</div>
<div class="sect3">
<h4 id="Event_and_Log_Notification_upon_Automatic_Migration_of_Highly_Available_Virtual_Servers">6.14.11. Event and Log Notification upon Automatic Migration of Highly Available Virtual Servers</h4>
<div class="paragraph">
<p>When a virtual server is automatically migrated because of the high availability function, the details of an automatic migration are documented in the <strong>Events</strong> tab and in the engine log to aid in troubleshooting, as illustrated in the following examples:</p>
</div>
<div class="exampleblock">
<div class="title">Example 4. Notification in the Events Tab of the Administration Portal</div>
<div class="content">
<div class="paragraph">
<p>Highly Available <em>Virtual_Machine_Name</em> failed. It will be restarted automatically.</p>
</div>
<div class="paragraph">
<p><em>Virtual_Machine_Name</em> was restarted on Host <em>Host_Name</em></p>
</div>
</div>
</div>
<div class="exampleblock">
<div class="title">Example 5. Notification in the Engine engine.log</div>
<div class="content">
<div class="paragraph">
<p>This log can be found on the oVirt Engine at <strong>/var/log/ovirt-engine/engine.log</strong>:</p>
</div>
<div class="paragraph">
<p>Failed to start Highly Available VM. Attempting to restart. VM Name: <em>Virtual_Machine_Name</em>, VM Id:_Virtual_Machine_ID_Number_</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Improving_Uptime_with_Virtual_Machine_High_Availability">6.15. Improving Uptime with Virtual Machine High Availability</h3>
<div class="sect3">
<h4 id="What_is_high_availability">6.15.1. What is High Availability?</h4>
<div class="paragraph">
<p>High availability is recommended for virtual machines running critical workloads. A highly available virtual machine is automatically restarted, either on its original host or another host in the cluster, if its process is interrupted, such as in the following scenarios:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A host becomes non-operational due to hardware failure.</p>
</li>
<li>
<p>A host is put into maintenance mode for scheduled downtime.</p>
</li>
<li>
<p>A host becomes unavailable because it has lost communication with an external storage resource.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A highly available virtual machine is not restarted if it is shut down cleanly, such as in the following scenarios:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The virtual machine is shut down from within the guest.</p>
</li>
<li>
<p>The virtual machine is shut down from the Engine.</p>
</li>
<li>
<p>The host is shut down by an administrator without being put in maintenance mode first.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With storage domains V4 or later, virtual machines have the additional capability to acquire a lease on a special volume on the storage, enabling a virtual machine to start on another host even if the original host loses power. The functionality also prevents the virtual machine from being started on two different hosts, which may lead to corruption of the virtual machine disks.</p>
</div>
<div class="paragraph">
<p>With high availability, interruption to service is minimal because virtual machines are restarted within seconds with no user intervention required. High availability keeps your resources balanced by restarting guests on a host with low current resource utilization, or based on any workload balancing or power saving policies that you configure. This ensures that there is sufficient capacity to restart virtual machines at all times.</p>
</div>
<div class="paragraph">
<p><strong>High Availability and Storage I/O Errors</strong></p>
</div>
<div class="paragraph">
<p>If a storage I/O error occurs, the virtual machine is paused. You can define how the host handles highly available virtual machines after the connection with the storage domain is reestablished; they can either be resumed, ungracefully shut down, or remain paused. For more information about these options, see <a href="#Virtual_Machine_High_Availability_settings_explained">Virtual Machine High Availability Settings Explained</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="High_availability_considerations">6.15.2. High Availability Considerations</h4>
<div class="paragraph">
<p>A highly available host requires a power management device and fencing parameters. In addition, for a virtual machine to be highly available when its host becomes non-operational, it needs to be started on another available host in the cluster. To enable the migration of highly available virtual machines:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Power management must be configured for the hosts running the highly available virtual machines.</p>
</li>
<li>
<p>The host running the highly available virtual machine must be part of a cluster which has other available hosts.</p>
</li>
<li>
<p>The destination host must be running.</p>
</li>
<li>
<p>The source and destination host must have access to the data domain on which the virtual machine resides.</p>
</li>
<li>
<p>The source and destination host must have access to the same virtual networks and VLANs.</p>
</li>
<li>
<p>There must be enough CPUs on the destination host that are not in use to support the virtual machine&#8217;s requirements.</p>
</li>
<li>
<p>There must be enough RAM on the destination host that is not in use to support the virtual machine&#8217;s requirements.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="Configuring_a_highly_available_virtual_machine">6.15.3. Configuring a Highly Available Virtual Machine</h4>
<div class="paragraph">
<p>High availability must be configured individually for each virtual machine.</p>
</div>
<div class="paragraph">
<p><strong>Configuring a Highly Available Virtual Machine</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>High Availability</strong> tab.</p>
</li>
<li>
<p>Select the <strong>Highly Available</strong> check box to enable high availability for the virtual machine.</p>
</li>
<li>
<p>Select the storage domain to hold the virtual machine lease, or select <strong>No VM Lease</strong> to disable the functionality, from the <strong>Target Storage Domain for VM Lease</strong> drop-down list. See <a href="#What_is_high_availability">What is High Availability?</a> for more information about virtual machine leases.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This functionality is only available on storage domains that are V4 or later.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Select <strong>AUTO_RESUME</strong>, <strong>LEAVE_PAUSED</strong>, or <strong>KILL</strong> from the <strong>Resume Behavior</strong> drop-down list. If you defined a virtual machine lease, <strong>KILL</strong> is the only option available. For more information see <a href="#Virtual_Machine_High_Availability_settings_explained">Virtual Machine High Availability Settings Explained</a>.</p>
</li>
<li>
<p>Select <strong>Low</strong>, <strong>Medium</strong>, or <strong>High</strong> from the <strong>Priority</strong> drop-down list. When migration is triggered, a queue is created in which the high priority virtual machines are migrated first. If a cluster is running low on resources, only the high priority virtual machines are migrated.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Other_Virtual_Machine_Tasks">6.16. Other Virtual Machine Tasks</h3>
<div class="sect3">
<h4 id="Enabling_SAP_monitoring_for_a_virtual_machine_from_the_Administration_Portal">6.16.1. Enabling SAP Monitoring</h4>
<div class="paragraph">
<p>Enable SAP monitoring on a virtual machine through the Administration Portal.</p>
</div>
<div class="paragraph">
<p><strong>Enabling SAP Monitoring on Virtual Machines</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click the <strong>Custom Properties</strong> tab.</p>
</li>
<li>
<p>Select <code>sap_agent</code> from the drop-down list. Ensure the secondary drop-down menu is set to <strong>True</strong>.</p>
<div class="paragraph">
<p>If previous properties have been set, select the plus sign to add a new property rule and select <code>sap_agent</code>.</p>
</div>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="sect-Configuring_Red_Hat_Enterprise_Linux_5.4_and_Higher_Virtual_Machines_to_use_SPICE">6.16.2. Configuring Enterprise Linux 5.4 and later Virtual Machines to use SPICE</h4>
<div class="paragraph">
<p>SPICE is a remote display protocol designed for virtual environments, which enables you to view a virtualized desktop or server. SPICE delivers a high quality user experience, keeps CPU consumption low, and supports high quality video streaming.</p>
</div>
<div class="paragraph">
<p>Using SPICE on a Linux machine significantly improves the movement of the mouse cursor on the console of the virtual machine. To use SPICE, the X-Windows system requires additional QXL drivers. The QXL drivers are provided with Enterprise Linux 5.4 and later. Earlier versions are not supported. Installing SPICE on a virtual machine running Enterprise Linux significantly improves the performance of the graphical user interface.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Typically, this is most useful for virtual machines where the user requires the use of the graphical user interface. System administrators who are creating virtual servers may prefer not to configure SPICE if their use of the graphical user interface is minimal.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="Configuring_qxl_drivers_on_virtual_machines">Installing and Configuring QXL Drivers</h5>
<div class="paragraph">
<p>You must manually install QXL drivers on virtual machines running Enterprise Linux 5.4 or later. This is unnecessary for virtual machines running Enterprise Linux 6 or Enterprise Linux 7 as the QXL drivers are installed by default.</p>
</div>
<div class="paragraph">
<p><strong>Installing QXL Drivers</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in to a Enterprise Linux virtual machine.</p>
</li>
<li>
<p>Install the QXL drivers:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># yum install xorg-x11-drv-qxl</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can configure QXL drivers using either a graphical interface or the command line. Perform only one of the following procedures.</p>
</div>
<div class="paragraph">
<p><strong>Configuring QXL drivers in GNOME</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <strong>System</strong>.</p>
</li>
<li>
<p>Click <strong>Administration</strong>.</p>
</li>
<li>
<p>Click <strong>Display</strong>.</p>
</li>
<li>
<p>Click the <strong>Hardware</strong> tab.</p>
</li>
<li>
<p>Click <strong>Video Cards Configure</strong>.</p>
</li>
<li>
<p>Select <strong>qxl</strong> and click <b class="button">OK</b>.</p>
</li>
<li>
<p>Restart X-Windows by logging out of the virtual machine and logging back in.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Configuring QXL drivers on the command line</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Back up <strong>/etc/X11/xorg.conf</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># cp /etc/X11/xorg.conf /etc/X11/xorg.conf.$$.backup</pre>
</div>
</div>
</li>
<li>
<p>Make the following change to the Device section of <strong>/etc/X11/xorg.conf</strong>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Section 	"Device"
Identifier	"Videocard0"
Driver		"qxl"
Endsection</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect4">
<h5 id="Configuring_a_virtual_machines_tablet_and_mouse_to_use_SPICE">Configuring a Virtual Machine&#8217;s Tablet and Mouse to use SPICE</h5>
<div class="paragraph">
<p>Edit the <code>/etc/X11/xorg.conf</code> file to enable SPICE for your virtual machine&#8217;s tablet devices.</p>
</div>
<div class="paragraph">
<p><strong>Configuring a Virtual Machine&#8217;s Tablet and Mouse to use SPICE</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Verify that the tablet device is available on your guest:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># /sbin/lsusb -v | grep 'QEMU USB Tablet'</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>If there is no output from the command, do not continue configuring the tablet.</pre>
</div>
</div>
</li>
<li>
<p>Back up <code>/etc/X11/xorg.conf</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># cp /etc/X11/xorg.conf /etc/X11/xorg.conf.$$.backup</pre>
</div>
</div>
</li>
<li>
<p>Make the following changes to <code>/etc/X11/xorg.conf</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap">Section "ServerLayout"
Identifier     "single head configuration"
Screen      0  "Screen0" 0 0
InputDevice    "Keyboard0" "CoreKeyboard"
InputDevice    "Tablet" "SendCoreEvents"
InputDevice    "Mouse" "CorePointer"
EndSection

Section "InputDevice"
Identifier  "Mouse"
Driver      "void"
#Option      "Device" "/dev/input/mice"
#Option      "Emulate3Buttons" "yes"
EndSection

Section "InputDevice"
Identifier  "Tablet"
Driver      "evdev"
Option      "Device" "/dev/input/event2"
Option "CorePointer" "true"
EndSection</pre>
</div>
</div>
</li>
<li>
<p>Log out and log back into the virtual machine to restart X-Windows.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect3">
<h4 id="KVM_virtual_machine_timing_management">6.16.3. KVM Virtual Machine Timing Management</h4>
<div class="paragraph">
<p>Virtualization poses various challenges for virtual machine time keeping. Virtual machines which use the Time Stamp Counter (TSC) as a clock source may suffer timing issues as some CPUs do not have a constant Time Stamp Counter. Virtual machines running without accurate timekeeping can have serious affects on some networked applications as your virtual machine will run faster or slower than the actual time.</p>
</div>
<div class="paragraph">
<p>KVM works around this issue by providing virtual machines with a paravirtualized clock. The KVM <code>pvclock</code> provides a stable source of timing for KVM guests that support it.</p>
</div>
<div class="paragraph">
<p>Presently, only Enterprise Linux 5.4 and later virtual machines fully support the paravirtualized clock.</p>
</div>
<div class="paragraph">
<p>Virtual machines can have several problems caused by inaccurate clocks and counters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Clocks can fall out of synchronization with the actual time which invalidates sessions and affects networks.</p>
</li>
<li>
<p>Virtual machines with slower clocks may have issues migrating.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These problems exist on other virtualization platforms and timing should always be tested.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The Network Time Protocol (NTP) daemon should be running on the host and the virtual machines. Enable the <code>ntpd</code> service and add it to the default startup sequence:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>For Enterprise Linux 6</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre># service ntpd start
# chkconfig ntpd on</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>For Enterprise Linux 7</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre># systemctl start ntpd.service
# systemctl enable ntpd.service</pre>
</div>
</div>
<div class="paragraph">
<p>Using the <code>ntpd</code> service should minimize the affects of clock skew in all cases.</p>
</div>
<div class="paragraph">
<p>The NTP servers you are trying to use must be operational and accessible to your hosts and virtual machines.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="form-Virtualization-KVM_guest_timing_management-Determining_if_your_CPU_has_the_constant_Time_Stamp_Counter" class="paragraph">
<p><strong>Determining if your CPU has the constant Time Stamp Counter</strong></p>
</div>
<div class="paragraph">
<p>Your CPU has a constant Time Stamp Counter if the <code>constant_tsc</code> flag is present. To determine if your CPU has the <code>constant_tsc</code> flag run the following command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">$ cat /proc/cpuinfo | grep constant_tsc</pre>
</div>
</div>
<div class="paragraph">
<p>If any output is given your CPU has the <code>constant_tsc</code> bit. If no output is given follow the instructions below.</p>
</div>
<div id="form-Virtualization-KVM_guest_timing_management-Configuring_hosts_without_a_constant_Time_Stamp_Counter" class="paragraph">
<p><strong>Configuring hosts without a constant Time Stamp Counter</strong></p>
</div>
<div class="paragraph">
<p>Systems without constant time stamp counters require additional configuration. Power management features interfere with accurate time keeping and must be disabled for virtual machines to accurately keep time with KVM.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>These instructions are for AMD revision F CPUs only.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the CPU lacks the <code>constant_tsc</code> bit, disable all power management features (<a href="https://bugzilla.redhat.com/show_bug.cgi?id=513138">BZ#513138</a>). Each system has several timers it uses to keep time. The TSC is not stable on the host, which is sometimes caused by <code>cpufreq</code> changes, deep C state, or migration to a host with a faster TSC. Deep C sleep states can stop the TSC. To prevent the kernel using deep C states append &#8220;processor.max_cstate=1&#8221; to the kernel boot options in the <code>grub.conf</code> file on the host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">term Enterprise Linux Server (2.6.18-159.el5)
        root (hd0,0)
	kernel /vmlinuz-2.6.18-159.el5 ro root=/dev/VolGroup00/LogVol00 rhgb quiet <code>processor.max_cstate=1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Disable <code>cpufreq</code> (only necessary on hosts without the <code>constant_tsc</code>) by editing the <code>/etc/sysconfig/cpuspeed</code> configuration file and change the <code>MIN_SPEED</code> and <code>MAX_SPEED</code> variables to the highest frequency available. Valid limits can be found in the <code>/sys/devices/system/cpu/cpu/cpufreq/scaling_available_frequencies</code> files.</p>
</div>
<div class="paragraph">
<p><strong>Using the <code>engine-config</code> tool to receive alerts when hosts drift out of sync.</strong></p>
</div>
<div class="paragraph">
<p>You can use the <code>engine-config</code> tool to configure alerts when your hosts drift out of sync.</p>
</div>
<div class="paragraph">
<p>There are 2 relevant parameters for time drift on hosts: <code>EnableHostTimeDrift</code> and <code>HostTimeDriftInSec</code>. <code>EnableHostTimeDrift</code>, with a default value of false, can be enabled to receive alert notifications of host time drift. The <code>HostTimeDriftInSec</code> parameter is used to set the maximum allowable drift before alerts start being sent.</p>
</div>
<div class="paragraph">
<p>Alerts are sent once per hour per host.</p>
</div>
<div id="form-Virtualization-KVM_guest_timing_management-Using_the_para_virtualized_clock_with_Red_Hat_Enterprise_Linux_guests" class="paragraph">
<p><strong>Using the paravirtualized clock with Enterprise Linux virtual machines</strong></p>
</div>
<div class="paragraph">
<p>For certain Enterprise Linux virtual machines, additional kernel parameters are required. These parameters can be set by appending them to the end of the /kernel line in the /boot/grub/grub.conf file of the virtual machine.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The process of configuring kernel parameters can be automated using the <code>ktune</code> package</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>ktune</code> package provides an interactive Bourne shell script, <code>fix_clock_drift.sh</code>. When run as the superuser, this script inspects various system parameters to determine if the virtual machine on which it is run is susceptible to clock drift under load. If so, it then creates a new <code>grub.conf.kvm</code> file in the <code>/boot/grub/</code> directory. This file contains a kernel boot line with additional kernel parameters that allow the kernel to account for and prevent significant clock drift on the KVM virtual machine. After running <code>fix_clock_drift.sh</code> as the superuser, and once the script has created the <code>grub.conf.kvm</code> file, then the virtual machine&#8217;s current <code>grub.conf</code> file should be backed up manually by the system administrator, the new <code>grub.conf.kvm</code> file should be manually inspected to ensure that it is identical to <code>grub.conf</code> with the exception of the additional boot line parameters, the <code>grub.conf.kvm</code> file should finally be renamed <code>grub.conf</code>, and the virtual machine should be rebooted.</p>
</div>
<div class="paragraph">
<p>The table below lists versions of Enterprise Linux and the parameters required for virtual machines on systems without a constant Time Stamp Counter.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Enterprise Linux</th>
<th class="tableblock halign-left valign-top">Additional virtual machine kernel parameters</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.4 AMD64/Intel 64 with the paravirtualized clock</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional parameters are not required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.4 AMD64/Intel 64 without the paravirtualized clock</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">notsc lpj=n</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.4 x86 with the paravirtualized clock</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional parameters are not required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.4 x86 without the paravirtualized clock</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">clocksource=acpi_pm lpj=n</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.3 AMD64/Intel 64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">notsc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">5.3 x86</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">clocksource=acpi_pm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.8 AMD64/Intel 64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">notsc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">4.8 x86</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">clock=pmtmr</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.9 AMD64/Intel 64</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional parameters are not required</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">3.9 x86</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additional parameters are not required</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Adding_TPM_devices">6.16.4. Adding a Trusted Platform Module device</h4>
<div class="paragraph">
<p>Trusted Platform Module (TPM) devices provide a secure crypto-processor designed to carry out cryptographic operations such as generating cryptographic keys, random numbers, and hashes, or for storing data that can be used to verify software configurations securely. TPM devices are commonly used for disk encryption.</p>
</div>
<div class="paragraph">
<p>QEMU and libvirt implement support for emulated TPM 2.0 devices, which is what oVirt uses to add TPM devices to Virtual Machines.</p>
</div>
<div class="paragraph">
<p>Once an emulated TPM device is added to the virtual machine, it can be used as a normal TPM 2.0 device in the guest OS.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If there is TPM data stored for the virtual machine and the TPM device is disabled in the virtual machine, the TPM data is permanently removed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Enabling a TPM device</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <code>Add Virtual Machine</code> or <code>Edit Virtual Machine</code> screen, click <b class="button">Show Advanced Options</b>.</p>
</li>
<li>
<p>In the <code>Resource Allocation</code> tab, select the <strong>TPM Device Enabled</strong> check box.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><strong>Limitations</strong></p>
</div>
<div class="paragraph">
<p>The following limitations apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>TPM devices can only be used on x86_64 machines with UEFI firmware and PowerPC machines with pSeries firmware installed.</p>
</li>
<li>
<p>Virtual machines with TPM devices can not have snapshots with memory.</p>
</li>
<li>
<p>While the Engine retrieves and stores TPM data periodically, there is no guarantee that the Engine will always have the latest version of the TPM data.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This process can take 120 seconds or more, and you must wait for the process to complete before you can take snapshot of a running virtual machine, clone a running virtual machine, or migrate a running virtual machine.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>TPM devices can only be enabled for virtual machines running RHEL 7 or later and Windows 8.1 or later.</p>
</li>
<li>
<p>Virtual machines and templates with TPM data can not be exported or imported.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="chap-Templates">7. Templates</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A template is a copy of a virtual machine that you can use to simplify the subsequent, repeated creation of similar virtual machines. Templates capture the configuration of software, configuration of hardware, and the software installed on the virtual machine on which the template is based. The virtual machine on which a template is based is known as the source virtual machine.</p>
</div>
<div class="paragraph">
<p>When you create a template based on a virtual machine, a read-only copy of the virtual machine&#8217;s disk is created. This read-only disk becomes the base disk image of the new template, and of any virtual machines created based on the template. As such, the template cannot be deleted while any virtual machines created based on the template exist in the environment.</p>
</div>
<div class="paragraph">
<p>Virtual machines created based on a template use the same NIC type and driver as the original virtual machine, but are assigned separate, unique MAC addresses.</p>
</div>
<div class="paragraph">
<p>You can create a virtual machine directly from <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Templates</b></span>, as well as from <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>. In <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Templates</b></span>, select the required template and click <strong>New VM</strong>. For more information on selecting the settings and controls for the new virtual machine see <a href="#Virtual_Machine_General_settings_explained">Virtual Machine General Settings Explained</a>.</p>
</div>
<div class="sect2">
<h3 id="Sealing_Virtual_Machines_in_Preparation_for_Deployment_as_Templates">7.1. Sealing Virtual Machines in Preparation for Deployment as Templates</h3>
<div class="paragraph">
<p>This section describes procedures for sealing Linux and Windows virtual machines. Sealing is the process of removing all system-specific details from a virtual machine before creating a template based on that virtual machine. Sealing is necessary to prevent the same details from appearing on multiple virtual machines created based on the same template. It is also necessary to ensure the functionality of other features, such as predictable vNIC order.</p>
</div>
<div class="sect3">
<h4 id="Sealing_a_Linux_Virtual_Machine_for_Deployment_as_a_Template">7.1.1. Sealing a Linux Virtual Machine for Deployment as a Template</h4>
<div class="paragraph">
<p>To seal a Linux virtual machine during the template creation process, select the <strong>Seal Template</strong> check box in the <strong>New Template</strong> window. See <a href="#Creating_a_template_from_an_existing_virtual_machine">Creating a Template</a> for details.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In RHV 4.4, to seal a RHEL 8 virtual machine for a template, its cluster level must be 4.4 and all hosts in the cluster must be based on RHEL 8.
You cannot seal a RHEL 8 virtual machine if you have set its cluster level to 4.3 so it can run on RHEL 7 hosts.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="Sealing_a_Windows_Virtual_Machine_for_Deployment_as_a_Template">7.1.2. Sealing a Windows Virtual Machine for Deployment as a Template</h4>
<div class="paragraph">
<p>A template created for Windows virtual machines must be generalized (sealed) before being used to deploy virtual machines. This ensures that machine-specific settings are not reproduced in the template.</p>
</div>
<div class="paragraph">
<p><code>Sysprep</code> is used to seal Windows templates before use. <code>Sysprep</code> generates a complete unattended installation answer file. Default values for several Windows operating systems are available in the <strong>/usr/share/ovirt-engine/conf/sysprep/</strong> directory. These files act as templates for <code>Sysprep</code>. The fields in these files can be copied, pasted, and altered as required. This definition will override any values entered into the <strong>Initial Run</strong> fields of the <strong>Edit Virtual Machine</strong> window.</p>
</div>
<div class="paragraph">
<p>The Sysprep file can be edited to affect various aspects of the Windows virtual machines created from the template that the Sysprep file is attached to. These include the provisioning of Windows, setting up the required domain membership, configuring the hostname, and setting the security policy.</p>
</div>
<div class="paragraph">
<p>Replacement strings can be used to substitute values provided in the default files in the <strong>/usr/share/ovirt-engine/conf/sysprep/</strong> directory.  For example, <code>"&lt;Domain&gt;&lt;![CDATA[$JoinDomain$]]&gt;&lt;/Domain&gt;"</code> can be used to indicate the domain to join.</p>
</div>
<div class="sect4">
<h5 id="Prerequisites_for_Sealing_a_Windows_Virtual_Machine">Prerequisites for Sealing a Windows Virtual Machine</h5>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not reboot the virtual machine while Sysprep is running.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Before starting <code>Sysprep</code>, verify that the following settings are configured:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Windows virtual machine parameters have been correctly defined.</p>
</li>
<li>
<p>If not, click <strong>Edit</strong> in <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and enter the required information in the <strong>Operating System</strong> and <strong>Cluster</strong> fields.</p>
</li>
<li>
<p>The correct product key has been defined in an override file on the Engine.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The override file must be created under <strong>/etc/ovirt-engine/osinfo.conf.d/</strong>, have a filename that puts it after <strong>/etc/ovirt-engine/osinfo.conf.d/00-defaults.properties</strong>, and ends in <strong>.properties</strong>. For example, <strong>/etc/ovirt-engine/osinfo.conf.d/10-productkeys.properties</strong>. The last file will have precedence and override any other previous file.</p>
</div>
<div class="paragraph">
<p>If not, copy the default values for your Windows operating system from <strong>/etc/ovirt-engine/osinfo.conf.d/00-defaults.properties</strong> into the override file, and input your values in the <code>productKey.value</code> and <code>sysprepPath.value</code> fields.</p>
</div>
<div class="exampleblock">
<div class="title">Example 6. Windows 7 Default Configuration Values</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap"># Windows7(11, OsType.Windows, false),false
os.windows_7.id.value = 11
os.windows_7.name.value = Windows 7
os.windows_7.derivedFrom.value = windows_xp
os.windows_7.sysprepPath.value = ${ENGINE_USR}/conf/sysprep/sysprep.w7
os.windows_7.productKey.value =
os.windows_7.devices.audio.value = ich6
os.windows_7.devices.diskInterfaces.value.3.3 = IDE, VirtIO_SCSI, VirtIO
os.windows_7.devices.diskInterfaces.value.3.4 = IDE, VirtIO_SCSI, VirtIO
os.windows_7.devices.diskInterfaces.value.3.5 = IDE, VirtIO_SCSI, VirtIO
os.windows_7.isTimezoneTypeInteger.value = false</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="Sealing_a_Windows_7_or_Windows_2008_template">Sealing a Windows 7, Windows 2008, or Windows 2012 Virtual Machine for Deployment as Template</h5>
<div class="paragraph">
<p>Seal a Windows 7, Windows 2008, or Windows 2012 virtual machine before creating a template to use to deploy virtual machines.</p>
</div>
<div class="paragraph">
<p><strong>Sealing a Windows 7, Windows 2008, or Windows 2012 Virtual Machine for Deployment as a Template</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>On the Windows virtual machine, launch <code>Sysprep</code> from <strong>C:\Windows\System32\sysprep\sysprep.exe</strong>.</p>
</li>
<li>
<p>Enter the following information into <code>Sysprep</code>:</p>
<div class="ulist">
<ul>
<li>
<p>Under <strong>System Cleanup Action</strong>, select <strong>Enter System Out-of-Box-Experience (OOBE)</strong>.</p>
</li>
<li>
<p>Select the <strong>Generalize</strong> check box if you need to change the computer&#8217;s system identification number (SID).</p>
</li>
<li>
<p>Under <strong>Shutdown Options</strong>, select <strong>Shutdown</strong>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Click <b class="button">OK</b> to complete the sealing process; the virtual machine shuts down automatically upon completion.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The Windows 7, Windows 2008, or Windows 2012 virtual machine is sealed and ready to create a template to use for deploying virtual machines.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Creating_a_template_from_an_existing_virtual_machine">7.2. Creating a Template</h3>
<div class="paragraph">
<p>Create a template from an existing virtual machine to use as a blueprint for creating additional virtual machines.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In RHV 4.4, to seal a RHEL 8 virtual machine for a template, its cluster level must be 4.4 and all hosts in the cluster must be based on RHEL 8.
You cannot seal a RHEL 8 virtual machine if you have set its cluster level to 4.3 so it can run on RHEL 7 hosts.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you create a template, you specify the format of the disk to be raw or QCOW2:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>QCOW2 disks are thin provisioned.</p>
</li>
<li>
<p>Raw disks on file storage are thin provisioned.</p>
</li>
<li>
<p>Raw disks on block storage are preallocated.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Creating a Template</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select the source virtual machine.</p>
</li>
<li>
<p>Ensure the virtual machine is powered down and has a status of <code>Down</code>.</p>
</li>
<li>
<p>Click <strong>More Actions</strong> (<span class="image"><img src="common/images/moreactions.png" alt="moreactions"></span>), then click <strong>Make Template</strong>. For more details on all fields in the <strong>New Template</strong> window, see <a href="#Explanation_of_Settings_in_the_New_Template_and_Edit_Template_Windows">Explanation of Settings in the New Template Window</a>.</p>
</li>
<li>
<p>Enter a <strong>Name</strong>, <strong>Description</strong>, and <strong>Comment</strong> for the template.</p>
</li>
<li>
<p>Select the cluster with which to associate the template from the <strong>Cluster</strong> drop-down list. By default, this is the same as that of the source virtual machine.</p>
</li>
<li>
<p>Optionally, select a CPU profile for the template from the <strong>CPU Profile</strong> drop-down list.</p>
</li>
<li>
<p>Optionally, select the <strong>Create as a Template Sub-Version</strong> check box, select a <strong>Root Template</strong>, and enter a <strong>Sub-Version Name</strong> to create the new template as a sub-template of an existing template.</p>
</li>
<li>
<p>In the <strong>Disks Allocation</strong> section, enter an alias for the disk in the <strong>Alias</strong> text field. Select the disk format in the <strong>Format</strong> drop-down, the storage domain on which to store the disk from the <strong>Target</strong> drop-down, and the disk profile in the <strong>Disk Profile</strong> drop-down. By default, these are the same as those of the source virtual machine.</p>
</li>
<li>
<p>Select the <strong>Allow all users to access this Template</strong> check box to make the template public.</p>
</li>
<li>
<p>Select the <strong>Copy VM permissions</strong> check box to copy the permissions of the source virtual machine to the template.</p>
</li>
<li>
<p>Select the <strong>Seal Template</strong> check box (Linux only) to seal the template.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Sealing, which uses the <code>virt-sysprep</code> command, removes system-specific details from a virtual machine before creating a template based on that virtual machine. This prevents the original virtual machine&#8217;s details from appearing in subsequent virtual machines that are created using the same template. It also ensures the functionality of other features, such as predictable vNIC order. See <a href="#appe-virt_sysprep_operations"><code>virt-sysprep</code> Operations</a> for more information.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The virtual machine displays a status of <code>Image Locked</code> while the template is being created. The process of creating a template may take up to an hour depending on the size of the virtual disk and the capabilities of your storage hardware. When complete, the template is added to the <strong>Templates</strong> tab. You can now create new virtual machines based on the template.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>When a template is made, the virtual machine is copied so that both the existing virtual machine and its template are usable after template creation.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="Editing_a_Template">7.3. Editing a Template</h3>
<div class="paragraph">
<p>Once a template has been created, its properties can be edited. Because a template is a copy of a virtual machine, the options available when editing a template are identical to those in the <strong>Edit Virtual Machine</strong> window.</p>
</div>
<div class="paragraph">
<p><strong>Editing a Template</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Templates</b></span> and select a template.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Change the necessary properties. Click <strong>Show Advanced Options</strong> and edit the template&#8217;s settings as required. The settings that appear in the <strong>Edit Template</strong> window are identical to those in the <strong>Edit Virtual Machine</strong> window, but with the relevant fields only. See <a href="#sect-Explanation_of_Settings_in_the_New_Virtual_Machine_and_Edit_Virtual_Machine_Windows">Explanation of Settings in the New Virtual Machine and Edit Virtual Machine Windows</a> for details.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="Deleting_a_template">7.4. Deleting a Template</h3>
<div class="paragraph">
<p>If you have used a template to create a virtual machine using the thin provisioning storage allocation option, the template cannot be deleted as the virtual machine needs it to continue running. However, cloned virtual machines do not depend on the template they were cloned from and the template can be deleted.</p>
</div>
<div class="paragraph">
<p><strong>Deleting a Template</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Templates</b></span> and select a template.</p>
</li>
<li>
<p>Click <b class="button">Remove</b>.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="sect-Exporting_Templates">7.5. Exporting Templates</h3>
<div class="sect3">
<h4 id="Migrating_Templates_to_the_Export_Domain">7.5.1. Migrating Templates to the Export Domain</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The export storage domain is deprecated. Storage data domains can be unattached from a data center and imported to another data center in the same environment, or in a different environment. Virtual machines, floating virtual disks, and templates can then be uploaded from the imported storage domain to the attached data center. See the <a href="https://ovirt.org/documentation/administration_guide#sect-Importing_Existing_Storage_Domains">Importing Existing Storage Domains</a> section in the <em>oVirt Administration Guide</em> for information on importing storage domains.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Export templates into the export domain to move them to another data domain, either in the same oVirt environment, or another one. This procedure requires access to the Administration Portal.</p>
</div>
<div class="paragraph">
<p><strong>Exporting Individual Templates to the Export Domain</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Templates</b></span> and select a template.</p>
</li>
<li>
<p>Click <b class="button">Export</b>.</p>
</li>
<li>
<p>Select the <strong>Force Override</strong> check box to replace any earlier version of the template on the export domain.</p>
</li>
<li>
<p>Click <b class="button">OK</b> to begin exporting the template; this may take up to an hour, depending on the virtual disk size and your storage hardware.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Repeat these steps until the export domain contains all the templates to migrate before you start the import process.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Storage</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Domains</b></span> and select the export domain.</p>
</li>
<li>
<p>Click the domain name to see the details view.</p>
</li>
<li>
<p>Click the <strong>Template Import</strong> tab to view all exported templates in the export domain.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Copying_a_Templates_Virtual_Hard_Disk">7.5.2. Copying a Template&#8217;s Virtual Hard Disk</h4>
<div class="paragraph">
<p>If you are moving a virtual machine that was created from a template with the thin provisioning storage allocation option selected, the template&#8217;s disks must be copied to the same storage domain as that of the virtual disk. This procedure requires access to the Administration Portal.</p>
</div>
<div class="paragraph">
<p><strong>Copying a Virtual Hard Disk</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Storage</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Disks</b></span>.</p>
</li>
<li>
<p>Select the template disk(s) to copy.</p>
</li>
<li>
<p>Click <b class="button">Copy</b>.</p>
</li>
<li>
<p>Select the <strong>Target</strong> data domain from the drop-down list(s).</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A copy of the template&#8217;s virtual hard disk has been created, either on the same, or a different, storage domain. If you were copying a template disk in preparation for moving a virtual hard disk, you can now move the virtual hard disk.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Importing_Templates">7.6. Importing Templates</h3>
<div class="sect3">
<h4 id="Importing_a_template_into_a_data_center">7.6.1. Importing a Template into a Data Center</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The export storage domain is deprecated. Storage data domains can be unattached from a data center and imported to another data center in the same environment, or in a different environment. Virtual machines, floating virtual disks, and templates can then be uploaded from the imported storage domain to the attached data center. See the <a href="https://ovirt.org/documentation/administration_guide#sect-Importing_Existing_Storage_Domains">Importing Existing Storage Domains</a> section in the <em>oVirt Administration Guide</em> for information on importing storage domains.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Import templates from a newly attached export domain. This procedure requires access to the Administration Portal.</p>
</div>
<div class="paragraph">
<p><strong>Importing a Template into a Data Center</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Storage</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Domains</b></span> and select the newly attached export domain.</p>
</li>
<li>
<p>Click the domain name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Template Import</strong> tab and select a template.</p>
</li>
<li>
<p>Click <b class="button">Import</b>.</p>
</li>
<li>
<p>Use the drop-down lists to select the <strong>Target Cluster</strong> and <strong>CPU Profile</strong>.</p>
</li>
<li>
<p>Select the template to view its details, then click the <strong>Disks</strong> tab and select the <strong>Storage Domain</strong> to import the template into.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
<li>
<p>If the <strong>Import Template Conflict</strong> window appears, enter a <strong>New Name</strong> for the template, or select the <strong>Apply to all</strong> check box and enter a <strong>Suffix to add to the cloned Templates</strong>. Click <b class="button">OK</b>.</p>
</li>
<li>
<p>Click <b class="button">Close</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The template is imported into the destination data center. This can take up to an hour, depending on your storage hardware. You can view the import progress in the <strong>Events</strong> tab.</p>
</div>
<div class="paragraph">
<p>Once the importing process is complete, the templates will be visible in <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Templates</b></span>. The templates can create new virtual machines, or run existing imported virtual machines based on that template.</p>
</div>
</div>
<div class="sect3">
<h4 id="Importing_a_Virtual_Disk_from_an_OpenStack_Image_Service_as_a_Template">7.6.2. Importing a Virtual Disk from an OpenStack Image Service as a Template</h4>
<div class="paragraph">
<p>Virtual disks managed by an OpenStack Image Service can be imported into the oVirt Engine if that OpenStack Image Service has been added to the Engine as an external provider. This procedure requires access to the Administration Portal.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Storage</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Domains</b></span> and select the OpenStack Image Service domain.</p>
</li>
<li>
<p>Click the storage domain name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Images</strong> tab and select the image to import.</p>
</li>
<li>
<p>Click <strong>Import</strong>.</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you are importing an image from a Glance storage domain, you have the option of specifying the template name.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Select the <strong>Data Center</strong> into which the virtual disk will be imported.</p>
</li>
<li>
<p>Select the storage domain in which the virtual disk will be stored from the <strong>Domain Name</strong> drop-down list.</p>
</li>
<li>
<p>Optionally, select a <strong>Quota</strong> to apply to the virtual disk.</p>
</li>
<li>
<p>Select the <strong>Import as Template</strong> check box.</p>
</li>
<li>
<p>Select the <strong>Cluster</strong> in which the virtual disk will be made available as a template.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The image is imported as a template and is displayed in the <strong>Templates</strong> tab. You can now create virtual machines based on the template.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sect-Templates_and_Permissions">7.7. Templates and Permissions</h3>
<div class="sect3">
<h4 id="Managing_System_Permissions_for_a_Template">7.7.1. Managing System Permissions for a Template</h4>
<div class="paragraph">
<p>As the <strong>SuperUser</strong>, the system administrator manages all aspects of the Administration Portal. More specific administrative roles can be assigned to other users. These restricted administrator roles are useful for granting a user administrative privileges that limit them to a specific resource. For example, a <strong>DataCenterAdmin</strong> role has administrator privileges only for the assigned data center with the exception of the storage for that data center, and a <strong>ClusterAdmin</strong> has administrator privileges only for the assigned cluster.</p>
</div>
<div class="paragraph">
<p>A template administrator is a system administration role for templates in a data center. This role can be applied to specific virtual machines, to a data center, or to the whole virtualized environment; this is useful to allow different users to manage certain virtual resources.</p>
</div>
<div class="paragraph">
<p>The template administrator role permits the following actions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Create, edit, export, and remove associated templates.</p>
</li>
<li>
<p>Import and export templates.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You can only assign roles and permissions to existing users.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="Template_Administrator_Roles_Explained">7.7.2. Template Administrator Roles Explained</h4>
<div class="paragraph">
<p>The table below describes the administrator roles and privileges applicable to template administration.</p>
</div>
<table id="Template_Administrator_Roles" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. oVirt System Administrator Roles</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Role</th>
<th class="tableblock halign-left valign-top">Privileges</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TemplateAdmin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can perform all operations on templates.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Has privileges to create, delete and configure a template&#8217;s storage domain and network details, and to move templates between domains.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NetworkAdmin</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network Administrator</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can configure and manage networks attached to templates.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Assigning_an_Administrator_or_User_Role_to_a_Resource">7.7.3. Assigning an Administrator or User Role to a Resource</h4>
<div class="paragraph">
<p>Assign administrator or user roles to resources to allow users to access or manage that resource.</p>
</div>
<div class="paragraph">
<p><strong>Assigning a Role to a Resource</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use the resource tabs, tree mode, or the search function to find and select the resource in the results list.</p>
</li>
<li>
<p>Click the resource&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Permissions</strong> tab to list the assigned users, the user&#8217;s role, and the inherited permissions for the selected resource.</p>
</li>
<li>
<p>Click <b class="button">Add</b>.</p>
</li>
<li>
<p>Enter the name or user name of an existing user into the <strong>Search</strong> text box and click <strong>Go</strong>. Select a user from the resulting list of possible matches.</p>
</li>
<li>
<p>Select a role from the <strong>Role to Assign:</strong> drop-down list.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You have assigned a role to a user; the user now has the inherited permissions of that role enabled for that resource.</p>
</div>
</div>
<div class="sect3">
<h4 id="Removing_an_Administrator_or_User_Role_from_a_Resource">7.7.4. Removing an Administrator or User Role from a Resource</h4>
<div class="paragraph">
<p>Remove an administrator or user role from a resource; the user loses the inherited permissions associated with the role for that resource.</p>
</div>
<div class="paragraph">
<p><strong>Removing a Role from a Resource</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use the resource tabs, tree mode, or the search function to find and select the resource in the results list.</p>
</li>
<li>
<p>Click the resource&#8217;s name to go to the details view.</p>
</li>
<li>
<p>Click the <strong>Permissions</strong> tab to list the assigned users, the user&#8217;s role, and the inherited permissions for the selected resource.</p>
</li>
<li>
<p>Select the user to remove from the resource.</p>
</li>
<li>
<p>Click <b class="button">Remove</b>. The <strong>Remove Permission</strong> window opens to confirm permissions removal.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You have removed the user&#8217;s role, and the associated permissions, from the resource.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Using_Cloud-Init_to_Automate_the_Configuration_of_Virtual_Machines">7.8. Using Cloud-Init to Automate the Configuration of Virtual Machines</h3>
<div class="paragraph">
<p>Cloud-Init is a tool for automating the initial setup of virtual machines such as configuring the host name, network interfaces, and authorized keys. It can be used when provisioning virtual machines that have been deployed based on a template to avoid conflicts on the network.</p>
</div>
<div class="paragraph">
<p>To use this tool, the <code>cloud-init</code> package must first be installed on the virtual machine. Once installed, the Cloud-Init service starts during the boot process to search for instructions on what to configure. You can then use options in the <strong>Run Once</strong> window to provide these instructions one time only, or options in the <strong>New Virtual Machine</strong>, <strong>Edit Virtual Machine</strong> and <strong>Edit Template</strong> windows to provide these instructions every time the virtual machine starts.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Alternatively, you can configure Cloud-Init with <a href="https://docs.ansible.com/ansible/latest/modules/ovirt_vm_module.html#examples">Ansible</a>, <a href="https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/html-single/python_sdk_guide/index#Starting_a_Virtual_Machine_with_Cloud-Init">Python</a>, <a href="https://github.com/oVirt/ovirt-engine-sdk-java/blob/master/sdk/src/test/java/org/ovirt/engine/sdk4/examples/StartVmWithCloudInit.java">Java</a>, or <a href="https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/html-single/ruby_sdk_guide/index#starting_a_virtual_machine_with_cloud_init">Ruby</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="Cloud-Init_Use_Case_Scenarios">7.8.1. Cloud-Init Use Case Scenarios</h4>
<div class="paragraph">
<p>Cloud-Init can be used to automate the configuration of virtual machines in a variety of scenarios. Several common scenarios are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Virtual Machines Created Based on Templates</strong></p>
<div class="paragraph">
<p>You can use the Cloud-Init options in the <strong>Initial Run</strong> section of the <strong>Run Once</strong> window to initialize a virtual machine that was created based on a template. This allows you to customize the virtual machine the first time that virtual machine is started.</p>
</div>
</li>
<li>
<p><strong>Virtual Machine Templates</strong></p>
<div class="paragraph">
<p>You can use the <strong>Use Cloud-Init/Sysprep</strong> options in the <strong>Initial Run</strong> tab of the <strong>Edit Template</strong> window to specify options for customizing virtual machines created based on that template.</p>
</div>
</li>
<li>
<p><strong>Virtual Machine Pools</strong></p>
<div class="paragraph">
<p>You can use the <strong>Use Cloud-Init/Sysprep</strong> options in the <strong>Initial Run</strong> tab of the <strong>New Pool</strong> window to specify options for customizing virtual machines taken from that virtual machine pool. This allows you to specify a set of standard settings that will be applied every time a virtual machine is taken from that virtual machine pool. You can inherit or override the options specified for the template on which the virtual machine is based, or specify options for the virtual machine pool itself.</p>
</div>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="Installing_Cloud-Init">7.8.2. Installing Cloud-Init</h4>
<div class="paragraph">
<p>This procedure describes how to install Cloud-Init on a virtual machine. Once Cloud-Init is installed, you can create a template based on this virtual machine. Virtual machines created based on this template can leverage Cloud-Init functions, such as configuring the host name, time zone, root password, authorized keys, network interfaces, DNS service, etc on boot.</p>
</div>
<div class="paragraph">
<p><strong>Installing Cloud-Init</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Log in to the virtual machine.</p>
</li>
<li>
<p>Enable the repositories:</p>
<div class="ulist">
<ul>
<li>
<p>For Enterprise Linux 6:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos \
    --enable=rhel-6-server-rpms \
    --enable=rhel-6-server-rh-common-rpms</pre>
</div>
</div>
</li>
<li>
<p>For Enterprise Linux 7:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># subscription-manager repos \
    --enable=rhel-7-server-rpms \
    --enable=rhel-7-server-rh-common-rpms</pre>
</div>
</div>
</li>
<li>
<p>For Enterprise Linux 8, you normally do not need to enable repositories to install Cloud-Init. The Cloud-Init package is part of the AppStream repo, <code>rhel-8-for-x86_64-appstream-rpms</code>, which is enabled by default in Enterprise Linux 8.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Install the <code>cloud-init</code> package and dependencies:</p>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># dnf install cloud-init</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For versions of Enterprise Linux earlier than version 8, use the command <code>yum install cloud-init</code> instead of <code>dnf install cloud-init</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="Using_Cloud-Init_to_Prepare_a_Template">7.8.3. Using Cloud-Init to Prepare a Template</h4>
<div class="paragraph">
<p>As long as the <code>cloud-init</code> package is installed on a Linux virtual machine, you can use the virtual machine to make a cloud-init enabled template. Specify a set of standard settings to be included in a template as described in the following procedure or, alternatively, skip the Cloud-Init settings steps and configure them when creating a virtual machine based on this template.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>While the following procedure outlines how to use Cloud-Init when preparing a template, the same settings are also available in the <strong>New Virtual Machine</strong>, <strong>Edit Template</strong>, and <strong>Run Once</strong> windows.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Using Cloud-Init to Prepare a Template</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Templates</b></span> and select a template.</p>
</li>
<li>
<p>Click <b class="button">Edit</b>.</p>
</li>
<li>
<p>Click <b class="button">Show Advanced Options</b></p>
</li>
<li>
<p>Click the <strong>Initial Run</strong> tab and select the <strong>Use Cloud-Init/Sysprep</strong> check box.</p>
</li>
<li>
<p>Enter a host name in the <strong>VM Hostname</strong> text field.</p>
</li>
<li>
<p>Select the <strong>Configure Time Zone</strong> check box and select a time zone from the <strong>Time Zone</strong> drop-down list.</p>
</li>
<li>
<p>Expand the <strong>Authentication</strong> section.</p>
<div class="ulist">
<ul>
<li>
<p>Select the <strong>Use already configured password</strong> check box to use the existing credentials, or clear that check box and enter a root password in the <strong>Password</strong> and <strong>Verify Password</strong> text fields to specify a new root password.</p>
</li>
<li>
<p>Enter any SSH keys to be added to the authorized hosts file on the virtual machine in the <strong>SSH Authorized Keys</strong> text area.</p>
</li>
<li>
<p>Select the <strong>Regenerate SSH Keys</strong> check box to regenerate SSH keys for the virtual machine.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Expand the <strong>Networks</strong> section.</p>
<div class="ulist">
<ul>
<li>
<p>Enter any DNS servers in the <strong>DNS Servers</strong> text field.</p>
</li>
<li>
<p>Enter any DNS search domains in the <strong>DNS Search Domains</strong> text field.</p>
</li>
<li>
<p>Select the <strong>In-guest Network Interface</strong> check box and use the <strong>+ Add new</strong> and <strong>- Renove selected</strong> buttons to add or remove network interfaces to or from the virtual machine.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must specify the correct network interface name and number (for example, <code>eth0</code>, <code>eno3</code>, <code>enp0s</code>). Otherwise, the virtual machine&#8217;s interface connection will be up, but it will not have the <strong>cloud-init</strong> network configuration.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Expand the <strong>Custom Script</strong> section and enter any custom scripts in the <strong>Custom Script</strong> text area.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can now provision new virtual machines using this template.</p>
</div>
</div>
<div class="sect3">
<h4 id="Using_Cloud-Init">7.8.4. Using Cloud-Init to Initialize a Virtual Machine</h4>
<div class="paragraph">
<p>Use Cloud-Init to automate the initial configuration of a Linux virtual machine. You can use the Cloud-Init fields to configure a virtual machine&#8217;s host name, time zone, root password, authorized keys, network interfaces, and DNS service. You can also specify a custom script, a script in YAML format, to run on boot. The custom script allows for additional Cloud-Init configuration that is supported by Cloud-Init but not available in the Cloud-Init fields. For more information on custom script examples, see <a href="http://cloudinit.readthedocs.org/en/latest/topics/examples.html">Cloud config examples</a>.</p>
</div>
<div class="paragraph">
<p><strong>Using Cloud-Init to Initialize a Virtual Machine</strong></p>
</div>
<div class="paragraph">
<p>This procedure starts a virtual machine with a set of Cloud-Init settings. If the relevant settings are included in the template the virtual machine is based on, review the settings, make changes where appropriate, and click <b class="button">OK</b> to start the virtual machine.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select a virtual machine.</p>
</li>
<li>
<p>Click the <b class="button">Run</b> drop-down button and select <strong>Run Once</strong>.</p>
</li>
<li>
<p>Expand the <strong>Initial Run</strong> section and select the <strong>Cloud-Init</strong> check box.</p>
</li>
<li>
<p>Enter a host name in the <strong>VM Hostname</strong> text field.</p>
</li>
<li>
<p>Select the <strong>Configure Time Zone</strong> check box and select a time zone from the <strong>Time Zone</strong> drop-down menu.</p>
</li>
<li>
<p>Select the <strong>Use already configured password</strong> check box to use the existing credentials, or clear that check box and enter a root password in the <strong>Password</strong> and <strong>Verify Password</strong> text fields to specify a new root password.</p>
</li>
<li>
<p>Enter any SSH keys to be added to the authorized hosts file on the virtual machine in the <strong>SSH Authorized Keys</strong> text area.</p>
</li>
<li>
<p>Select the <strong>Regenerate SSH Keys</strong> check box to regenerate SSH keys for the virtual machine.</p>
</li>
<li>
<p>Enter any DNS servers in the <strong>DNS Servers</strong> text field.</p>
</li>
<li>
<p>Enter any DNS search domains in the <strong>DNS Search Domains</strong> text field.</p>
</li>
<li>
<p>Select the <strong>Network</strong> check box and use the <strong>+</strong> and <strong>-</strong> buttons to add or remove network interfaces to or from the virtual machine.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>You must specify the correct network interface name and number (for example, <code>eth0</code>, <code>eno3</code>, <code>enp0s</code>). Otherwise, the virtual machine&#8217;s interface connection will be up, but the <strong>cloud-init</strong> network configuration will not be defined in it.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p>Enter a custom script in the <strong>Custom Script</strong> text area. Make sure the values specified in the script are appropriate. Otherwise, the action will fail.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To check if a virtual machine has Cloud-Init installed, select a virtual machine and click the <strong>Applications</strong> sub-tab. Only shown if the guest agent is installed.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Using_Sysprep_to_Automate_the_Configuration_of_Virtual_Machines">7.9. Using Sysprep to Automate the Configuration of Virtual Machines</h3>
<div class="paragraph">
<p><code>Sysprep</code> is a tool used to automate the setup of Windows virtual machines, for example, configuring host names, network interfaces, authorized keys, set up users, or to connect to Active Directory. <code>Sysprep</code> is installed with every version of Windows.</p>
</div>
<div class="paragraph">
<p>oVirt enhances <code>Sysprep</code> by exploiting virtualization technology to deploy virtual workstations based on a single template. oVirt builds a tailored auto-answer file for each virtual workstation.</p>
</div>
<div class="paragraph">
<p><code>Sysprep</code> generates a complete unattended installation answer file. Default values for several Windows operating systems are available in the <strong>/usr/share/ovirt-engine/conf/sysprep/</strong> directory. You can also create a custom <code>Sysprep</code> file and reference it from the the <strong>osinfo</strong> file in the <strong>/etc/ovirt-engine/osinfo.conf.d/</strong> directory. These files act as templates for <code>Sysprep</code>. The fields in these files can be copied and edited as required. This definition will override any values entered into the <strong>Initial Run</strong> fields of the <strong>Edit Virtual Machine</strong> window.</p>
</div>
<div class="paragraph">
<p>You can create a custom <code>sysprep</code> file when creating a pool of Windows virtual machines, to accommodate various operating systems and domains. See <a href="https://ovirt.org/documentation/administration_guide/index#Creating_a_VM_Pool">Creating a Virtual Machine Pool</a> in the <em>Administration Guide</em> for details.</p>
</div>
<div class="paragraph">
<p>The override file must be created under <strong>/etc/ovirt-engine/osinfo.conf.d/</strong>, have a filename that puts it after <strong>/etc/ovirt-engine/osinfo.conf.d/00-defaults.properties</strong>, and ends in <strong>.properties</strong>. For example, <strong>/etc/ovirt-engine/osinfo.conf.d/10-productkeys.properties</strong>. The last file will have precedence and override any other previous file.</p>
</div>
<div class="paragraph">
<p>Copy the default values for your Windows operating system from <strong>/etc/ovirt-engine/osinfo.conf.d/00-defaults.properties</strong> into the override file, and input your values in the <code>productKey.value</code> and <code>sysprepPath.value</code> fields.</p>
</div>
<div class="exampleblock">
<div class="title">Example 7. Windows 7 Default Configuration Values</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="nowrap"># Windows7(11, OsType.Windows, false),false
os.windows_7.id.value = 11
os.windows_7.name.value = Windows 7
os.windows_7.derivedFrom.value = windows_xp
os.windows_7.sysprepPath.value = ${ENGINE_USR}/conf/sysprep/sysprep.w7
os.windows_7.productKey.value =
os.windows_7.devices.audio.value = ich6
os.windows_7.devices.diskInterfaces.value.3.3 = IDE, VirtIO_SCSI, VirtIO
os.windows_7.devices.diskInterfaces.value.3.4 = IDE, VirtIO_SCSI, VirtIO
os.windows_7.devices.diskInterfaces.value.3.5 = IDE, VirtIO_SCSI, VirtIO
os.windows_7.isTimezoneTypeInteger.value = false</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="Configuring_Sysprep_on_a_Template">7.9.1. Configuring Sysprep on a Template</h4>
<div class="paragraph">
<p>You can use this procedure to specify a set of standard <code>Sysprep</code> settings to include in the template, alternatively you can configure the <code>Sysprep</code> settings when creating a virtual machine based on this template.</p>
</div>
<div class="paragraph">
<p>Replacement strings can be used to substitute values provided in the default files in the <strong>/usr/share/ovirt-engine/conf/sysprep/</strong> directory.  For example, <strong>"&lt;Domain&gt;&lt;![CDATA[$JoinDomain$]]&gt;&lt;/Domain&gt;"</strong> can be used to indicate the domain to join.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Do not reboot the virtual machine while <code>Sysprep</code> is running.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Prerequisites</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p>The Windows virtual machine parameters have been correctly defined.</p>
<div class="paragraph">
<p>If not, click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>, click <b class="button">Edit</b>, and enter the required information in the <strong>Operating System</strong> and <strong>Cluster</strong> fields.</p>
</div>
</li>
<li>
<p>The correct product key has been defined in an override file on the Engine.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Using <code>Sysprep</code> to Prepare a Template</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Build the Windows virtual machine with the required patches and software.</p>
</li>
<li>
<p>Seal the Windows virtual machine. See <a href="#Sealing_Virtual_Machines_in_Preparation_for_Deployment_as_Templates">Sealing Virtual Machines in Preparation for Deployment as Templates</a></p>
</li>
<li>
<p>Create a template based on the Windows virtual machine. See <a href="#Creating_a_template_from_an_existing_virtual_machine">Creating a Template</a></p>
</li>
<li>
<p>Update the <code>Sysprep</code> file with a text editor if additional changes are required.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>You can now provision new virtual machines using this template.</p>
</div>
</div>
<div class="sect3">
<h4 id="Using_Sysprep_to_Initialize_a_Virtual_Machine">7.9.2. Using Sysprep to Initialize a Virtual Machine</h4>
<div class="paragraph">
<p>Use <code>Sysprep</code> to automate the initial configuration of a Windows virtual machine. You can use the <strong>Sysprep</strong> fields to configure a virtual machine&#8217;s host name, time zone, root password, authorized keys, network interfaces, and DNS service.</p>
</div>
<div class="paragraph">
<div class="title">Using Sysprep to Initialize a Virtual Machine</div>
<p>This procedure starts a virtual machine with a set of <code>Sysprep</code> settings. If the relevant settings are included in the template the virtual machine is based on, review the settings and make changes where required.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a new Windows virtual machine based on a template of the required Windows virtual machine. See <a href="#Creating_a_Virtual_Machine_Based_on_a_Template">Creating a Virtual Machine Based on a Template</a>.</p>
</li>
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span> and select the virtual machine.</p>
</li>
<li>
<p>Click the <b class="button">Run</b> drop-down button and select <strong>Run Once</strong>.</p>
</li>
<li>
<p>Expand the <strong>Boot Options</strong> section, select the <strong>Attach Floppy</strong> check box, and select the <strong>[sysprep]</strong> option.</p>
</li>
<li>
<p>Select the <strong>Attach CD</strong> check box and select the required Windows ISO from the drop-down list.</p>
</li>
<li>
<p>Move the <strong>CD-ROM</strong> to the top of the <strong>Boot Sequence</strong> field.</p>
</li>
<li>
<p>Configure any further <strong>Run Once</strong> options as required. See <a href="#Virtual_Machine_Run_Once_settings_explained">Explanation of settings in the Run Once window</a> for more details.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="Creating_a_Virtual_Machine_Based_on_a_Template">7.10. Creating a Virtual Machine Based on a Template</h3>
<div class="paragraph">
<p>Create a virtual machine from a template to enable the virtual machines to be pre-configured with an operating system, network interfaces, applications and other resources.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Virtual machines created from a template depend on that template. So you cannot remove a template from the Engine if a virtual machine was created from that template. However, you can clone a virtual machine from a template to remove the dependency on that template.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the BIOS type of the virtual machine differs from the BIOS type of the template, the Engine might change devices in the virtual machine, possibly preventing the operating system from booting. For example, if the template uses IDE disks and the i440fx chipset, changing the BIOS type to the Q35 chipset automatically changes the IDE disks to SATA disks. So configure the chipset and BIOS type to match the chipset and BIOS type of the template.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Creating a Virtual Machine Based on a Template</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click <b class="button">New</b>.</p>
</li>
<li>
<p>Select the <strong>Cluster</strong> on which the virtual machine will run.</p>
</li>
<li>
<p>Select a template from the <strong>Template</strong> list.</p>
</li>
<li>
<p>Enter a <strong>Name</strong>, <strong>Description</strong>, and any <strong>Comments</strong>, and accept the default values inherited from the template in the rest of the fields. You can change them if needed.</p>
</li>
<li>
<p>Click the <strong>Resource Allocation</strong> tab.</p>
</li>
<li>
<p>Select the <strong>Thin</strong> or <strong>Clone</strong> radio button in the <strong>Storage Allocation</strong> area. If you select <strong>Thin</strong>, the disk format is QCOW2. If you select <strong>Clone</strong>, select either <strong>QCOW2</strong> or <strong>Raw</strong> for disk format.</p>
</li>
<li>
<p>Use the <strong>Target</strong> drop-down list to select the storage domain on which the virtual machine&#8217;s virtual disk will be stored.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The virtual machine is displayed in the <strong>Virtual Machines</strong> tab.</p>
</div>
<div class="ulist">
<div class="title">Additional Resources</div>
<ul>
<li>
<p><a href="#Creating_a_cloned_virtual_machine_based_on_a_template">Creating a Cloned Virtual Machine Based on a Template</a></p>
</li>
<li>
<p><a href="https://ovirt.org/documentation/administration_guide/index#About_UEFI_Q35-cluster_opt_settings">UEFI and the Q35 chipset</a> in the <em>Administration Guide</em>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="Creating_a_cloned_virtual_machine_based_on_a_template">7.11. Creating a Cloned Virtual Machine Based on a Template</h3>
<div class="paragraph">
<p>Cloned virtual machines are based on templates and inherit the settings of the template. A cloned virtual machine does not depend on the template on which it was based after it has been created. This means the template can be deleted if no other dependencies exist.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you clone a virtual machine from a template, the name of the template on which that virtual machine was based is displayed in the <strong>General</strong> tab of the <strong>Edit Virtual Machine</strong> window for that virtual machine. If you change the name of that template, the name of the template in the <strong>General</strong> tab will also be updated. However, if you delete the template from the Engine, the original name of that template will be displayed instead.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Cloning a Virtual Machine Based on a Template</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Click <span class="menuseq"><b class="menu">Compute</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Virtual Machines</b></span>.</p>
</li>
<li>
<p>Click <b class="button">New</b>.</p>
</li>
<li>
<p>Select the <strong>Cluster</strong> on which the virtual machine will run.</p>
</li>
<li>
<p>Select a template from the <strong>Based on Template</strong> drop-down menu.</p>
</li>
<li>
<p>Enter a <strong>Name</strong>, <strong>Description</strong> and any <strong>Comments</strong>. You can accept the default values inherited from the template in the rest of the fields, or change them if required.</p>
</li>
<li>
<p>Click the <strong>Resource Allocation</strong> tab.</p>
</li>
<li>
<p>Select the <strong>Clone</strong> radio button in the <strong>Storage Allocation</strong> area.</p>
</li>
<li>
<p>Select the disk format from the <strong>Format</strong> drop-down list. This affects the speed of the clone operation and the amount of disk space the new virtual machine initially requires.</p>
<div class="ulist">
<ul>
<li>
<p><strong>QCOW2</strong> (Default)</p>
<div class="ulist">
<ul>
<li>
<p>Faster clone operation</p>
</li>
<li>
<p>Optimized use of storage capacity</p>
</li>
<li>
<p>Disk space allocated only as required</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Raw</strong></p>
<div class="ulist">
<ul>
<li>
<p>Slower clone operation</p>
</li>
<li>
<p>Optimized virtual machine read and write operations</p>
</li>
<li>
<p>All disk space requested in the template is allocated at the time of the clone operation</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Use the <strong>Target</strong> drop-down menu to select the storage domain on which the virtual machine&#8217;s virtual disk will be stored.</p>
</li>
<li>
<p>Click <b class="button">OK</b>.</p>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Cloning a virtual machine may take some time. A new copy of the template&#8217;s disk must be created. During this time, the virtual machine&#8217;s status is first <strong>Image Locked</strong>, then <strong>Down</strong>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The virtual machine is created and displayed in the <strong>Virtual Machines</strong> tab. You can now assign users to it, and can begin using it when the clone operation is complete.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appe-Reference_Settings_in_Administration_Portal_and_User_Portal_Windows">Appendix A: Reference: Settings in Administration Portal and VM Portal Windows</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="sect-Explanation_of_Settings_in_the_New_Virtual_Machine_and_Edit_Virtual_Machine_Windows">Explanation of Settings in the New Virtual Machine and Edit Virtual Machine Windows</h3>
<div class="sect3">
<h4 id="Virtual_Machine_General_settings_explained">Virtual Machine General Settings Explained</h4>
<div class="paragraph">
<p>The following table details the options available on the <strong>General</strong> tab of the <strong>New Virtual Machine</strong> and <strong>Edit Virtual Machine</strong> windows.</p>
</div>
<table id="New_VMs_Fields" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. Virtual Machine: General Settings</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Power cycle required?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Cluster</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the host cluster to which the virtual machine is attached. Virtual machines are hosted on any physical machine in that cluster in accordance with policy rules.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes. Cross-cluster migration is for emergency use only. Moving clusters requires the virtual machine to be down.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Template</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The template on which the virtual machine is based. This field is set to <code>Blank</code> by default, which allows you to create a virtual machine on which an operating system has not yet been installed. Templates are displayed as <strong>Name | Sub-version name (Sub-version number)</strong>. Each new version is displayed with a number in brackets that indicates the relative order of the version, with a higher number indicating a more recent version.</p>
<p class="tableblock">The version name is displayed as <code>base version</code> if it is the root template of the template version chain.</p>
<p class="tableblock">When the virtual machine is stateless, there is an option to select the <code>latest</code> version of the template. This option means that anytime a new version of this template is created, the virtual machine is automatically recreated on restart based on the latest template.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable. This setting is for provisioning new virtual machines only.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Operating System</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The operating system. Valid values include a range of Enterprise Linux and Windows variants.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes. Potentially changes the virtual hardware.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Instance Type</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The instance type on which the virtual machine&#8217;s hardware configuration can be based. This field is set to <strong>Custom</strong> by default, which means the virtual machine is not connected to an instance type. The other options available from this drop down menu are <strong>Large</strong>, <strong>Medium</strong>, <strong>Small</strong>, <strong>Tiny</strong>, <strong>XLarge</strong>, and any custom instance types that the Administrator has created.</p>
<p class="tableblock">Other settings that have a chain link icon next to them are pre-filled by the selected instance type. If one of these values is changed, the virtual machine will be detached from the instance type and the chain icon will appear broken. However, if the changed setting is restored to its original value, the virtual machine will be reattached to the instance type and the links in the chain icon will rejoin.</p>
<p class="tableblock"><strong>NOTE:</strong> Support for instance types is now deprecated, and will be removed in a future release.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Optimized for</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of system for which the virtual machine is to be optimized. There are three options: <strong>Server</strong>, <strong>Desktop</strong>, and <strong>High Performance</strong>; by default, the field is set to <strong>Server</strong>. Virtual machines optimized to act as servers have no sound card, use a cloned disk image, and are not stateless. Virtual machines optimized to act as desktop machines do have a sound card, use an image (thin allocation), and are stateless. Virtual machines optimized for high performance have a number of configuration changes. See <a href="#Configuring_High_Performance_Virtual_Machines_Templates_and_Pools">Configuring High Performance Virtual Machines, Templates, and Pools</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the virtual machine. The name must be a unique name within the data center and must not contain any spaces, and must contain at least one character from A-Z or 0-9. The maximum length of a virtual machine name is 255 characters. The name can be reused in different data centers in the environment.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>VM ID</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The virtual machine ID. The virtual machine&#8217;s creator can set a custom ID for that virtual machine. The custom ID must contain only numbers, in the format, <code>00000000-0000-0000-0000-00000000</code>.</p>
<p class="tableblock">If no ID is specified during creation a UUID will be automatically assigned. For both custom and automatically-generated IDs, changes are not possible after virtual machine creation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A meaningful description of the new virtual machine.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Comment</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A field for adding plain text human-readable comments regarding the virtual machine.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Affinity Labels</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add or remove a selected <strong>Affinity Label</strong>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Stateless</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select this check box to run the virtual machine in stateless mode. This mode is used primarily for desktop virtual machines. Running a stateless desktop or server creates a new COW layer on the virtual machine hard disk image where new and changed data is stored. Shutting down the stateless virtual machine deletes the new COW layer which includes all data and configuration changes, and returns the virtual machine to its original state. Stateless virtual machines are useful when creating machines that need to be used for a short time, or by temporary staff.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Start in Pause Mode</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select this check box to always start the virtual machine in pause mode. This option is suitable for virtual machines which require a long time to establish a SPICE connection; for example, virtual machines in remote locations.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Delete Protection</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select this check box to make it impossible to delete the virtual machine. It is only possible to delete the virtual machine if this check box is not selected.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Sealed</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select this check box to seal the created virtual machine. This option eliminates machine-specific settings from virtual machines that are provisioned from the template. For more information about the sealing process, see <a href="https://ovirt.org/documentation/virtual_machine_management_guide#Sealing_a_Windows_Virtual_Machine_for_Deployment_as_a_Template">Sealing a Windows Virtual Machine for Deployment as a Template</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Instance Images</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Click <strong>Attach</strong> to attach a floating disk to the virtual machine, or click <strong>Create</strong> to add a new virtual disk. Use the plus and minus buttons to add or remove additional virtual disks.</p>
<p class="tableblock">Click <b class="button">Edit</b> to change the configuration of a virtual disk that has already been attached or created.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Instantiate VM network interfaces by picking a vNIC profile.</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Add a network interface to the virtual machine by selecting a vNIC profile from the <strong>nic1</strong> drop-down list. Use the plus and minus buttons to add or remove additional network interfaces.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Virtual_Machine_System_Settings_Explained">Virtual Machine System Settings Explained</h4>
<div id="CPU_Considerations_vm_sys_settings" class="paragraph">
<p><strong>CPU Considerations</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>For non-CPU-intensive workloads</strong>, you can run virtual machines with a total number of processor cores greater than the number of cores in the host. Doing so enables the following:</p>
<div class="ulist">
<ul>
<li>
<p>You can run a greater number of virtual machines, which reduces hardware requirements.</p>
</li>
<li>
<p>You can configure virtual machines with CPU topologies that are otherwise not possible, such as when the number of virtual cores is between the number of host cores and the number of host threads.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>For best performance, and especially for CPU-intensive workloads</strong>, you should use the same topology in the virtual machine as in the host, so the host and the virtual machine expect the same cache usage. When the host has hyperthreading enabled, QEMU treats the host&#8217;s hyperthreads as cores, so the virtual machine is not aware that it is running on a single core with multiple threads. This behavior might impact the performance of a virtual machine, because a virtual core that actually corresponds to a hyperthread in the host core might share a single cache with another hyperthread in the same host core, while the virtual machine treats it as a separate core.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following table details the options available on the <strong>System</strong> tab of the <strong>New Virtual Machine</strong> and <strong>Edit Virtual Machine</strong> windows.</p>
</div>
<table id="New_VMs_Initial_Run-226" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. Virtual Machine: System Settings</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Power cycle required?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Memory Size</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The amount of memory assigned to the virtual machine. When allocating memory, consider the processing and storage needs of the applications that are intended to run on the virtual machine.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If OS supports hotplugging, no. Otherwise, yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Maximum Memory</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum amount of memory that can be assigned to the virtual machine. Maximum guest memory is also constrained by the selected guest architecture and the cluster compatibility level.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If OS supports hotplugging, no. Otherwise, yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Total Virtual CPUs</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The processing power allocated to the virtual machine as CPU Cores. For high performance, do not assign more cores to a virtual machine than are present on the physical host.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If OS supports hotplugging, no. Otherwise, yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Virtual Sockets</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of CPU sockets for the virtual machine. Do not assign more sockets to a virtual machine than are present on the physical host.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If OS supports hotplugging, no. Otherwise, yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Cores per Virtual Socket</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of cores assigned to each virtual socket.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If OS supports hotplugging, no. Otherwise, yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Threads per Core</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of threads assigned to each core. Increasing the value enables simultaneous multi-threading (SMT). IBM POWER8 supports up to 8 threads per core. For x86 and x86_64 (Intel and AMD) CPU types, the recommended value is 1, unless you want to replicate the exact host topology, which you can do using CPU pinning. For more information, see <a href="#Pinning_CPU">Pinning CPUs</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If OS supports hotplugging, no. Otherwise, yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>BIOS Type</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies the chipset and BIOS type. Defaults to the cluster&#8217;s default BIOS type. Options are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Cluster default</strong> The BIOS type defined under General cluster settings.</p>
</li>
<li>
<p><strong>Q35 Chipset with Legacy BIOS</strong> Legacy BIOS without UEFI (Default for clusters with compatibility version 4.4)</p>
</li>
<li>
<p><strong>Q35 Chipset with UEFI BIOS</strong> BIOS with UEFI</p>
</li>
<li>
<p><strong>Q35 Chipset with SecureBoot</strong> UEFI with SecureBoot, which authenticates the digital signatures of the boot loader</p>
</li>
<li>
<p><strong>Legacy</strong> i440fx chipset with legacy BIOS</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For more information, see <a href="https://ovirt.org/documentation/administration_guide/index#About_UEFI_Q35-cluster_opt_settings">UEFI and the Q35 chipset</a> in the <em>Administration Guide</em>.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Custom Emulated Machine</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This option allows you to specify the machine type. If changed, the virtual machine will only run on hosts that support this machine type. Defaults to the cluster&#8217;s default machine type.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Custom CPU Type</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This option allows you to specify a CPU type. If changed, the virtual machine will only run on hosts that support this CPU type. Defaults to the cluster&#8217;s default CPU type.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Hardware Clock Time Offset</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This option sets the time zone offset of the guest hardware clock. For Windows, this should correspond to the time zone set in the guest. Most default Linux installations expect the hardware clock to be GMT+00:00.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Custom Compatibility Version</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The compatibility version determines which features are supported by the cluster, as well as, the values of some properties and the emulated machine type. By default, the virtual machine is configured to run in the same compatibility mode as the cluster as the default is inherited from the cluster. In some situations the default compatibility mode needs to be changed. An example of this is if the cluster has been updated to a later compatibility version but the virtual machines have not been restarted. These virtual machines can be set to use a custom compatibility mode that is older than that of the cluster. See  <a href="https://ovirt.org/documentation/administration_guide/index#Changing_the_Cluster_Compatibility_Version">Changing the Cluster Compatibility Version</a> in the <em>Administration Guide</em> for more information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Serial Number Policy</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Override the system-level and cluster-level policies for assigning a serial numbers to virtual machines. Apply a policy that is unique to this virtual machine:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>System Default</strong>: Use the system-wide defaults, which are configured in the Engine database <a href="https://ovirt.org/documentation/administration_guide/index#sect-The_Engine_Configuration_Tool">using the engine configuration tool</a> and the <code>DefaultSerialNumberPolicy</code> and <code>DefaultCustomSerialNumber</code> key names. The default value for <code>DefaultSerialNumberPolicy</code> is to use the Host ID. See <a href="https://ovirt.org/documentation/administration_guide/index#sect-Scheduling_Policies">Scheduling Policies</a> in the <em>Administration Guide</em> for more information.</p>
</li>
<li>
<p><strong>Host ID</strong>: Set this virtual machine&#8217;s serial number to the UUID of the host.</p>
</li>
<li>
<p><strong>Vm ID</strong>: Set this virtual machine&#8217;s serial number to the UUID of this virtual machine.</p>
</li>
<li>
<p><strong>Custom serial number</strong>: Set this virtual machine&#8217;s serial number to the value you specify in the following <strong>Custom Serial Number</strong> parameter.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Custom Serial Number</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specify the custom serial number to apply to this virtual machine.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Virtual_Machine_Initial_Run_settings_explained">Virtual Machine Initial Run Settings Explained</h4>
<div class="paragraph">
<p>The following table details the options available on the <strong>Initial Run</strong> tab of the <strong>New Virtual Machine</strong> and <strong>Edit Virtual Machine</strong> windows. The settings in this table are only visible if the <strong>Use Cloud-Init/Sysprep</strong> check box is selected, and certain options are only visible when either a Linux-based or Windows-based option has been selected in the <strong>Operating System</strong> list in the <strong>General</strong> tab, as outlined below.</p>
</div>
<div id="New_VMs_Initial_Run-227" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This table does not include information on whether a power cycle is required because the settings apply to the virtual machine&#8217;s <em>initial</em> run; the virtual machine is not running when you configure these settings.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 19. Virtual Machine: Initial Run Settings</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Operating System</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Use Cloud-Init/Sysprep</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux, Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This check box toggles whether Cloud-Init or Sysprep will be used to initialize the virtual machine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>VM Hostname</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux, Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The host name of the virtual machine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Domain</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Active Directory domain to which the virtual machine belongs.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Organization Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the organization to which the virtual machine belongs. This option corresponds to the text field for setting the organization name displayed when a machine running Windows is started for the first time.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Active Directory OU</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The organizational unit in the Active Directory domain to which the virtual machine belongs.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Configure Time Zone</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux, Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time zone for the virtual machine. Select this check box and select a time zone from the <strong>Time Zone</strong> list.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Admin Password</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The administrative user password for the virtual machine. Click the disclosure arrow to display the settings for this option.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Use already configured password</strong>: This check box is automatically selected after you specify an initial administrative user password. You must clear this check box to enable the <strong>Admin Password</strong> and <strong>Verify Admin Password</strong> fields and specify a new password.</p>
</li>
<li>
<p><strong>Admin Password</strong>: The administrative user password for the virtual machine. Enter the password in this text field and the <strong>Verify Admin Password</strong> text field to verify the password.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Authentication</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The authentication details for the virtual machine. Click the disclosure arrow to display the settings for this option.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Use already configured password</strong>: This check box is automatically selected after you specify an initial root password. You must clear this check box to enable the <strong>Password</strong> and <strong>Verify Password</strong> fields and specify a new password.</p>
</li>
<li>
<p><strong>Password</strong>: The root password for the virtual machine. Enter the password in this text field and the <strong>Verify Password</strong> text field to verify the password.</p>
</li>
<li>
<p><strong>SSH Authorized Keys</strong>: SSH keys to be added to the authorized keys file of the virtual machine. You can specify multiple SSH keys by entering each SSH key on a new line.</p>
</li>
<li>
<p><strong>Regenerate SSH Keys</strong>: Regenerates SSH keys for the virtual machine.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Custom Locale</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Custom locale options for the virtual machine. Locales must be in a format such as <code>en-US</code>. Click the disclosure arrow to display the settings for this option.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Input Locale</strong>: The locale for user input.</p>
</li>
<li>
<p><strong>UI Language</strong>: The language used for user interface elements such as buttons and menus.</p>
</li>
<li>
<p><strong>System Locale</strong>: The locale for the overall system.</p>
</li>
<li>
<p><strong>User Locale</strong>: The locale for users.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Networks</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Network-related settings for the virtual machine. Click the disclosure arrow to display the settings for this option.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>DNS Servers</strong>: The DNS servers to be used by the virtual machine.</p>
</li>
<li>
<p><strong>DNS Search Domains</strong>: The DNS search domains to be used by the virtual machine.</p>
</li>
<li>
<p><strong>Network</strong>: Configures network interfaces for the virtual machine. Select this check box and click <strong>+</strong> or <strong>-</strong> to add or remove network interfaces to or from the virtual machine. When you click <strong>+</strong>, a set of fields becomes visible that can specify whether to use DHCP, and configure an IP address, netmask, and gateway, and specify whether the network interface will start on boot.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Custom Script</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom scripts that will be run on the virtual machine when it starts. The scripts entered in this field are custom YAML sections that are added to those produced by the Engine, and allow you to automate tasks such as creating users and files, configuring <code>yum</code> repositories and running commands. For more information on the format of scripts that can be entered in this field, see the <a href="http://cloudinit.readthedocs.org/en/latest/topics/examples.html#yaml-examples">Custom Script</a> documentation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Sysprep</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Windows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A custom Sysprep definition. The definition must be in the format of a complete unattended installation answer file. You can copy and paste the default answer files in the <strong>/usr/share/ovirt-engine/conf/sysprep/</strong> directory on the machine on which the oVirt Engine is installed and alter the fields as required. See <a href="#chap-Templates">Templates</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Ignition 2.3.0</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Red Hat Enterprise Linux CoreOS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When Red Hat Enterprise Linux CoreOS is selected as Operating System, this check box toggles whether Ignition will be used to initialize the virtual machine.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Virtual_Machine_Console_settings_explained">Virtual Machine Console Settings Explained</h4>
<div class="paragraph">
<p>The following table details the options available on the <strong>Console</strong> tab of the <strong>New Virtual Machine</strong> and <strong>Edit Virtual Machine</strong> windows.</p>
</div>
<table id="New_VMs_Console" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 20. Virtual Machine: Console Settings</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Power cycle required?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Graphical Console Section</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A group of settings.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Headless Mode</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Select this check box if you do not a require a graphical console for the virtual machine.</p>
</div>
<div class="paragraph">
<p>When selected, all other fields in the <strong>Graphical Console</strong> section are disabled. In the VM Portal, the <strong>Console</strong> icon in the virtual machine&#8217;s details view is also disabled.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>See <a href="#Configuring_Headless_Machines">Configuring Headless Virtual Machines</a> for more details and prerequisites for using headless mode.</p>
</div>
</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Video Type</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the graphics device. <strong>QXL</strong> is the default and supports both graphic protocols. <strong>VGA</strong> supports only the VNC protocol.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Graphics protocol</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines which display protocol to use. <strong>SPICE</strong> is the default protocol. <strong>VNC</strong> is an alternative option. To allow both protocols select <strong>SPICE + VNC</strong>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>VNC Keyboard Layout</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines the keyboard layout for the virtual machine. This option is only available when using the VNC protocol.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>USB enabled</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines SPICE USB redirection. This check box is not selected by default. This option is only available for virtual machines using the SPICE protocol:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Disabled (check box is cleared) - USB controller devices are added according to the <code>devices.usb.controller</code> value in the <strong>osinfo-defaults.properties</strong> configuration file. The default for all x86 and x86_64 operating systems is <code>piix3-uhci</code>. For ppc64 systems, the default is <code>nec-xhci</code>.</p>
</li>
<li>
<p>Enabled (check box is selected) - Enables native KVM/SPICE USB redirection for Linux and Windows virtual machines. Virtual machines do not require any in-guest agents or drivers for native USB.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Console Disconnect Action</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines what happens when the console is disconnected. This is only relevant with SPICE and VNC console connections. This setting can be changed while the virtual machine is running but will not take effect until a new console connection is established. Select either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>No action</strong> - No action is taken.</p>
</li>
<li>
<p><strong>Lock screen</strong> - This is the default option. For all Linux machines and for Windows desktops this locks the currently active user session. For Windows servers, this locks the desktop and the currently active user.</p>
</li>
<li>
<p><strong>Logout user</strong> - For all Linux machines and Windows desktops, this logs out the currently active user session. For Windows servers, the desktop and the currently active user are logged out.</p>
</li>
<li>
<p><strong>Shutdown virtual machine</strong> - Initiates a graceful virtual machine shutdown.</p>
</li>
<li>
<p><strong>Reboot virtual machine</strong> - Initiates a graceful virtual machine reboot.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Monitors</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of monitors for the virtual machine. This option is only available for virtual desktops using the SPICE display protocol. You can choose <strong>1</strong>, <strong>2</strong> or <strong>4</strong>. Note that multiple monitors are not supported for Windows systems with WDDMDoD drivers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Smartcard Enabled</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Smart cards are an external hardware security feature, most commonly seen in credit cards, but also used by many businesses as authentication tokens. Smart cards can be used to protect oVirt virtual machines. Select or clear the check box to activate and deactivate Smart card authentication for individual virtual machines.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Single Sign On method</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Enabling Single Sign On allows users to sign into the guest operating system when connecting to a virtual machine from the VM Portal using the Guest Agent.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Disable Single Sign On</strong> - Select this option if you do not want the Guest Agent to attempt to sign into the virtual machine.</p>
</li>
<li>
<p><strong>Use Guest Agent</strong> - Enables Single Sign On to allow the Guest Agent to sign you into the virtual machine.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If you select Use Guest Agent, no. Otherwise, yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Disable strict user checking</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Click the <strong>Advanced Parameters</strong> arrow and select the check box to use this option. With this option selected, the virtual machine does not need to be rebooted when a different user connects to it.</p>
<p class="tableblock">By default, strict checking is enabled so that only one user can connect to the console of a virtual machine. No other user is able to open a console to the same virtual machine until it has been rebooted. The exception is that a <strong>SuperUser</strong> can connect at any time and replace a existing connection. When a <strong>SuperUser</strong> has connected, no normal user can connect again until the virtual machine is rebooted.</p>
<p class="tableblock">Disable strict checking with caution, because you can expose the previous user&#8217;s session to the new user.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Soundcard Enabled</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A sound card device is not necessary for all virtual machine use cases. If it is for yours, enable a sound card here.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Enable SPICE file transfer</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines whether a user is able to drag and drop files from an external host into the virtual machine&#8217;s SPICE console. This option is only available for virtual machines using the SPICE protocol. This check box is selected by default.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Enable SPICE clipboard copy and paste</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines whether a user is able to copy and paste content from an external host into the virtual machine&#8217;s SPICE console. This option is only available for virtual machines using the SPICE protocol. This check box is selected by default.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Serial Console Section</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A group of settings.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Enable VirtIO serial console</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The VirtIO serial console is emulated through VirtIO channels, using SSH and key pairs, and allows you to access a virtual machine&#8217;s serial console directly from a client machine&#8217;s command line, instead of opening a console from the Administration Portal or the VM Portal. The serial console requires direct access to the Engine, since the Engine acts as a proxy for the connection, provides information about virtual machine placement, and stores the authentication keys. Select the check box to enable the VirtIO console on the virtual machine. Requires a firewall rule. See <a href="#Opening_a_Serial_Console_to_a_Virtual_Machine">Opening a Serial Console to a Virtual Machine</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Virtual_Machine_Host_settings_explained">Virtual Machine Host Settings Explained</h4>
<div class="paragraph">
<p>The following table details the options available on the <strong>Host</strong> tab of the <strong>New Virtual Machine</strong> and <strong>Edit Virtual Machine</strong> windows.</p>
</div>
<table id="New_VMs_Host" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 21. Virtual Machine: Host Settings</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Sub-element</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Power cycle required?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Start Running On</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines the preferred host on which the virtual machine is to run. Select either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Any Host in Cluster</strong> - The virtual machine can start and run on any available host in the cluster.</p>
</li>
<li>
<p><strong>Specific Host(s)</strong> - The virtual machine will start running on a particular host in the cluster. However, the Engine or an administrator can migrate the virtual machine to a different host in the cluster depending on the migration and high-availability settings of the virtual machine. Select the specific host or group of hosts from the list of available hosts.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No. The virtual machine can migrate to that host while running.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CPU options</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Pass-Through Host CPU</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When selected, allows virtual machines to use the host&#8217;s CPU flags.
When selected, <strong>Migration Options</strong> is set to <strong>Allow manual migration only</strong>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Migrate only to hosts with the same TSC frequency</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When selected, this virtual machine can only be migrated to a host with the same TSC frequency. This option is only valid for High Performance virtual machines.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Migration Options</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Migration mode</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines options to run and migrate the virtual machine. If the options here are not used, the virtual machine will run or migrate according to its cluster&#8217;s policy.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Allow manual and automatic migration</strong> - The virtual machine can be automatically migrated from one host to another in accordance with the status of the environment, or manually by an administrator.</p>
</li>
<li>
<p><strong>Allow manual migration only</strong> - The virtual machine can only be migrated from one host to another manually by an administrator.</p>
</li>
<li>
<p><strong>Do not allow migration</strong> - The virtual machine cannot be migrated, either automatically or manually.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Migration policy</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines the migration convergence policy. If the check box is left unselected, the host determines the policy.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Cluster default (Minimal downtime)</strong> - Overrides in <code>vdsm.conf</code> are still applied. The guest agent hook mechanism is disabled.</p>
</li>
<li>
<p><strong>Minimal downtime</strong> - Allows the virtual machine to migrate in typical situations. Virtual machines should not experience any significant downtime. The migration will be aborted if virtual machine migration does not converge after a long time (dependent on QEMU iterations, with a maximum of 500 milliseconds). The guest agent hook mechanism is enabled.</p>
</li>
<li>
<p><strong>Post-copy migration</strong> - When used, post-copy migration pauses the migrating virtual machine vCPUs on the source host, transfers only a minimum of memory pages, activates the virtual machine vCPUs on the destination host, and transfers the remaining memory pages while the virtual machine is running on the destination.</p>
<div class="paragraph">
<p>The post-copy policy first tries pre-copy to verify whether convergence can occur. The migration switches to post-copy if the virtual machine migration does not converge after a long time.</p>
</div>
<div class="paragraph">
<p>This significantly reduces the downtime of the migrated virtual machine, and also guarantees that the migration finishes regardless of how rapidly the memory pages of the source virtual machine change. It is optimal for migrating virtual machines in heavy continuous use, which would not be possible to migrate with standard pre-copy migration.</p>
</div>
<div class="paragraph">
<p>The disadvantage of this policy is that in the post-copy phase, the virtual machine may slow down significantly as the missing parts of memory are transferred between the hosts.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If the network connection breaks prior to the completion of the post-copy process, the Engine pauses and then kills the running virtual machine. Do not use post-copy migration if the virtual machine availability is critical or if the migration network is unstable.</p>
</div>
</td>
</tr>
</table>
</div>
</li>
<li>
<p><strong>Suspend workload if needed</strong> - Allows the virtual machine to migrate in most situations, including when the virtual machine is running a heavy workload. Because of this, virtual machines may experience a more significant downtime than with some other settings. The migration may still be aborted for extreme workloads. The guest agent hook mechanism is enabled.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Enable migration encryption</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Allows the virtual machine to be encrypted during migration.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Cluster default (Don&#8217;t encrypt)</strong></p>
</li>
<li>
<p><strong>Encrypt</strong></p>
</li>
<li>
<p><strong>Don&#8217;t encrypt</strong></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Configure NUMA</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>NUMA Node Count</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of virtual NUMA nodes available in a host that can be assigned to the virtual machine.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>NUMA Pinning</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Opens the <strong>NUMA Topology</strong> window. This window shows the host&#8217;s total CPUs, memory, and NUMA nodes, and the virtual machine&#8217;s virtual NUMA nodes.
You can manually pin virtual NUMA nodes to host NUMA nodes by clicking and dragging each vNUMA from the box on the right to a NUMA node on the left.</p>
<p class="tableblock">You can also set <strong>Tune Mode</strong> for memory allocation:</p>
<p class="tableblock"><strong>Strict</strong> - Memory allocation will fail if the memory cannot be allocated on the target node.</p>
<p class="tableblock"><strong>Preferred</strong> - Memory is allocated from a single preferred node. If sufficient memory is not available, memory can be allocated from other nodes.</p>
<p class="tableblock"><strong>Interleave</strong> - Memory is allocated across nodes in a round-robin algorithm.</p>
<p class="tableblock">If you define NUMA pinning, <strong>Migration Options</strong> is set to <strong>Allow manual migration only</strong>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Auto Pinning Policy</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Allows you to set NUMA Pinning automatically.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Select <strong>None</strong> to make no changes to the virtual machine.</p>
</li>
<li>
<p>Select <strong>Resize and Pin</strong> to maximize the CPU topology and generate the CPU pinning and NUMA pinning configurations.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Virtual_Machine_High_Availability_settings_explained">Virtual Machine High Availability Settings Explained</h4>
<div class="paragraph">
<p>The following table details the options available on the <strong>High Availability</strong> tab of the <strong>New Virtual Machine</strong> and <strong>Edit Virtual Machine</strong> windows.</p>
</div>
<table id="New_VMs_HA" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 22. Virtual Machine: High Availability Settings</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Power cycle required?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Highly Available</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select this check box if the virtual machine is to be highly available. For example, in cases of host maintenance, all virtual machines are automatically live migrated to another host. If the host crashes and is in a non-responsive state, only virtual machines with high availability are restarted on another host. If the host is manually shut down by the system administrator, the virtual machine is not automatically live migrated to another host.</p>
<p class="tableblock">Note that this option is unavailable for virtual machines defined as <strong>Server</strong> or <strong>Desktop</strong> if the <strong>Migration Options</strong> setting in the <strong>Hosts</strong> tab is set to <strong>Do not allow migration</strong>. For a virtual machine to be highly available, it must be possible for the Engine to migrate the virtual machine to other available hosts as necessary.</p>
<p class="tableblock">However, for virtual machines defined as <strong>High Performance</strong>, you can define high availability regardless of the <strong>Migration Options</strong> setting.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Target Storage Domain for VM Lease</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Select the storage domain to hold a virtual machine lease, or select <strong>No VM Lease</strong> to disable the functionality. When a storage domain is selected, it will hold a virtual machine lease on a special volume that allows the virtual machine to be started on another host if the original host loses power or becomes unresponsive.</p>
</div>
<div class="paragraph">
<p>This functionality is only available on storage domain V4 or later.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you define a lease, the only <strong>Resume Behavior</strong> available is KILL.</p>
</div>
</td>
</tr>
</table>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Resume Behavior</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Defines the desired behavior of a virtual machine that is paused due to storage I/O errors, once a connection with the storage is reestablished. You can define the desired resume behavior even if the virtual machine is not highly available.</p>
</div>
<div class="paragraph">
<p>The following options are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>AUTO_RESUME</strong> - The virtual machine is automatically resumed, without requiring user intervention. This is recommended for virtual machines that are not highly available and that do not require user intervention after being in the paused state.</p>
</li>
<li>
<p><strong>LEAVE_PAUSED</strong> - The virtual machine remains in pause mode until it is manually resumed or restarted.</p>
</li>
<li>
<p><strong>KILL</strong> - The virtual machine is automatically resumed if the I/O error is remedied within 80 seconds. However, if more than 80 seconds pass, the virtual machine is ungracefully shut down. This is recommended for highly available virtual machines, to allow the Engine to restart them on another host that is not experiencing the storage I/O error.</p>
<div class="paragraph">
<p><strong>KILL</strong> is the only option available when using virtual machine leases.</p>
</div>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Priority for Run/Migration queue</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sets the priority level for the virtual machine to be migrated or restarted on another host.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Watchdog</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Allows users to attach a watchdog card to a virtual machine. A watchdog is a timer that is used to automatically detect and recover from failures. Once set, a watchdog timer continually counts down to zero while the system is in operation, and is periodically restarted by the system to prevent it from reaching zero. If the timer reaches zero, it signifies that the system has been unable to reset the timer and is therefore experiencing a failure. Corrective actions are then taken to address the failure. This functionality is especially useful for servers that demand high availability.</p>
</div>
<div class="paragraph">
<p><strong>Watchdog Model</strong>: The model of watchdog card to assign to the virtual machine. At current, the only supported model is <strong>i6300esb</strong>.</p>
</div>
<div class="paragraph">
<p><strong>Watchdog Action</strong>: The action to take if the watchdog timer reaches zero. The following actions are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>none</strong> - No action is taken. However, the watchdog event is recorded in the audit log.</p>
</li>
<li>
<p><strong>reset</strong> - The virtual machine is reset and the Engine is notified of the reset action.</p>
</li>
<li>
<p><strong>poweroff</strong> - The virtual machine is immediately shut down.</p>
</li>
<li>
<p><strong>dump</strong> - A dump is performed and the virtual machine is paused.</p>
</li>
<li>
<p><strong>pause</strong> - The virtual machine is paused, and can be resumed by users.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Virtual_Machine_Resource_Allocation_settings_explained">Virtual Machine Resource Allocation Settings Explained</h4>
<div class="paragraph">
<p>The following table details the options available on the <strong>Resource Allocation</strong> tab of the <strong>New Virtual Machine</strong> and <strong>Edit Virtual Machine</strong> windows.</p>
</div>
<table id="New_VMs_Resource" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 23. Virtual Machine: Resource Allocation Settings</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Sub-element</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Power cycle required?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CPU Allocation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CPU Profile</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The CPU profile assigned to the virtual machine. CPU profiles define the maximum amount of processing capability a virtual machine can access on the host on which it runs, expressed as a percent of the total processing capability available to that host. CPU profiles are defined for a cluster, based on quality of service entries created for data centers.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CPU Shares</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Allows users to set the level of CPU resources a virtual machine can demand relative to other virtual machines.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Low</strong> - 512</p>
</li>
<li>
<p><strong>Medium</strong> - 1024</p>
</li>
<li>
<p><strong>High</strong> - 2048</p>
</li>
<li>
<p><strong>Custom</strong> - A custom level of CPU shares defined by the user.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CPU Pinning topology</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Enables the virtual machine&#8217;s virtual CPU (vCPU) to run on a specific physical CPU (pCPU) in a specific host. The syntax of CPU pinning is <code>v#p[_v#p]</code>, for example:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>0#0</code> - Pins vCPU 0 to pCPU 0.</p>
</li>
<li>
<p><code>0#0_1#3</code> - Pins vCPU 0 to pCPU 0, and pins vCPU 1 to pCPU 3.</p>
</li>
<li>
<p><code>1#1-4,^2</code> - Pins vCPU 1 to one of the pCPUs in the range of 1 to 4, excluding pCPU 2.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <strong>CPU Pinning Topology</strong> is populated automatically when automatic NUMA pinning is activated.</p>
</div>
<div class="paragraph">
<p>In order to pin a virtual machine to a host, you must also select the following on the <strong>Host</strong> tab:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Start Running On:</strong> <strong>Specific</strong></p>
</li>
<li>
<p><strong>Pass-Through Host CPU</strong></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If CPU pinning is set and you change <strong>Start Running On: Specific</strong> a <strong>CPU pinning topology will be lost</strong> window appears when you click <b class="button">OK</b>.</p>
</div>
<div class="paragraph">
<p>When defined, <strong>Migration Options</strong> in the <strong>Hosts</strong> tab is set to <strong>Allow manual migration only</strong>.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Memory Allocation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Physical Memory Guaranteed</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The amount of physical memory guaranteed for this virtual machine. Should be any number between 0 and the defined memory for this virtual machine.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If lowered, yes. Otherwise, no.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Memory Balloon Device Enabled</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables the memory balloon device for this virtual machine. Enable this setting to allow memory overcommitment in a cluster. Enable this setting for applications that allocate large amounts of memory suddenly but set the guaranteed memory to the same value as the defined memory.Use ballooning for applications and loads that slowly consume memory, occasionally release memory, or stay dormant for long periods of time, such as virtual desktops. See <a href="https://ovirt.org/documentation/administration_guide#Cluster_Optimization_Settings_Explained">Optimization Settings Explained</a> in the <em>Administration Guide</em> for more information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Trusted Platform Module</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>TPM Device Enabled</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables the addition of an emulated Trusted Platform Module (TPM) device. Select this check box to add an emulated Trusted Platform Module device to a virtual machine. TPM devices can only be used on x86_64 machines with UEFI firmware and PowerPC machines with pSeries firmware installed. See <a href="#Adding_TPM_devices">Adding Trusted Platform Module devices</a> for more information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>IO Threads</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>IO Threads Enabled</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables IO threads. Select this check box to improve the speed of disks that have a VirtIO interface by pinning them to a thread separate from the virtual machine&#8217;s other functions. Improved disk performance increases a virtual machine&#8217;s overall performance. Disks with VirtIO interfaces are pinned to an IO thread using a round-robin algorithm.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Queues</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Multi Queues Enabled</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables multiple queues. This check box is selected by default. It creates up to four queues per vNIC, depending on how many vCPUs are available.</p>
<p class="tableblock">It is possible to define a different number of queues per vNIC by creating a custom property as follows:</p>
<p class="tableblock"><code>engine-config -s "CustomDeviceProperties={type=interface;prop={<em>other-nic-properties</em>;queues=[1-9][0-9]*}}"</code></p>
<p class="tableblock">where <em>other-nic-properties</em> is a semicolon-separated list of pre-existing NIC custom properties.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>VirtIO-SCSI Enabled</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows users to enable or disable the use of VirtIO-SCSI on the virtual machines.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>VirtIO-SCSI Multi Queues Enabled</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <strong>VirtIO-SCSI Multi Queues Enabled</strong> option is only available when <strong>VirtIO-SCSI Enabled</strong> is selected. Select this check box to enable multiple queues in the VirtIO-SCSI driver. This setting can improve I/O throughput when multiple threads within the virtual machine access the virtual disks. It creates up to four queues per VirtIO-SCSI controller, depending on how many disks are connected to the controller and how many vCPUs are available.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Storage Allocation</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <strong>Storage Allocation</strong> option is only available when the virtual machine is created from a template.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Thin</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provides optimized usage of storage capacity. Disk space is allocated only as it is required. When selected, the format of the disks will be marked as QCOW2 and you will not be able to change it.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Clone</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Optimized for the speed of guest read and write operations. All disk space requested in the template is allocated at the time of the clone operation. Possible disk formats are <strong>QCOW2</strong> or <strong>Raw</strong>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Disk Allocation</strong></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The <strong>Disk Allocation</strong> option is only available when you are creating a virtual machine from a template.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Alias</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An alias for the virtual disk. By default, the alias is set to the same value as that of the template.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Virtual Size</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The total amount of disk space that the virtual machine based on the template can use. This value cannot be edited, and is provided for reference only.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Format</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The format of the virtual disk. The available options are <strong>QCOW2</strong> and <strong>Raw</strong>. When <strong>Storage Allocation</strong> is <strong>Thin</strong>, the disk format is <strong>QCOW2</strong>. When Storage Allocation is <strong>Clone</strong>, select <strong>QCOW2</strong> or <strong>Raw</strong>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Target</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The storage domain on which the virtual disk is stored. By default, the storage domain is set to the same value as that of the template.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Disk Profile</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The disk profile to assign to the virtual disk. Disk profiles are created based on storage profiles defined in the data centers. For more information, see <a href="https://ovirt.org/documentation/administration_guide/index#Creating_a_Disk_Profile">Creating a Disk Profile</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Not applicable.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Virtual_Machine_Boot_Options_settings_explained">Virtual Machine Boot Options Settings Explained</h4>
<div class="paragraph">
<p>The following table details the options available on the <strong>Boot Options</strong> tab of the <strong>New Virtual Machine</strong> and <strong>Edit Virtual Machine</strong> windows</p>
</div>
<table id="New_VMs_Boot_Options" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 24. Virtual Machine: Boot Options Settings</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Power cycle required?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>First Device</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>After installing a new virtual machine, the new virtual machine must go into Boot mode before powering up. Select the first device that the virtual machine must try to boot:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Hard Disk</strong></p>
</li>
<li>
<p><strong>CD-ROM</strong></p>
</li>
<li>
<p><strong>Network (PXE)</strong></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Second Device</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select the second device for the virtual machine to use to boot if the first device is not available. The first device selected in the previous option does not appear in the options.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Attach CD</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If you have selected <strong>CD-ROM</strong> as a boot device, select this check box and select a CD-ROM image from the drop-down menu. The images must be available in the ISO domain.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Enable menu to select boot device</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables a menu to select the boot device. After the virtual machine starts and connects to the console, but before the virtual machine starts booting, a menu displays that allows you to select the boot device. This option should be enabled before the initial boot to allow you to select the required installation media.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Virtual_Machine_Random_Generator_Settings_Explained">Virtual Machine Random Generator Settings Explained</h4>
<div class="paragraph">
<p>The following table details the options available on the <strong>Random Generator</strong> tab of the <strong>New Virtual Machine</strong> and <strong>Edit Virtual Machine</strong> windows.</p>
</div>
<table id="New_VMs_Random_Generator" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 25. Virtual Machine: Random Generator Settings</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Power cycle required?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Random Generator enabled</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Selecting this check box enables a paravirtualized Random Number Generator PCI device (virtio-rng). This device allows entropy to be passed from the host to the virtual machine in order to generate a more sophisticated random number. Note that this check box can only be selected if the RNG device exists on the host and is enabled in the host&#8217;s cluster.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Period duration (ms)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies the duration of the RNG&#8217;s "full cycle" or "full period" in milliseconds. If omitted, the libvirt default of 1000 milliseconds (1 second) is used. If this field is filled,
<strong>Bytes per period</strong> must be filled also.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Bytes per period</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies how many bytes are permitted to be consumed per period.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Device source:</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The source of the random number generator. This is automatically selected depending on the source supported by the host&#8217;s cluster.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>/dev/urandom source</strong> - The Linux-provided random number generator.</p>
</li>
<li>
<p><strong>/dev/hwrng source</strong> - An external hardware generator.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Virtual_Machine_Custom_Properties_settings_explained">Virtual Machine Custom Properties Settings Explained</h4>
<div class="paragraph">
<p>The following table details the options available on the <strong>Custom Properties</strong> tab of the <strong>New Virtual Machine</strong> and <strong>Edit Virtual Machine</strong> windows.</p>
</div>
<table id="New_VMs_Custom_Properties" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 26. Virtual Machine Custom Properties Settings</caption>
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 16.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Recommendations and Limitations</th>
<th class="tableblock halign-left valign-top">Power cycle required?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sndbuf</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter the size of the buffer for sending the virtual machine&#8217;s outgoing data over the socket. Default value is 0.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>hugepages</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter the huge page size in KB.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="ulist">
<ul>
<li>
<p>Set the huge page size to the largest size supported by the pinned host.</p>
</li>
<li>
<p>The recommended size for x86_64 is 1 GB.</p>
</li>
<li>
<p>The virtual machines huge page size must be the same size as the pinned hosts huge page size.</p>
</li>
<li>
<p>The virtual machines memory size must fit into the selected size of the pinned hosts free huge pages. The NUMA node size must be a multiple of the huge pages selected size.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>vhost</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Disables vhost-net, which is the kernel-based virtio network driver on virtual network interface cards attached to the virtual machine. To disable vhost, the format for this property is <code><em>LogicalNetworkName</em>: false</code>.</p>
</div>
<div class="paragraph">
<p>This will explicitly start the virtual machine without the vhost-net setting on the virtual NIC attached to <em>LogicalNetworkName</em>.</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vhost-net provides better performance than virtio-net, and if it is present, it is enabled on all virtual machine NICs by default. Disabling this property makes it easier to isolate and diagnose performance issues, or to debug vhost-net errors; for example, if migration fails for virtual machines on which vhost does not exist.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>sap_agent</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables SAP monitoring on the virtual machine. Set to <strong>true</strong> or <strong>false</strong>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>mdev_type</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enter the name of the mediated device, my_GPU, supported by the hosts kernel to enable the host to work with the device.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>viodiskcache</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Caching mode for the virtio disk. <strong>writethrough</strong> writes data to the cache and the disk in parallel, <strong>writeback</strong> does not copy modifications from the cache to the disk, and <strong>none</strong> disables caching. See <a href="https://access.redhat.com/solutions/2361311" class="bare">https://access.redhat.com/solutions/2361311</a> for more information about the limitations of the <code>viodiskcache</code> custom property.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">In order to ensure data integrity in the event of a fault in storage, in the network, or in a host during migration, do not migrate virtual machines with viodiskcache enabled, unless virtual machine clustering or application-level clustering is also enabled.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>scsi_hostdev</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Optionally, if you add a SCSI host device to a virtual machine, you can specify the optimal SCSI host device driver. For details, see <a href="https://ovirt.org/documentation/virtual_machine_management_guide/index#Adding_Host_Devices_to_a_Virtual_Machine">Adding Host Devices to a Virtual Machine</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>scsi_generic</strong>: (Default) Enables the guest operating system to access OS-supported SCSI host devices attached to the host. Use this driver for SCSI media changers that require raw access, such as tape or CD changers.</p>
</li>
<li>
<p><strong>scsi_block</strong>: Similar to <strong>scsi_generic</strong> but better speed and reliability. Use for SCSI disk devices. If trim or discard for the underlying device is desired, and its a hard disk, use this driver.</p>
</li>
<li>
<p><strong>scsi_hd</strong>: Provides performance with lowered overhead. Supports large numbers of devices. Uses the standard SCSI device naming scheme. Can be used with aio-native. Use this driver for high-performance SSDs.</p>
</li>
<li>
<p><strong>virtio_blk_pci</strong>: Provides the highest performance without the SCSI overhead. Supports identifying devices by their serial numbers.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If you are not sure, try <strong>scsi_hd</strong>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Increasing the value of the sndbuf custom property results in increased occurrences of communication failure between hosts and unresponsive virtual machines.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="Virtual_Machine_Icon_Settings_Explained">Virtual Machine Icon Settings Explained</h4>
<div class="paragraph">
<p>You can add custom icons to virtual machines and templates. Custom icons can help to differentiate virtual machines in the VM Portal. The following table details the options available on the <strong>Icon</strong> tab of the <strong>New Virtual Machine</strong> and <strong>Edit Virtual Machine</strong> windows.</p>
</div>
<div id="New_VMs_Icon" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This table does not include information on whether a power cycle is required because these settings apply to the virtual machine&#8217;s <em>appearance in the Administration portal</em>, not to its configuration.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 27. Virtual Machine: Icon Settings</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Button Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Upload</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Click this button to select a custom image to use as the virtual machine&#8217;s icon. The following limitations apply:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Supported formats: jpg, png, gif</p>
</li>
<li>
<p>Maximum size: 24 KB</p>
</li>
<li>
<p>Maximum dimensions: 150px width, 120px height</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Power cycle required?</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Use default</strong></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="Virtual_Machine_Satellite_settings_explained">Virtual Machine Foreman/Satellite Settings Explained</h4>
<div class="paragraph">
<p>The following table details the options available on the <strong>Foreman/Satellite</strong> tab of the <strong>New Virtual Machine</strong> and <strong>Edit Virtual Machine</strong> windows</p>
</div>
<table id="New_VMs_Satellite_Options" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 28. Virtual Machine:Foreman/Satellite Settings</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Power cycle required?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Provider</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the virtual machine is running Enterprise Linux and the system is configured to work with a Satellite server, select the name of the Satellite from the list. This enables you to use Satellite&#8217;s content management feature to display the relevant Errata for this virtual machine. See <a href="#Configuring_Satellite_Errata">Configuring Satellite errata viewing for a virtual machine</a> for more details.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="Virtual_Machine_Run_Once_settings_explained">Explanation of settings in the Run Once window</h3>
<div class="paragraph">
<p>The <strong>Run Once</strong> window defines one-off boot options for a virtual machine. For persistent boot options, use the <strong>Boot Options</strong> tab in the <strong>New Virtual Machine</strong> window. The <strong>Run Once</strong> window contains multiple sections that can be configured.</p>
</div>
<div class="paragraph">
<p>The standalone <strong>Rollback this configuration during reboots</strong> check box specifies whether reboots (initiated by the Engine, or from within the guest) will be warm (soft) or cold (hard). Select this check box to configure a cold reboot that restarts the virtual machine with regular (non-<strong>Run Once</strong>) configuration. Clear this check box to configure a warm reboot that retains the virtual machine&#8217;s <strong>Run Once</strong> configuration.</p>
</div>
<div class="paragraph">
<p>The <strong>Boot Options</strong> section defines the virtual machine&#8217;s boot sequence, running options, and source images for installing the operating system and required drivers.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The following tables do not include information on whether a power cycle is required because these <em>one-off boot options</em> apply only when you reboot the virtual machine.
</td>
</tr>
</table>
</div>
<table id="Boot_Options_Fields" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 29. Boot Options Section</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Attach CD</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attaches an ISO image to the virtual machine. Use this option to install the virtual machine&#8217;s operating system and applications. The CD image must reside in the ISO domain.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Attach Windows guest tools CD</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attaches a secondary virtual CD-ROM to the virtual machine with the virtio-win ISO image.
 Use this option to install Windows drivers. For information on installing the image, see <a href="https://ovirt.org/documentation/administration_guide/index#Uploading_the_VirtIO_and_Guest_Tool_Image_Files_to_an_ISO_Storage_Domain">Uploading the VirtIO and Guest Tool Image Files to a Storage Domain</a> in the <em>Administration Guide</em>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Enable menu to select boot device</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables a menu to select the boot device. After the virtual machine starts and connects to the console, but before the virtual machine starts booting, a menu displays that allows you to select the boot device. This option should be enabled before the initial boot to allow you to select the required installation media.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Start in Pause Mode</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Starts and then pauses the virtual machine to enable connection to the console. Suitable for virtual machines in remote locations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Predefined Boot Sequence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines the order in which the boot devices are used to boot the virtual machine. Select <strong>Hard Disk</strong>, <strong>CD-ROM</strong>, or <strong>Network (PXE)</strong>, and use <strong>Up</strong> and <strong>Down</strong> to move the option up or down in the list.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Run Stateless</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Deletes all data and configuration changes to the virtual machine upon shutdown. This option is only available if a virtual disk is attached to the virtual machine.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <strong>Linux Boot Options</strong> section contains fields to boot a Linux kernel directly instead of through the BIOS bootloader.</p>
</div>
<table id="Linux_Boot_Options_Fields" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 30. Linux Boot Options Section</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>kernel path</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A fully qualified path to a kernel image to boot the virtual machine. The kernel image must be stored on either the ISO domain (path name in the format of <strong>iso://path-to-image</strong>) or on the host&#8217;s local storage domain (path name in the format of <strong>/data/images</strong>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>initrd path</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A fully qualified path to a ramdisk image to be used with the previously specified kernel. The ramdisk image must be stored on the ISO domain (path name in the format of <strong>iso://path-to-image</strong>) or on the host&#8217;s local storage domain (path name in the format of <strong>/data/images</strong>).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>kernel parameters</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kernel command line parameter strings to be used with the defined kernel on boot.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <strong>Initial Run</strong> section is used to specify whether to use Cloud-Init or Sysprep to initialize the virtual machine. For Linux-based virtual machines, you must select the <strong>Use Cloud-Init</strong> check box in the <strong>Initial Run</strong> tab to view the available options. For Windows-based virtual machines, you must attach the <code>[sysprep]</code> floppy by selecting the <strong>Attach Floppy</strong> check box in the <strong>Boot Options</strong> tab and selecting the floppy from the list.</p>
</div>
<div class="paragraph">
<p>The options that are available in the <strong>Initial Run</strong> section differ depending on the operating system that the virtual machine is based on.</p>
</div>
<table id="Initial_Run_Fields_Linux" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 31. Initial Run Section (Linux-based Virtual Machines)</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>VM Hostname</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The host name of the virtual machine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Configure Time Zone</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time zone for the virtual machine. Select this check box and select a time zone from the <strong>Time Zone</strong> list.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Authentication</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The authentication details for the virtual machine. Click the disclosure arrow to display the settings for this option.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="menuseq"><b class="menu">Authentication</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">User Name</b></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Creates a new user account on the virtual machine. If this field is not filled in, the default user is <code>root</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="menuseq"><b class="menu">Authentication</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Use already configured password</b></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This check box is automatically selected after you specify an initial root password. You must clear this check box to enable the <strong>Password</strong> and <strong>Verify Password</strong> fields and specify a new password.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="menuseq"><b class="menu">Authentication</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Password</b></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The root password for the virtual machine. Enter the password in this text field and the <strong>Verify Password</strong> text field to verify the password.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="menuseq"><b class="menu">Authentication</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">SSH Authorized Keys</b></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSH keys to be added to the authorized keys file of the virtual machine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="menuseq"><b class="menu">Authentication</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Regenerate SSH Keys</b></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Regenerates SSH keys for the virtual machine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Networks</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Network-related settings for the virtual machine. Click the disclosure arrow to display the settings for this option.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="menuseq"><b class="menu">Networks</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">DNS Servers</b></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The DNS servers to be used by the virtual machine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="menuseq"><b class="menu">Networks</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">DNS Search Domains</b></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The DNS search domains to be used by the virtual machine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="menuseq"><b class="menu">Networks</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Network</b></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configures network interfaces for the virtual machine. Select this check box and click <strong>+</strong> or <strong>-</strong> to add or remove network interfaces to or from the virtual machine. When you click <strong>+</strong>, a set of fields becomes visible that can specify whether to use DHCP, and configure an IP address, netmask, and gateway, and specify whether the network interface will start on boot.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Custom Script</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom scripts that will be run on the virtual machine when it starts. The scripts entered in this field are custom YAML sections that are added to those produced by the Engine, and allow you to automate tasks such as creating users and files, configuring <code>yum</code> repositories and running commands. For more information on the format of scripts that can be entered in this field, see the <a href="http://cloudinit.readthedocs.io/en/latest/topics/examples.html#yaml-examples">Custom Script</a> documentation.</p></td>
</tr>
</tbody>
</table>
<table id="Initial_Run_Fields_Win" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 32. Initial Run Section (Windows-based Virtual Machines)</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>VM Hostname</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The host name of the virtual machine.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Domain</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Active Directory domain to which the virtual machine belongs.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Organization Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the organization to which the virtual machine belongs. This option corresponds to the text field for setting the organization name displayed when a machine running Windows is started for the first time.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Active Directory OU</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The organizational unit in the Active Directory domain to which the virtual machine belongs. The distinguished name must be provided. For example <code>CN=Users,DC=lab,DC=local</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Configure Time Zone</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time zone for the virtual machine. Select this check box and select a time zone from the <strong>Time Zone</strong> list.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Admin Password</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The administrative user password for the virtual machine. Click the disclosure arrow to display the settings for this option.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="menuseq"><b class="menu">Admin Password</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Use already configured password</b></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This check box is automatically selected after you specify an initial administrative user password. You must clear this check box to enable the <strong>Admin Password</strong> and <strong>Verify Admin Password</strong> fields and specify a new password.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="menuseq"><b class="menu">Admin Password</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Admin Password</b></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The administrative user password for the virtual machine. Enter the password in this text field and the <strong>Verify Admin Password</strong> text field to verify the password.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Custom Locale</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Locales must be in a format such as <code>en-US</code>. Click the disclosure arrow to display the settings for this option.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="menuseq"><b class="menu">Custom Locale</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">Input Locale</b></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The locale for user input.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="menuseq"><b class="menu">Custom Locale</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">UI Language</b></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The language used for user interface elements such as buttons and menus.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="menuseq"><b class="menu">Custom Locale</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">System Locale</b></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The locale for the overall system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="menuseq"><b class="menu">Custom Locale</b>&#160;<i class="fa fa-angle-right caret"></i> <b class="menuitem">User Locale</b></span></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The locale for users.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Sysprep</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A custom Sysprep definition. The definition must be in the format of a complete unattended installation answer file. You can copy and paste the default answer files in the <strong>/usr/share/ovirt-engine/conf/sysprep/</strong> directory on the machine on which the oVirt Engine is installed and alter the fields as required. The definition will overwrite any values entered in the <code>Initial Run</code> fields. See <a href="#chap-Templates">Templates</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Domain</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The Active Directory domain to which the virtual machine belongs. If left blank, the value of the previous <code>Domain</code> field is used.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Alternate Credentials</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Selecting this check box allows you to set a <strong>User Name</strong> and <strong>Password</strong> as alternative credentials.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <strong>System</strong> section enables you to define the supported machine type or CPU type.</p>
</div>
<table id="System_Fields" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 33. System Section</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Custom Emulated Machine</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This option allows you to specify the machine type. If changed, the virtual machine will only run on hosts that support this machine type. Defaults to the cluster&#8217;s default machine type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Custom CPU Type</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This option allows you to specify a CPU type. If changed, the virtual machine will only run on hosts that support this CPU type. Defaults to the cluster&#8217;s default CPU type.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <strong>Host</strong> section is used to define the virtual machine&#8217;s host.</p>
</div>
<table id="Host_Fields" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 34. Host Section</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Any host in cluster</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allocates the virtual machine to any available host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Specific Host(s)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies a user-defined host for the virtual machine.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <strong>Console</strong> section defines the protocol to connect to virtual machines.</p>
</div>
<table id="Console_Fields" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 35. Console Section</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Headless Mode</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Select this option if you do not require a graphical console when running the machine for the first time. See <a href="#Configuring_Headless_Machines">Configuring Headless Virtual Machines</a> for more information.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>VNC</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Requires a VNC client to connect to a virtual machine using VNC. Optionally, specify <strong>VNC Keyboard Layout</strong> from the drop-down list.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>SPICE</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Recommended protocol for Linux and Windows virtual machines. Using SPICE protocol with QXLDOD drivers is supported for Windows 10 and Windows Server 2016 and later virtual machines.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Enable SPICE file transfer</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determines whether you can drag and drop files from an external host into the virtual machine&#8217;s SPICE console. This option is only available for virtual machines using the SPICE protocol. This check box is selected by default.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Enable SPICE clipboard copy and paste</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defines whether you can copy and paste content from an external host into the virtual machine&#8217;s SPICE console. This option is only available for virtual machines using the SPICE protocol. This check box is selected by default.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <strong>Custom Properties</strong> section contains additional VDSM options for running virtual machines. See <a href="#New_VMs_Custom_Properties">Virtual Machine Custom Properties Settings</a> for details.</p>
</div>
</div>
<div class="sect2">
<h3 id="Virtual_Machine_Network_Interface_dialogue_entries">Explanation of Settings in the New Network Interface and Edit Network Interface Windows</h3>
<div class="paragraph">
<p>These settings apply when you are adding or editing a virtual machine network interface. If you have more than one network interface attached to a virtual machine, you can put the virtual machine on more than one logical network.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 36. Network Interface Settings</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 50%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Power cycle required?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the network interface. This text field has a 21-character limit and must be a unique name with any combination of uppercase and lowercase letters, numbers, hyphens, and underscores.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Profile</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The vNIC profile and logical network that the network interface is placed on. By default, all network interfaces are put on the <strong>ovirtmgmt</strong> management network.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Type</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The virtual interface the network interface presents to virtual machines.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>rtl8139</strong> and <strong>e1000</strong> device drivers are included in most operating systems.</p>
</li>
<li>
<p><strong>VirtIO</strong> is faster but requires VirtIO drivers. Enterprise Linux 5 and later include VirtIO drivers. Windows does not include VirtIO drivers, but they can be installed from the guest tools ISO or virtual floppy disk.</p>
</li>
<li>
<p><strong>PCI Passthrough</strong> enables the vNIC to be directly connected to a virtual function (VF) of an SR-IOV-enabled NIC. The vNIC will then bypass the software network virtualization and connect directly to the VF for direct device assignment. The selected vNIC profile must also have <strong>Passthrough</strong> enabled.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Custom MAC address</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Choose this option to set a custom MAC address. The oVirt Engine automatically generates a MAC address that is unique to the environment to identify the network interface. Having two devices with the same MAC address online in the same network causes networking conflicts.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Link State</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Whether or not the network interface is connected to the logical network.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Up</strong>: The network interface is located on its slot.</p>
<div class="ulist">
<ul>
<li>
<p>When the <strong>Card Status</strong> is <strong>Plugged</strong>, it means the network interface is connected to a network cable, and is active.</p>
</li>
<li>
<p>When the <strong>Card Status</strong> is <strong>Unplugged</strong>, the network interface will automatically be connected to the network and become active once plugged.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Down</strong>: The network interface is located on its slot, but it is not connected to any network. Virtual machines will not be able to run in this state.</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Card Status</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Whether or not the network interface is defined on the virtual machine.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Plugged</code>: The network interface has been defined on the virtual machine.</p>
<div class="ulist">
<ul>
<li>
<p>If its <strong>Link State</strong> is <code>Up</code>, it means the network interface is connected to a network cable, and is active.</p>
</li>
<li>
<p>If its <strong>Link State</strong> is <code>Down</code>, the network interface is not connected to a network cable.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>Unplugged</code>: The network interface is only defined on the Engine, and is not associated with a virtual machine.</p>
<div class="ulist">
<ul>
<li>
<p>If its <strong>Link State</strong> is <code>Up</code>, when the network interface is plugged it will automatically be connected to a network and become active.</p>
</li>
<li>
<p>If its <strong>Link State</strong> is <code>Down</code>, the network interface is not connected to any network until it is defined on a virtual machine.</p>
</li>
</ul>
</div>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="Add_Virtual_Disk_dialogue_entries">Explanation of settings in the New Virtual Disk and Edit Virtual Disk windows</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The following tables do not include information on whether a power cycle is required because that information is not applicable to these scenarios.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 37. New Virtual Disk and Edit Virtual Disk settings: <strong>Image</strong></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Size(GB)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The size of the new virtual disk in GB.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Alias</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the virtual disk, limited to 40 characters.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A description of the virtual disk. This field is recommended but not mandatory.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Interface</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The virtual interface the disk presents to virtual machines. <strong>VirtIO</strong> is faster, but requires drivers. Enterprise Linux 5 and later include these drivers. Windows does not include these drivers, but you can install them from the virtio-win ISO image. IDE and SATA devices do not require special drivers.</p>
<p class="tableblock">The interface type can be updated after stopping all virtual machines that the disk is attached to.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Data Center</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The data center in which the virtual disk will be available.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Storage Domain</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The storage domain in which the virtual disk will be stored. The drop-down list shows all storage domains available in the given data center, and also shows the total space and currently available space in the storage domain.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Allocation Policy</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The provisioning policy for the new virtual disk.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Preallocated</strong> allocates the entire size of the disk on the storage domain at the time the virtual disk is created. The virtual size and the actual size of a preallocated disk are the same. Preallocated virtual disks take more time to create than thin provisioned virtual disks, but have better read and write performance. Preallocated virtual disks are recommended for servers and other I/O intensive virtual machines. If a virtual machine is able to write more than 1 GB every four seconds, use preallocated disks where possible.</p>
</li>
<li>
<p><strong>Thin Provision</strong> allocates 1 GB at the time the virtual disk is created and sets a maximum limit on the size to which the disk can grow. The virtual size of the disk is the maximum limit; the actual size of the disk is the space that has been allocated so far. Thin provisioned disks are faster to create than preallocated disks and allow for storage over-commitment. Thin provisioned virtual disks are recommended for desktops.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Disk Profile</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The disk profile assigned to the virtual disk. Disk profiles define the maximum amount of throughput and the maximum level of input and output operations for a virtual disk in a storage domain. Disk profiles are defined on the storage domain level based on storage quality of service entries created for data centers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Activate Disk(s)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Activate the virtual disk immediately after creation. This option is not available when creating a floating disk.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Wipe After Delete</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows you to enable enhanced security for deletion of sensitive material when the virtual disk is deleted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Bootable</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables the bootable flag on the virtual disk.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Shareable</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attaches the virtual disk to more than one virtual machine at a time.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Read Only</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows you to set the disk as read-only. The same disk can be attached as read-only to one virtual machine, and as rewritable to another. This option is not available when creating a floating disk.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Enable Discard</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows you to shrink a thin provisioned disk while the virtual machine is up. For block storage, the underlying storage device must support discard calls, and the option cannot be used with <strong>Wipe After Delete</strong> unless the underlying storage supports the discard_zeroes_data property. For file storage, the underlying file system and the block device must support discard calls. If all requirements are met, SCSI UNMAP commands issued from guest virtual machines is passed on by QEMU to the underlying storage to free up the unused space.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <strong>Direct LUN</strong> settings can be displayed in either <strong>Targets &gt; LUNs</strong> or <strong>LUNs &gt; Targets</strong>. <strong>Targets &gt; LUNs</strong> sorts available LUNs according to the host on which they are discovered, whereas <strong>LUNs &gt; Targets</strong> displays a single list of LUNs.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 38. New Virtual Disk and Edit Virtual Disk settings: <strong>Direct LUN</strong></caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field Name</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Alias</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the virtual disk, limited to 40 characters.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A description of the virtual disk. This field is recommended but not mandatory. By default the last 4 characters of the LUN ID is inserted into the field.</p>
<p class="tableblock">The default behavior can be configured by setting the <code>PopulateDirectLUNDiskDescriptionWithLUNId</code> configuration key to the appropriate value using the <code>engine-config</code> command.  The configuration key can be set to <code>-1</code> for the full LUN ID to be used, or <code>0</code> for this feature to be ignored. A positive integer populates the description with the corresponding number of characters of the LUN ID.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Interface</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The virtual interface the disk presents to virtual machines. <strong>VirtIO</strong> is faster, but requires drivers. Enterprise Linux 5 and later include these drivers. Windows does not include these drivers, but you can install them from the virtio-win ISO image. IDE and SATA devices do not require special drivers.</p>
<p class="tableblock">The interface type can be updated after stopping all virtual machines that the disk is attached to.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Data Center</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The data center in which the virtual disk will be available.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Host</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The host on which the LUN will be mounted. You can select any host in the data center.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Storage Type</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The type of external LUN to add. You can select from either <strong>iSCSI</strong> or <strong>Fibre Channel</strong>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Discover Targets</strong></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>This section can be expanded when you are using iSCSI external LUNs and <strong>Targets &gt; LUNs</strong> is selected.</p>
</div>
<div class="paragraph">
<p><strong>Address</strong> - The host name or IP address of the target server.</p>
</div>
<div class="paragraph">
<p><strong>Port</strong> - The port by which to attempt a connection to the target server. The default port is 3260.</p>
</div>
<div class="paragraph">
<p><strong>User Authentication</strong> - The iSCSI server requires User Authentication. The <strong>User Authentication</strong> field is visible when you are using iSCSI external LUNs.</p>
</div>
<div class="paragraph">
<p><strong>CHAP user name</strong> - The user name of a user with permission to log in to LUNs. This field is accessible when the <strong>User Authentication</strong> check box is selected.</p>
</div>
<div class="paragraph">
<p><strong>CHAP password</strong> - The password of a user with permission to log in to LUNs. This field is accessible when the <strong>User Authentication</strong> check box is selected.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Activate Disk(s)</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Activate the virtual disk immediately after creation. This option is not available when creating a floating disk.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Bootable</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows you to enable the bootable flag on the virtual disk.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Shareable</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows you to attach the virtual disk to more than one virtual machine at a time.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Read Only</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows you to set the disk as read-only. The same disk can be attached as read-only to one virtual machine, and as rewritable to another. This option is not available when creating a floating disk.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Enable Discard</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Allows you to shrink a thin provisioned disk while the virtual machine is up. With this option enabled, SCSI UNMAP commands issued from guest virtual machines is passed on by QEMU to the underlying storage to free up the unused space.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Enable SCSI Pass-Through</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Available when the <strong>Interface</strong> is set to <strong>VirtIO-SCSI</strong>. Selecting this check box enables passthrough of a physical SCSI device to the virtual disk. A VirtIO-SCSI interface with SCSI passthrough enabled automatically includes SCSI discard support. <strong>Read Only</strong> is not supported when this check box is selected.</p>
<p class="tableblock">When this check box is not selected, the virtual disk uses an emulated SCSI device. <strong>Read Only</strong> is supported on emulated VirtIO-SCSI disks.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Allow Privileged SCSI I/O</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Available when the <strong>Enable SCSI Pass-Through</strong> check box is selected. Selecting this check box enables unfiltered SCSI Generic I/O (SG_IO) access, allowing privileged SG_IO commands on the disk. This is required for persistent reservations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Using SCSI Reservation</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Available when the <strong>Enable SCSI Pass-Through</strong> and <strong>Allow Privileged SCSI I/O</strong> check boxes are selected. Selecting this check box disables migration for any virtual machine using this disk, to prevent virtual machines that are using SCSI reservation from losing access to the disk.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Fill in the fields in the <strong>Discover Targets</strong> section and click <strong>Discover</strong> to discover the target server. You can then click the <strong>Login All</strong> button to list the available LUNs on the target server and, using the radio buttons next to each LUN, select the LUN to add.</p>
</div>
<div class="paragraph">
<p>Using LUNs directly as virtual machine hard disk images removes a layer of abstraction between your virtual machines and their data.</p>
</div>
<div class="paragraph">
<p>The following considerations must be made when using a direct LUN as a virtual machine hard disk image:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Live storage migration of direct LUN hard disk images is not supported.</p>
</li>
<li>
<p>Direct LUN disks are not included in virtual machine exports.</p>
</li>
<li>
<p>Direct LUN disks are not included in virtual machine snapshots.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Mounting a journaled file system requires read-write access. Using the <strong>Read Only</strong> option is not appropriate for virtual disks that contain such file systems (e.g. <strong>EXT3</strong>, <strong>EXT4</strong>, or <strong>XFS</strong>).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="Explanation_of_Settings_in_the_New_Template_and_Edit_Template_Windows">Explanation of Settings in the New Template Window</h3>
<div class="paragraph">
<p>The following table details the settings for the <strong>New Template</strong> window.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The following tables do not include information on whether a power cycle is required because that information is not applicable to this scenario.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>New Template Settings</p>
</li>
</ol>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Field</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Description/Action</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Name</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the template. This is the name by which the template is listed in the <strong>Templates</strong> tab in the Administration Portal and is accessed via the REST API. This text field has a 40-character limit and must be a unique name within the data center with any combination of uppercase and lowercase letters, numbers, hyphens, and underscores. The name can be reused in different data centers in the environment.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Description</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">A description of the template. This field is recommended but not mandatory.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Comment</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">A field for adding plain text, human-readable comments regarding the template.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Cluster</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">The cluster with which the template is associated. This is the same as the original virtual machines by default. You can select any cluster in the data center.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>CPU Profile</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">The CPU profile assigned to the template. CPU profiles define the maximum amount of processing capability a virtual machine can access on the host on which it runs, expressed as a percent of the total processing capability available to that host. CPU profiles are defined for a cluster based on quality of service entries created for data centers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Create as a Template Sub-Version</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Specifies whether the template is created as a new version of an existing template. Select this check box to access the settings for configuring this option.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Root Template</strong>: The template under which the sub-template is added.</p>
</li>
<li>
<p><strong>Sub-Version Name</strong>: The name of the template. This is the name by which the template is accessed when creating a new virtual machine based on the template. If the virtual machine is stateless, the list of sub-versions will contain a <strong>latest</strong> option rather than the name of the latest sub-version. This option automatically applies the latest template sub-version to the virtual machine upon reboot. Sub-versions are particularly useful when working with pools of stateless virtual machines.</p>
</li>
</ul>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Disks Allocation</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>Alias</strong> - An alias for the virtual disk used by the template. By default, the alias is set to the same value as that of the source virtual machine.</p>
</div>
<div class="paragraph">
<p><strong>Virtual Size</strong> - The total amount of disk space that a virtual machine based on the template can use. This value cannot be edited, and is provided for reference only. This value corresponds with the size, in GB, that was specified when the disk was created or edited.</p>
</div>
<div class="paragraph">
<p><strong>Format</strong> - The format of the virtual disk used by the template. The available options are QCOW2 and Raw. By default, the format is set to Raw.</p>
</div>
<div class="paragraph">
<p><strong>Target</strong> - The storage domain on which the virtual disk used by the template is stored. By default, the storage domain is set to the same value as that of the source virtual machine. You can select any storage domain in the cluster.</p>
</div>
<div class="paragraph">
<p><strong>Disk Profile</strong> - The disk profile to assign to the virtual disk used by the template. Disk profiles are created based on storage profiles defined in the data centers.  For more information, see <a href="https://ovirt.org/documentation/administration_guide/index#Creating_a_Disk_Profile">Creating a Disk Profile</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Allow all users to access this Template</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies whether a template is public or private. A public template can be accessed by all users, whereas a private template can only be accessed by users with the <strong>TemplateAdmin</strong> or <strong>SuperUser</strong> roles.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Copy VM permissions</strong></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copies explicit permissions that have been set on the source virtual machine to the template.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Seal Template</strong> (Linux only)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Specifies whether a template is sealed. 'Sealing' is an operation that erases all machine-specific configurations from a filesystem, including SSH keys, UDEV rules, MAC addresses, system ID, and hostname. This setting prevents a virtual machine based on this template from inheriting the configuration of the source virtual machine.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="appe-virt_sysprep_operations">Appendix B: <code>virt-sysprep</code> Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>virt-sysprep</code> command removes system-specific details.</p>
</div>
<div class="paragraph">
<p>Only operations marked with <code>*</code> are performed during the template sealing process.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"># virt-sysprep --list-operations
abrt-data * Remove the crash data generated by ABRT
bash-history * Remove the bash history in the guest
blkid-tab * Remove blkid tab in the guest
ca-certificates   Remove CA certificates in the guest
crash-data * Remove the crash data generated by kexec-tools
cron-spool * Remove user at-jobs and cron-jobs
customize * Customize the guest
dhcp-client-state * Remove DHCP client leases
dhcp-server-state * Remove DHCP server leases
dovecot-data * Remove Dovecot (mail server) data
firewall-rules   Remove the firewall rules
flag-reconfiguration   Flag the system for reconfiguration
fs-uuids   Change filesystem UUIDs
kerberos-data   Remove Kerberos data in the guest
logfiles * Remove many log files from the guest
lvm-uuids * Change LVM2 PV and VG UUIDs
machine-id * Remove the local machine ID
mail-spool * Remove email from the local mail spool directory
net-hostname * Remove HOSTNAME in network interface configuration
net-hwaddr * Remove HWADDR (hard-coded MAC address) configuration
pacct-log * Remove the process accounting log files
package-manager-cache * Remove package manager cache
pam-data * Remove the PAM data in the guest
puppet-data-log * Remove the data and log files of puppet
rh-subscription-manager * Remove the RH subscription manager files
rhn-systemid * Remove the RHN system ID
rpm-db * Remove host-specific RPM database files
samba-db-log * Remove the database and log files of Samba
script * Run arbitrary scripts against the guest
smolt-uuid * Remove the Smolt hardware UUID
ssh-hostkeys * Remove the SSH host keys in the guest
ssh-userdir * Remove ".ssh" directories in the guest
sssd-db-log * Remove the database and log files of sssd
tmp-files * Remove temporary files
udev-persistent-net * Remove udev persistent net rules
user-account   Remove the user accounts in the guest
utmp * Remove the utmp file
yum-uuid * Remove the yum UUID</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="legal-notice">Appendix C: Legal notice</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Certain portions of this text first appeared in <a href="https://access.redhat.com/documentation/en-us/red_hat_virtualization/4.4/html-single/virtual_machine_management_guide/index">Red Hat Virtualization 4.4 Virtual Machine Management Guide</a>. Copyright  2021 Red Hat, Inc. Licensed under a <a href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 Unported License</a>.</p>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. <code>Highly Available</code> is not automatically enabled. If you select it manually, high availability should be enabled for pinned hosts only.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. Number of I/O threads = 1
</div>
</div>



        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/2663/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/2663/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/2663/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/2663/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=documentation&amp;title=Issue:%20/documentation/virtual_machine_management_guide/&amp;template=issue_template_documentation.md' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/master/source/documentation/virtual_machine_management_guide/index.adoc' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
