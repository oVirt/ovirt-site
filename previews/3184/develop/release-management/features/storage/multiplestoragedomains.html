<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Multiple storage domains | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Multiple storage domains" />
<meta name="author" content="Daniel Erez" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/3184/develop/release-management/features/storage/multiplestoragedomains.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/3184/develop/release-management/features/storage/multiplestoragedomains.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Multiple storage domains" />
<meta name="twitter:site" content="@ovirt" />
<meta name="twitter:creator" content="@Daniel Erez" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Daniel Erez"},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"Multiple storage domains","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/3184/images/logo.svg"},"name":"Daniel Erez"},"url":"https://ovirt.github.io/ovirt-site/previews/3184/develop/release-management/features/storage/multiplestoragedomains.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/3184/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/3184/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/3184/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/3184/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/3184/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/3184/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3184/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3184/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3184/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3184/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3184/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/3184/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/3184/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/3184/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/3184/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/3184/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/3184/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/3184/images/logo.svg" />      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav" role="menubar">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/3184/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3184/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/3184/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3184/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3184//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3184//blogs.ovirt.org/'>Blog</a></li>        </ul>      </div>      <!-- /.navbar-collapse -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3184/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3184/develop/">
              <span property="name">Joining the developers community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3184/develop/release-management/">
              <span property="name">Release Management</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3184/develop/release-management/features/">
              <span property="name">Features (Design documents)</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3184/develop/release-management/features/storage/">
              <span property="name">Storage</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/93875e42e9b962947becb4e425504fab?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/93875e42e9b962947becb4e425504fab?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Daniel Erez">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Daniel Erez</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/6a7f6922bd0adbea1647f99c50875a33?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/6a7f6922bd0adbea1647f99c50875a33?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Jon Choate">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Jon Choate</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/9942503c8cf556c85339e8454f375905?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/9942503c8cf556c85339e8454f375905?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Michael Kublin">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Michael Kublin</span></p>
                      
                    </section>
                  </div>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Feature pages are design documents that developers have created while collaborating on oVirt.<br><br>Most of them are&nbsp;<strong>outdated</strong>, but provide historical design context.<br><br>They are&nbsp;<strong>not</strong>&nbsp;user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/3184/documentation/'>Documentation is available here.</a></div>

<h1 id="design-for-multiple-storage-domains">Design for multiple storage domains</h1>

<h3 id="multiple-storage-domains">Multiple Storage Domains</h3>

<h2 id="user-stories">User Stories</h2>

<ul>
  <li><strong>Add VM</strong> - As a RHEV-M user, when I create a VM using the GUI/REST API, I want to be able to select different storage domains for each disk in the VM so that I can make efficient use of my storage. I know the feature works when I can create a VM with 3 disks each on different storage domains.</li>
  <li><strong>Import VM</strong> - As a RHEV-M user, when I import a VM using the GUI/REST API, I want to be able to select different storage domains for each disk in the VM so that I can make efficient use of my storage. I know the feature works when I can import a VM with 3 disks each on different storage domains.</li>
  <li><strong>Add Disk to VM</strong> - As a RHEV-M user, when I add a disk to a VM using the GUI/REST API, I can select which storage domain to associate with it so that I can make more efficient use of my storage. I know the feature works when I can add a disk to a VM and put it on a storage domain not already in use by the VM.</li>
  <li><strong>Import VM template</strong> - As a RHEV-M user, when I import a VM template using the GUI/REST API, I want to be able to select different storage domains for each disk in the template so that I can make efficient use of my storage. I know the feature works when I can import a template with 3 disks each on different storage domains.</li>
  <li><strong>Move Disk</strong> - As a RHEV-M user, I want to be able to use the GUI/REST API to move a disk from one storage domain to another so that I can make efficient use of my storage. I know the feature works when I can move a disk to an existing storage domain not already in use by the VM.</li>
  <li><strong>Create VM from template</strong> - As a RHEV-M user, I want to be able to use the GUI/REST API to create a VM from a template and be able to specify on which storage domain each disk should be created. I know the feature works when I can create a VM from a template that has 3 disks and I can put each disk on a separate storage domain.</li>
  <li><strong>Create Template from VM</strong> - As a RHEV-M user, I want to be able to use the GUI/REST API to create a template from a VM and be able to specify which storage domain should hold its disks. I know the feature works when I can create a template on a different storage domain than the one the VM resides on.</li>
  <li><strong>Clone Template</strong> - As a RHEV-M user, I want to be able to use the GUI/REST API to clone a template and be able to specify which storage domain should hold its disks. I know the feature works when I can clone a template on a different storage domain than the one the source template resides on.</li>
</ul>

<h2 id="acceptance-tests">Acceptance Tests</h2>

<p>Will be based on the “I know the feature works…” in the user stories.</p>

<h3 id="additional-functionality-to-verify">Additional functionality to verify</h3>

<ul>
  <li>create snapshots</li>
  <li>delete disk</li>
  <li>delete VM</li>
  <li>start VM</li>
  <li>hibernate VM</li>
</ul>

<h2 id="overall-design">Overall design</h2>

<p>The main change that needs to happen is to have each image associated with its own storage domain.</p>

<h3 id="gui">GUI</h3>

<h4 id="general-changes">General Changes</h4>

<h5 id="virtual-machines-tab">Virtual Machines Tab</h5>

<ul>
  <li>The Virtual Disks tab need to have a Storage Domain column added</li>
</ul>

<h5 id="storage-tab">Storage Tab</h5>

<ul>
  <li>The Virtual Machines tab need to have some columns removed</li>
  <li>There needs to be a new tab for Virtual Disks so that users can view which disks are on which domains.</li>
</ul>

<h4 id="workflow-changes">Workflow Changes</h4>

<ul>
  <li>Add a VM</li>
  <li>Import a VM</li>
  <li>Add Disk to VM</li>
  <li>Import VM Template</li>
  <li>Move Disk</li>
  <li>Create VM from Template</li>
  <li>Create template from VM</li>
  <li>Clone template</li>
</ul>

<h5 id="user-experience">User Experience</h5>

<p>The following UI mockups contain guidelines for the different screens and wizards:</p>

<p><img src="/ovirt-site/previews/3184/images/wiki/VM_from_template_single.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3184/images/wiki/VM_from_template_multi.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3184/images/wiki/import_vm_single.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3184/images/wiki/import_vm_multi.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3184/images/wiki/import_template_single.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3184/images/wiki/import_template_multi.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3184/images/wiki/disks_subtab.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3184/images/wiki/new_move_disk_dialog.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3184/images/wiki/storage_vms_subtab.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3184/images/wiki/new_template.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3184/images/wiki/templates_storage_subtab.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3184/images/wiki/templates_vms_subtab.png" alt="" /></p>

<h3 id="rest-design-modeling">REST Design (Modeling)</h3>

<p>This section describes the REST design for this feature.</p>

<ul>
  <li>Add a VM</li>
  <li>Import a VM</li>
  <li>Add Disk to VM</li>
  <li>Import VM Template</li>
  <li>Move Disk</li>
  <li>Create VM from Template</li>
  <li>Create template from VM</li>
  <li>Clone template</li>
</ul>

<p>The changes will be done at java code, by processing passed parameters from client</p>

<h3 id="backend">Backend</h3>

<p>There should not be any changes to the database or the object model to support this feature. Many of the command classes will need their logic changes to handle processing each disk individually by their storage domain instead of handling them all at once.</p>

<h2 id="vdsm">VDSM</h2>

<p>Vdsm already supports this feature; it has no limitation on the location of disk images. Any storage domain for any VM disk will do.</p>

<h2 id="open-issues">Open Issues</h2>

<ol>
  <li>Need to consider negative cases when some storage domains fail, etc.</li>
  <li>Need to determine which flows will need additional transactionality due to multiple storage domains.</li>
  <li>Need to figure out how hibernation will work</li>
</ol>

<h2 id="known-issues--risks">Known Issues / Risks</h2>

<p>Being developed in parallel with quotas. Can’t anticipate changes needed to work with quotas.</p>

<h2 id="needed-documentation">Needed documentation</h2>

<p>The docs will need to be updated with new screenshots showing adding a disk to a VM and selecting the storage domain there.</p>




        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/3184/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/3184/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/3184/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/3184/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2024 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/release-management/features/storage/multiplestoragedomains.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/main/source/develop/release-management/features/storage/multiplestoragedomains.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
