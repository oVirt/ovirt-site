<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>ReportingVnicInformation | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="ReportingVnicInformation" />
<meta name="author" content="Dan Kenigsberg" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/2869/develop/release-management/features/network/reportingvnicinformation.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/2869/develop/release-management/features/network/reportingvnicinformation.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="ReportingVnicInformation" />
<meta name="twitter:site" content="@ovirt" />
<meta name="twitter:creator" content="@Dan Kenigsberg" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Dan Kenigsberg"},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"ReportingVnicInformation","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/2869/images/logo.svg"},"name":"Dan Kenigsberg"},"url":"https://ovirt.github.io/ovirt-site/previews/2869/develop/release-management/features/network/reportingvnicinformation.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/2869/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/2869/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/2869/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/2869/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/2869/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/2869/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2869/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2869/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2869/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2869/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2869/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/2869/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/2869/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/2869/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/2869/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/2869/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/2869/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/2869/images/logo.svg">      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/2869/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2869/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/2869/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2869/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2869//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2869//blogs.ovirt.org/'>Blog</a></li>              </ul>          </div>          <!-- /.navbar-collapse -->      </div>      <!-- /.container-fluid -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2869/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2869/develop/">
              <span property="name">Developers Community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2869/develop/release-management/">
              <span property="name">Release Management</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2869/develop/release-management/features/">
              <span property="name">Features (Design documents)</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2869/develop/release-management/features/network/">
              <span property="name">Network</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/ce421080e5d2da87febb626f6e8906c9?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/ce421080e5d2da87febb626f6e8906c9?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Dan Kenigsberg</span></p>
                      
                    </section>
                  </span>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/90758110b19ee0a2e03473012fdc1bd7?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/90758110b19ee0a2e03473012fdc1bd7?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Moti Asayag</span></p>
                      
                    </section>
                  </span>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/5a3da0b81e7e9b1e1c78621348bdfe11?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/5a3da0b81e7e9b1e1c78621348bdfe11?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Muli Salem</span></p>
                      
                    </section>
                  </span>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Feature pages are design documents that developers have created while collaborating on oVirt.<br><br>Most of them are&nbsp;<strong>outdated</strong>, but provide historical design context.<br><br>They are&nbsp;<strong>not</strong>&nbsp;user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/2869/documentation/'>Documentation is available here.</a></div>

<h1 id="reporting-vnic-information">Reporting Vnic Information</h1>

<h2 id="reporting-vnic-information-reported-by-guest-agent">Reporting vNIC information reported by Guest Agent</h2>

<h3 id="summary">Summary</h3>

<p>The Guest Agent reports the vNic details:</p>

<ul>
  <li>IP addresses (both IPv4 and IPv6).</li>
  <li>vNic internal name</li>
</ul>

<p>The retrieved information by the Guest Agent should be reported to the ovirt-engine and to be viewed by its client
Today only the IPv4 addresses are reported to the User, kept on VM level. This feature will maintain the information on vNic level.</p>

<h3 id="owner">Owner</h3>

<ul>
  <li>Name: Moti Asayag</li>
  <li>Email: masayag@redhat.com</li>
</ul>

<h3 id="current-status">Current status</h3>

<p><a href="/ovirt-site/previews/2869/develop/release-management/features/network/detailedreportingvnicinformation.html">Reporting vNIC implementation reported by Guest Agent Detailed Design</a></p>

<h3 id="user-experience">User Experience</h3>

<h4 id="api-changes">API Changes</h4>

<p>New attributes will be added to VM nics collection <code class="language-plaintext highlighter-rouge">/api/vms/{vm:id}/nics</code>:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   <span class="nt">&lt;nics&gt;</span>
       <span class="nt">&lt;nic</span> <span class="na">id=</span><span class="s">"56d6d62f-6af0-4c02-8500-4be041180031"</span><span class="nt">&gt;</span>
           <span class="nt">&lt;name&gt;</span>nic1<span class="nt">&lt;/name&gt;</span>
                 ...
           <span class="nt">&lt;reported_data&gt;</span>
               <span class="nt">&lt;rel</span><span class="err">="devices"</span> <span class="na">href=</span><span class="s">/api/vms/{vm:id}/nics/{nic:id}/reporteddevices</span><span class="nt">&gt;</span>
           <span class="nt">&lt;reported_data/&gt;</span>
      <span class="nt">&lt;nic/&gt;</span>
             ...
   <span class="nt">&lt;/nics&gt;</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>device:id = UUID.fromString(name)
</code></pre></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;network_device</span> <span class="na">id=</span><span class="s">{device:id}</span> <span class="na">href=</span><span class="s">/api/vms/{vm:id}/reporteddevices/{device:id}</span><span class="nt">&gt;</span>
       <span class="nt">&lt;name&gt;</span>p1p2<span class="nt">&lt;/name&gt;</span>
       <span class="nt">&lt;description&gt;</span>guest reported data<span class="nt">&lt;/description&gt;</span>
       <span class="nt">&lt;ips&gt;</span>
           <span class="nt">&lt;ip</span> <span class="na">version=</span><span class="s">"v4"</span> <span class="na">address=</span><span class="s">"10.35.1.177"</span><span class="nt">/&gt;</span>
           <span class="nt">&lt;ip</span> <span class="na">version=</span><span class="s">"v6"</span> <span class="na">address=</span><span class="s">"fe80::21a:4aff:fe16:151"</span><span class="nt">/&gt;</span>
       <span class="nt">&lt;/ips&gt;</span>
             <span class="nt">&lt;mac</span> <span class="err">address</span><span class="nt">&gt;&lt;/mac&gt;</span>        
 <span class="nt">&lt;/network_device&gt;</span>
</code></pre></div></div>

<h5 id="backward-compatibility">Backward compatibility</h5>

<p>Note that the existing IPs reported on /api/vms/{vm:id} are left intact, however the IPs addresses are retrieved from the VM’s nics.</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="nt">&lt;guest_info&gt;</span>
      <span class="nt">&lt;ips&gt;</span>
          <span class="nt">&lt;ip</span> <span class="na">address=</span><span class="s">"1.1.1.1"</span><span class="nt">/&gt;</span>
          <span class="nt">&lt;ip</span> <span class="na">address=</span><span class="s">"2.2.2.2"</span><span class="nt">/&gt;</span>
      <span class="nt">&lt;/ips&gt;</span>
  <span class="nt">&lt;/guest_info&gt;</span>
</code></pre></div></div>

<p>A new link will be added under the VM:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"devices"</span> <span class="na">href=</span><span class="s">"/api/vms/6c56bd4b-ef18-4e50-b182-277ed78e819d/reporteddevices"</span><span class="nt">/&gt;</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>device:id = UUID.fromString(name+mac)
</code></pre></div></div>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="nt">&lt;network_device</span> <span class="na">id=</span><span class="s">{device:id}</span> <span class="na">href=</span><span class="s">/api/vms/{vm:id}/devices/{device:id}</span><span class="nt">&gt;</span>
       <span class="nt">&lt;name&gt;</span>p1p2<span class="nt">&lt;/name&gt;</span>
       <span class="nt">&lt;description&gt;</span>guest reported data<span class="nt">&lt;/description&gt;</span>
       <span class="nt">&lt;ips&gt;</span>
           <span class="nt">&lt;ip</span> <span class="na">version=</span><span class="s">"v4"</span> <span class="na">address=</span><span class="s">"10.35.1.177"</span><span class="nt">/&gt;</span>
           <span class="nt">&lt;ip</span> <span class="na">version=</span><span class="s">"v6"</span> <span class="na">address=</span><span class="s">"fe80::21a:4aff:fe16:151"</span><span class="nt">/&gt;</span>
       <span class="nt">&lt;/ips&gt;</span>
             <span class="nt">&lt;mac</span> <span class="err">address</span><span class="nt">&gt;&lt;/mac&gt;</span>        
 <span class="nt">&lt;/network_device&gt;</span>
</code></pre></div></div>

<p>Populating the VM’s <strong>network_devices</strong> element under <strong>guest_info</strong> is implemented by mechanism introduced by <a href="http://gerrit.ovirt.org/#/c/9815">“All-Content Header” patch</a>
Only if the request header contains the ‘All-Content=true’, the network’s devices information will be populate the for the VM.</p>

<h4 id="ui-changes">UI Changes</h4>

<p>Administrator Portal:</p>

<ul>
  <li>VM Main-Tab - No changes:
    <ul>
      <li>On ip address column the entire list of IP addresses will be presented instead (single space delimiter between the IPs)</li>
    </ul>
  </li>
</ul>

<!-- -->

<ul>
  <li>VM Network Interface sub-tab (both Admin Portal and User Portal):</li>
</ul>

<p>A split view of the VM’s Network Interfaces sub-tab will present the information reported by the Guest Agent:</p>

<ul>
  <li>When there is a match by MAC Address between the vNic’s definition on management to the reported vNic by the Guest Agent.</li>
</ul>

<p><img src="/ovirt-site/previews/2869/images/wiki/VmInterfaceSubTab.png" alt="" /></p>

<ul>
  <li>The Guest Agent only reports devices that are up, therefore we are not able to report vNics that are down.</li>
  <li>The Guest Agent is not updated upon change, but rather periodically every 2 minutes, therefore user may experience a slight delay when updating/adding a vNic.</li>
</ul>

<h3 id="benefit-to-ovirt">Benefit to oVirt</h3>

<p>The feature is an enhancement of the oVirt engine vNic management:</p>

<ul>
  <li>It allows easily association of the managed vNic on engine side by its name with the the actual guest’s vNic (instead of comparing MAC Addresses).</li>
  <li>It provides the information required to connect by IP to a specific network.</li>
</ul>

<h3 id="dependencies--related-features">Dependencies / Related Features</h3>

<p>Affected oVirt projects:</p>

<ul>
  <li>Engine-core</li>
  <li>API</li>
  <li>Admin Portal</li>
  <li>User Portal</li>
</ul>

<h3 id="open-issues">Open Issues</h3>

<p><strong>Suggested naming alternatives</strong>:
* ipv4_addresses –&gt; inet</p>

<ul>
  <li>ipv6_addresses –&gt; inet6</li>
</ul>




        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/2869/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/2869/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/2869/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/2869/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/release-management/features/network/reportingvnicinformation.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/master/source/develop/release-management/features/network/reportingvnicinformation.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
