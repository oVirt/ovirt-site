<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Default / Secure CPU Type Concept | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Default / Secure CPU Type Concept" />
<meta name="author" content="Lucia Jelinkova" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/3053/develop/release-management/features/virt/secure-cpus.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/3053/develop/release-management/features/virt/secure-cpus.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Default / Secure CPU Type Concept" />
<meta name="twitter:site" content="@ovirt" />
<meta name="twitter:creator" content="@Lucia Jelinkova" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Lucia Jelinkova"},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"Default / Secure CPU Type Concept","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/3053/images/logo.svg"},"name":"Lucia Jelinkova"},"url":"https://ovirt.github.io/ovirt-site/previews/3053/develop/release-management/features/virt/secure-cpus.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/3053/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/3053/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/3053/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/3053/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/3053/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/3053/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3053/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3053/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3053/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3053/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3053/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/3053/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/3053/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/3053/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/3053/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/3053/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/3053/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/3053/images/logo.svg" />      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav" role="menubar">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/3053/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3053/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/3053/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3053/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3053//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3053//blogs.ovirt.org/'>Blog</a></li>        </ul>      </div>      <!-- /.navbar-collapse -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3053/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3053/develop/">
              <span property="name">Developers Community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3053/develop/release-management/">
              <span property="name">Release Management</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3053/develop/release-management/features/">
              <span property="name">Features (Design documents)</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3053/develop/release-management/features/virt/">
              <span property="name">Virt</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Lucia Jelinkova">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Lucia Jelinkova</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/53e02861c7101e6d8416bd00fb86fc46?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/53e02861c7101e6d8416bd00fb86fc46?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Michal Skrivanek">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Michal Skrivanek</span></p>
                      
                    </section>
                  </div>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Feature pages are design documents that developers have created while collaborating on oVirt.<br><br>Most of them are&nbsp;<strong>outdated</strong>, but provide historical design context.<br><br>They are&nbsp;<strong>not</strong>&nbsp;user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/3053/documentation/'>Documentation is available here.</a></div>

<h1 id="default--secure-cpu-type-concept">Default / Secure CPU Type Concept</h1>

<h2 id="summary">Summary</h2>

<p>Improve the maintainability of oVirt CPU Types by supporting only <em>default</em> and <em>secure</em> version of each CPU microarchitecture.</p>

<h2 id="owner">Owner</h2>

<ul>
  <li>
    <p>Name: Lucia Jelinkova (ljelinko)</p>
  </li>
  <li>
    <p>Email: <a href="mailto:ljelinko@redhat.com">ljelinko@redhat.com</a></p>
  </li>
</ul>

<h2 id="detailed-description">Detailed Description</h2>

<p>oVirt keeps a list of supported CPU Types in the vdc_options table in the database under the key ServerCPUList. Previously, with every security update a new CPU Type was created for ALL affected architectures. Consequently, the list grew in length and looked like this:</p>

<ul>
  <li>Intel Broadwell Client Family</li>
  <li>Intel Broadwell Client IBRS Family’</li>
  <li>Intel Broadwell Client IBRS SSBD Family’</li>
  <li>Intel Broadwell Client IBRS SSBD MDS Family</li>
  <li>Intel Skylake Client Family</li>
  <li>Intel Skylake Client IBRS Family’</li>
  <li>Intel Skylake Client IBRS SSBD Family’</li>
  <li>Intel Skylake Client IBRS SSBD MDS Family</li>
  <li>Intel Skylake Server Family</li>
  <li>Intel Skylake Server IBRS Family’</li>
  <li>Intel Skylake Server IBRS SSBD Family’</li>
  <li>Intel Skylake Server IBRS SSBD MDS Family</li>
</ul>

<p>In order to keep the CPU list manageable, only 2 CPU Types are now supported for any CPU microarchitecture that has security updates.</p>

<ul>
  <li>Intel Broadwell Client Family</li>
  <li>Secure Intel Broadwell Client Family’</li>
  <li>Intel Skylake Client Family</li>
  <li>Secure Intel Skylake Client Family’</li>
  <li>Intel Skylake Server Family</li>
  <li>Secure Intel Skylake Server Family’</li>
</ul>

<p>The <em>default</em> CPU Type will not change over the time while the <em>secure</em> CPU type will contain the latest updates.</p>

<h2 id="prerequisites">Prerequisites</h2>
<p>Previously, it was not possible to simply update the CPU Type configuration because all hosts that would not comply to the new configuration would become non operational.</p>

<p>To ensure that the hosts are operational even after the CPU configuration is changed, we store the currently used configuration in the cluster table. That ensures that even after configuration in vdc_options table is changed, the hosts stay operational.</p>

<p>When all cluster hosts are compatible with the changed CPU, the cluster table is automatically updated to contain the same configuration as vdc_options table.</p>

<h2 id="benefit-to-ovirt">Benefit to oVirt</h2>

<p>Improved maintainability of supported CPU Types.</p>

<h2 id="user-experience">User Experience</h2>

<p>If the CPU configuration is different in the cluster table than in the vdc_options table, it is important to notify the user. The following warnings are displayed in the UI:</p>

<h3 id="administration-portal">Administration Portal</h3>

<h4 id="cluster">Cluster</h4>
<p>On a Clusters list page, the status column shows a warning icon in case the cluster has hosts that are not fully compatible with the cluster CPU Type configurations.</p>

<p><img src="/ovirt-site/previews/3053/images/wiki/secure-cpus-cluster-list-warning.png" alt="" /></p>

<h4 id="host">Host</h4>
<p>On a Hosts list page, the status column shows a warning icon in case the host is not fully compatible with the current CPU Type configuration. The warning also lists all flags that are required by the configuration, but are not available on the host.</p>

<p><img src="/ovirt-site/previews/3053/images/wiki/secure-cpus-host-list-warning.png" alt="" /></p>

<h4 id="vm">VM</h4>
<p>On a Virtual Machines list page, the status column shows a warning icon in case the virtual machine’s CPU configuration is not the same as the configuration for cluster CPU Type.</p>

<p><img src="/ovirt-site/previews/3053/images/wiki/secure-cpus-vm-list-warning.png" alt="" /></p>

<p>On a Virtual Machine detail page, the Guest CPU field shows a warning icon in case the virtual machine’s CPU configuration is not the same as the configuration for cluster CPU Type. It also contains additional information about the current configuration for cluster CPU Type.</p>

<p><img src="/ovirt-site/previews/3053/images/wiki/secure-cpus-vm-detail-warning.png" alt="" /></p>
<h3 id="rest-api">REST API</h3>
<p>These changes do to affect the REST API (except for the CPU Type rename).</p>

<h2 id="installationupgrade">Installation/Upgrade</h2>

<p>During engine setup, the existing CPU Types are renamed and changed either to <em>default</em> or <em>secure</em> CPU Type.</p>

<h2 id="user-work-flows">User work-flows</h2>

<ol>
  <li>User has cluster with 2 hosts named A and B</li>
  <li>User updates oVirt engine and the update contains also new CPU microcode security updates</li>
  <li>User opens the Administration Portal and sees a warning on the cluster in the Clusters list view that there are hosts not compatible with the current CPU Type configuration</li>
  <li>User opens Host list view and sees that there are warnings on hosts A and B</li>
  <li>User puts host A into the maintenance, updates the microcode and activates the host. The warning on the Host A disappears</li>
  <li>User puts host B into the maintenance, updates the microcode and activates the host. The warning on the Host B disappears</li>
  <li>There is no warning on the cluster in the Cluster list view</li>
</ol>




        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/3053/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/3053/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/3053/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/3053/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/release-management/features/virt/secure-cpus.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/main/source/develop/release-management/features/virt/secure-cpus.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
