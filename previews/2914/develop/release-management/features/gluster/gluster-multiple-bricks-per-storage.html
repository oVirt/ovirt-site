<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Support for multiple GlusterFS bricks on a block device(s) | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Support for multiple GlusterFS bricks on a block device(s)" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/2914/develop/release-management/features/gluster/gluster-multiple-bricks-per-storage.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/2914/develop/release-management/features/gluster/gluster-multiple-bricks-per-storage.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Support for multiple GlusterFS bricks on a block device(s)" />
<meta name="twitter:site" content="@ovirt" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"Support for multiple GlusterFS bricks on a block device(s)","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/2914/images/logo.svg"}},"url":"https://ovirt.github.io/ovirt-site/previews/2914/develop/release-management/features/gluster/gluster-multiple-bricks-per-storage.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/2914/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/2914/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/2914/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/2914/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/2914/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/2914/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2914/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2914/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2914/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2914/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2914/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/2914/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/2914/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/2914/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/2914/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/2914/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/2914/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/2914/images/logo.svg">      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/2914/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2914/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/2914/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2914/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2914//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2914//blogs.ovirt.org/'>Blog</a></li>              </ul>          </div>          <!-- /.navbar-collapse -->      </div>      <!-- /.container-fluid -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2914/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2914/develop/">
              <span property="name">Developers Community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2914/develop/release-management/">
              <span property="name">Release Management</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2914/develop/release-management/features/">
              <span property="name">Features (Design documents)</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2914/develop/release-management/features/gluster/">
              <span property="name">Gluster</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/a47850263e36b9e8a35dcedf316a14ad?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/a47850263e36b9e8a35dcedf316a14ad?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Denis Chaplygin</span></p>
                      
                    </section>
                  </span>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Feature pages are design documents that developers have created while collaborating on oVirt.<br><br>Most of them are&nbsp;<strong>outdated</strong>, but provide historical design context.<br><br>They are&nbsp;<strong>not</strong>&nbsp;user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/2914/documentation/'>Documentation is available here.</a></div>

<h1 id="support-for-multiple-glusterfs-bricks-on-a-block-devices">Support for multiple GlusterFS bricks on a block device(s)</h1>

<h1 id="summary">Summary</h1>

<p>This feature introduces ability to create multiple GlusterFS bricks on the same block device(s).</p>

<p>Having one (or more) physical block device, user should be able to create a LVM volume group on top of it and use LVM logical volumes as a brick backend device. That approach will allow better management of the local storage alongside with support for thin provisioning for the GlusterFS and SSD caching.</p>

<h2 id="owner">Owner</h2>

<ul>
  <li>Name: <a href="https://github.com/akashihi">Denis Chaplygin</a></li>
</ul>

<h2 id="current-status">Current status</h2>

<ul>
  <li>Target Release: 4.3</li>
  <li>Status: Planning</li>
  <li>Last updated: January 08, 2018</li>
</ul>

<h1 id="detailed-description">Detailed description</h1>

<p>Current oVirt’s GlusterFS brick/volume management implementation implies that bricks should occupy the whole block device, thus limiting possible number of bricks to the number of physically available block devices. That approach could be quite limiting, especially in case of small deployments or hyperconverged environments, when you have just one or two relatively big drives for you VM payloads.</p>

<p>This change will introduce multiple bricks sharing same block device into oVirt, thus allowing users to manage their local storage using oVirt UI and use LVM logical volumes as a block devices for GlusterFS bricks. It will also bring LVM specific features, such as thin provisioning and SSD caching.</p>

<h1 id="implementation-details">Implementation details</h1>

<h2 id="engine">Engine</h2>

<ul>
  <li>Engine should support creation of physical volumes, volume groups and logical volumes. This can be implemented using engine Ansible integration, to not to pollute vdsm with that code. Engine should be able to retrieve current LVM configuration.</li>
  <li>Engine should support LVM thin pools and allow creation of thin logical volumes. Thin pool implementation details should be hidden from the user.</li>
  <li>Alongside with thin pools, engine must support SSD caching configuration. Implementation details should be hidden from the user.</li>
  <li>Thin pool support adds a ‘second’ size to the logical volumes (and, therefore, to gluster bricks, gluster volumes and storage domains running on top of them) - with thin pool every logical volume will have a ‘reported’ size and ‘physical’ size. First one, ‘reported’ is a size of a logical volume, as reported by df command or similar. ‘Physical’ size is a size of thin pool itself. Obviously, they could differ and actual usage of both filesystem and thin pool may differ, so both sizes must be reported by vdsm to the engine, stored at the database and presented to the user.</li>
  <li>It would be nice if engine will actually know type of each block device (solid/spinning) and will only allow solid drives to be used as SSD cache. We need that information to be reported by VDSM and stored at the database.</li>
</ul>

<h2 id="vdsm">VDSM</h2>

<ul>
  <li>VDSM LVM filtering needs to work correctly with new engine LVM management.</li>
  <li>VDSM should report underlying thin pool size/usage, probably using additional field at VolumeGroupInfo</li>
  <li>VDSM should report block device type (solid/spinning), probaly using additional field at BlockDeviceInfo</li>
  <li>VDSM blivet support should be dropped and replaced with ansible brick/volume management at the engine side.</li>
</ul>

<h2 id="rest-api">REST API</h2>

<ul>
  <li>Support for additional fields, introduced above, must be added.</li>
</ul>

<h2 id="ovirt-ui">oVirt UI</h2>

<ul>
  <li>‘Physical’ size needs to be added alongside with existing ‘reported’ size field</li>
  <li>Gluster brick management dialog needs to be extended and support for multiple bricks on the same device should be added.</li>
  <li>Gluster brick management dialog should allow thin pool creation</li>
  <li>Gluster brick management dialog should allow SSD cache configration, only in case of presence of unused SSD block devices and, at the same time, with thin pool enabled</li>
</ul>

<h2 id="benefit-to-ovirt">Benefit to oVirt</h2>

<ul>
  <li>Simplification of hyperconverged deploys</li>
  <li>Fine grained local storage management</li>
</ul>

<h2 id="open-issues">Open issues</h2>

<ul>
  <li>[BUG-1515299: (https://bugzilla.redhat.com/show_bug.cgi?id=1515299)[RFE] - Support multiple bricks per storage device and configuring lvmcache]</li>
</ul>




        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/2914/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/2914/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/2914/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/2914/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/release-management/features/gluster/gluster-multiple-bricks-per-storage.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/master/source/develop/release-management/features/gluster/gluster-multiple-bricks-per-storage.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
