<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Trusted compute pools deployment | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Trusted compute pools deployment" />
<meta name="author" content="Dave Chen" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/3043/develop/sla/trusted-compute-pools-deployment.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/3043/develop/sla/trusted-compute-pools-deployment.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Trusted compute pools deployment" />
<meta name="twitter:site" content="@ovirt" />
<meta name="twitter:creator" content="@Dave Chen" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Dave Chen"},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"Trusted compute pools deployment","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/3043/images/logo.svg"},"name":"Dave Chen"},"url":"https://ovirt.github.io/ovirt-site/previews/3043/develop/sla/trusted-compute-pools-deployment.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/3043/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/3043/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/3043/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/3043/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/3043/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/3043/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3043/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3043/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3043/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3043/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3043/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/3043/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/3043/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/3043/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/3043/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/3043/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/3043/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/3043/images/logo.svg" />      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav" role="menubar">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/3043/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3043/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/3043/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3043/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3043//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3043//blogs.ovirt.org/'>Blog</a></li>        </ul>      </div>      <!-- /.navbar-collapse -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3043/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3043/develop/">
              <span property="name">Developers Community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3043/develop/sla/">
              <span property="name">Sla</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/fe6d34efb1119bb7bd9f2445111c7727?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/fe6d34efb1119bb7bd9f2445111c7727?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Dave Chen">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Dave Chen</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/8208edfa41f5f2c8b818bf034e96a4ce?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/8208edfa41f5f2c8b818bf034e96a4ce?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Gianluca Cecchi">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Gianluca Cecchi</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/dfb71d7f85c197ae5a93e551bf9131dc?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/dfb71d7f85c197ae5a93e551bf9131dc?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Gang Wei">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Gang Wei</span></p>
                      
                    </section>
                  </div>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Much of this developer documentation provides historical context but may not reflect the current state of the project.<br>If you see outdated content please navigate to the page footer and click "<strong>Report an issue on GitHub</strong>".<br><br>It is <strong>not</strong> user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/3043/documentation/'>User Documentation is available here.</a></div>

<p>This is a manual for how to deploy trusted compute pools feature in oVirt.</p>

<h1 id="trusted-compute-pools-deployment">Trusted Compute Pools deployment</h1>

<h2 id="owner">Owner</h2>

<ul>
  <li>Name: <a href="User:gwei3"> Gang Wei</a></li>
  <li>Last updated date: May 24, 2013</li>
  <li>Email: <a href="mailto:gang.wei@intel.com">gang.wei@intel.com</a></li>
</ul>

<h2 id="deploy-attestation-service">Deploy Attestation Service</h2>

<p>Two approaches (all-in-one packages for f18, yum install in f19) are provided to deploy Attestation Service. Install via yum command will be available after oat package is merged in fedora 19 repository(WIP).
pls note:
* we encourage you to disable iptables | firewalld service, instead, config iptable to accept 8443 port, add follow line into “/etc/sysconfig/iptables”</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  -A INPUT -p tcp -m state --state NEW -m tcp --dport 8443 -j ACCEPT
</code></pre></div></div>

<ul>
  <li>
    <p>set selinux to permissive or disabled mode, config selinux in “/etc/selinux/config”, eg</p>

    <p>SELINUX=permissive</p>
  </li>
  <li>
    <p>oat package was not able to be pushed into fedora 18 since some dependencies can’t be pushed in f18.</p>
  </li>
</ul>

<h3 id="install-basic-packages-for-all-in-one-approach">Install basic packages (for all-in-one approach)</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  # yum -y install httpd mysql mysql-server php php-mysql openssl java-1.7.0-openjdk.x86_64
</code></pre></div></div>

<h3 id="install-attestation-server-package">Install Attestation Server Package</h3>

<ul>
  <li>Install all-in-one package</li>
</ul>

<p>Download <a href="http://gwei3.fedorapeople.org/package_review/oat/v1/oat-appraiser-1.6.0-1.fc18.x86_64.rpm">oat-appraiser</a> rpm package, and then</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  # rpm -i oat-appraiser-1.6.0-1.fc18.x86_64.rpm
</code></pre></div></div>

<ul>
  <li>
    <p>Yum Install oat server package from fedora19 repository</p>

    <p># yum install oat-appraiser</p>
  </li>
  <li>
    <p>make sure tomcat is running after package installation, otherwise, start tomcat service manually.</p>

    <p># service tomcat6 status (check status)
  # service tomcat6 start (start service)</p>
  </li>
</ul>

<h3 id="generate-client-files">Generate Client Files</h3>

<p>Generate client files after installing oat-appraiser package, execute this command is enough.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  bash /usr/share/oat-appraiser/OAT_configure.sh
</code></pre></div></div>

<p>Client files will be output in this directory “/var/lib/oat-appraiser/ClientFiles/”. Part of these files are needed in agent’s side.</p>

<h2 id="deploy-host-agent-on-vds">Deploy Host Agent on VDS</h2>

<p>Two approaches (all-in-one packages for f18, yum install in f19) are provided to deploy Host Agent.</p>

<h3 id="install-fedora-for-legacy-boot">Install Fedora for Legacy Boot</h3>

<p>The Fedora18/19 x86-64 system should be installed to run in legacy boot instead of EFI boot. Many new systems will by default boot as EFI boot, so you need to explicitly boot the installation media (DVD or USB) with legacy mode. Below is a example on HP8300:</p>

<ul>
  <li>at the beginning of booting, ESC, enter setup password, F9 -&gt; Boot Menu -&gt; legacy boot from DVD</li>
  <li>install Fedora18/19 x86-64 from DVD</li>
</ul>

<h3 id="enable-intel-txt-in-bios">Enable Intel® TXT in BIOS</h3>

<p>Client system must have TPM 1.2 compliant device with driver installed, and TPM/TXT enabled in BIOS to perform the operation. Below is a example for HP8300 system:</p>

<ul>
  <li>Power on, ESC key -&gt; Startup Menu -&gt; Computer Setup(F10)</li>
  <li>Security-&gt;Setup Password, set setup password as xxxxxx then F10 save it.</li>
  <li>Security-&gt;System Security, enable vtx/vtd/Embeded Security Device/Trusted Execution Technology, F10 save it.</li>
  <li>File-&gt;Save Changes and Exit.</li>
</ul>

<h3 id="install-tpm-driver">Install TPM Driver</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  # yum install kernel-modules-extra
</code></pre></div></div>

<p>Reboot system and verify that /dev/tpm0 existed. Make sure the installed kernel-modules-extra version is the same with the kernel are you using, otherwise upgrade to a new kernel version.</p>

<h3 id="install-tboot">Install tboot</h3>

<p>Download corresponding sinit zip package from below url, copied the .BIN in it to /boot. (SKIP this step on server platforms)</p>

<ul>
  <li><a href="http://software.intel.com/en-us/articles/intel-trusted-execution-technology/">http://software.intel.com/en-us/articles/intel-trusted-execution-technology/</a> . Notes: for hp8300, we use 3rd_gen_i5_i7_SINIT_51.zip</li>
</ul>

<p>Install tboot:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  # yum install trousers-devel tpm-tools tboot
  # service tcsd enable
  # service tcsd restart
</code></pre></div></div>

<p>Reboot machine and select tboot option in GRUB menu at start of booting.</p>

<p>Check the PCR values in TPM via the sysfs interface provided by TPM driver, make sure PCR-17~19 are not all FFs.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  # find /sys/ -name pcrs
  /sys/devices/pnp0/00:0b/pcrs
  # cat /sys/devices/pnp0/00:0b/pcrs
  PCR-00: D8 FE 91 C4 10 E7 A3 F9 CA D8 C0 5F 42 AC 2D DF F7 07 90 2E
  PCR-01: 6E D4 2B 10 83 A4 8B CA 06 39 4D B0 8A DE CC 10 37 A6 06 36
  PCR-02: E2 30 5E E6 53 B1 7B 56 D9 50 9D 6F BF 6C F7 39 7F A6 9F E6
  PCR-03: 3A 3F 78 0F 11 A4 B4 99 69 FC AA 80 CD 6E 39 57 C3 3B 22 75
  PCR-04: 85 A3 4B 48 B7 67 4C 70 C3 CD FD 17 AA ED 47 33 27 C2 B3 B0
  PCR-05: 98 6D 5A 1B 4D 6D 33 81 A2 2C 81 77 2E 07 74 26 90 A4 AE 28
  PCR-06: 78 CD 77 59 86 6A 77 D0 31 03 C2 03 5B F7 DC 7E 61 DC 19 2E
  PCR-07: 3A 3F 78 0F 11 A4 B4 99 69 FC AA 80 CD 6E 39 57 C3 3B 22 75
  PCR-08: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  PCR-09: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  PCR-10: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  PCR-11: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  PCR-12: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  PCR-13: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  PCR-14: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  PCR-15: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  PCR-16: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  PCR-17: 35 BF 8A 0E 18 53 EB 62 70 7F F2 18 CE 29 01 B9 EF 18 0A 6C
  PCR-18: CE 79 6B D8 8E 58 89 05 34 CF 61 31 57 1D 5A F6 52 29 3E 55
  PCR-19: EA E2 9F E2 5A 52 C9 36 3B 50 40 F5 8B 6D ED C6 E7 1C F6 29
  PCR-20: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  PCR-21: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  PCR-22: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  PCR-23: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
</code></pre></div></div>

<h3 id="install-basic-packages-for-all-in-one-approach-1">Install basic Packages (for all-in-one approach)</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  # yum -y install trousers-devel java-1.7.0-openjdk
</code></pre></div></div>

<p>Make sure the TrouSers service is started before moving on. Service name is “tcsd”</p>

<h3 id="install-host-agent-package">Install Host Agent Package</h3>

<ul>
  <li>Install all-in-one package</li>
</ul>

<p>Download <a href="http://gwei3.fedorapeople.org/package_review/oat/v1/oat-client-1.6.0-1.fc18.x86_64.rpm">oat-client</a> rpm package, and then</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  # rpm -i oat-client-1.6.0-1.fc18.x86_64.rpm
</code></pre></div></div>

<ul>
  <li>
    <p>Yum Install oat client package from fedora19 repository</p>

    <p># yum install oat-client</p>
  </li>
</ul>

<h3 id="file-copying-and-agent-registration">File copying and Agent Registration</h3>

<p>Copy “PrivacyCA.cer” and “TrustStore.jks” from server side to agent side. Find these files under this directory (server side):</p>

<ul>
  <li>/var/lib/oat-appraiser/ClientFiles</li>
</ul>

<p>Copy them to this directory (agent side):</p>

<ul>
  <li>/usr/share/oat-client</li>
</ul>

<p>Register host agent, make sure dialog package has been installed on your system.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  # cd /usr/share/oat-client/script
  # bash provisioner.sh
</code></pre></div></div>

<p>You will be required to input the host name of oat server
note:
pls input the host name of oat server, including the domain suffix
pls input the host name instead of the IP address of oat server (IP address is not supported in oat’s current release)</p>

<p>Start oat client service, make sure TrouSers service is running</p>

<ul>
  <li>
    <p>all-in-one approach</p>

    <p># chmod 755 /etc/init.d/OATClient 
  # service OATClient start</p>
  </li>
  <li>
    <p>yum install approach</p>

    <p># service oat-client start</p>
  </li>
</ul>

<h2 id="install-oat-command-tool">Install oat-command tool</h2>

<ul>
  <li>Install all-in-one package</li>
</ul>

<p>Download <a href="http://gwei3.fedorapeople.org/package_review/oat/v1/oat-commandtool-1.6.0-1.fc18.x86_64.rpm">oat-commandtool</a> rpm package, and then</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  # rpm -i oat-commandtool-1.6.0-1.fc18.x86_64.rpm
</code></pre></div></div>

<ul>
  <li>
    <p>Yum Install oat-commandtool package from fedora19 repository.</p>

    <p># yum install oat-commandtool</p>
  </li>
</ul>

<p>You will find below 11 scripts in “/usr/bin” directory:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  # ls /usr/bin/oat_*
  oat_cert  oat_host  oat_mle  oat_mle_search  oat_oem  oat_os  oat_pcrwhitelist  oat_pollhosts  oat_view_mle  oat_view_oem  oat_view_os
</code></pre></div></div>

<h2 id="provision-white-list-database">Provision White List Database</h2>

<p>At least OEM, OS, MLE, and HOST information should be added to Attestation Server’s White List database.</p>

<p>Follow below exmaple to make a oVirt node recognized as “trusted” by the attestation service. (execute this command in “/usr/bin” directory):</p>

<ul>
  <li>
    <p>Generate certification:</p>

    <p># bash oat_cert  -h oatserver.*.com</p>
  </li>
</ul>

<p>Notes: oatserver.*.com should be the host name of oat server.</p>

<ul>
  <li>
    <p>Add OEM:</p>

    <p># bash oat_oem -a -h oatserver.*.com ‘{“Name”:”OEM1”,”Description”:”Newdescription”}’</p>
  </li>
  <li>
    <p>Add OS:</p>

    <p># bash oat_os -a -h oatserver.*.com ‘{“Name”:”OS1”,”Version”:”v1”,”Description”:”Test1”}’</p>
  </li>
  <li>
    <p>Add VMM type MLE</p>

    <p># bash oat_mle -a -h oatserver.*.com ‘{“Name”:”NewMLE2”,”Version”:”v123”,”OsName”:”OS1”,”OsVersion”:”v1”,”Attestation_Type”: “PCR”,”MLE_Type”:”VMM”,”Description”:”Test”,”MLE_Manifests”: [{“Name”: “18”,  “Value”: “CE796BD88E58890534CF6131571D5AF652293E55”}]}’</p>
  </li>
</ul>

<p>Notes: “18” means PCR 18, the value could be got via “# cat /sys/…/pcrs” on oat agent system, but the space chars should be removed first.</p>

<ul>
  <li>
    <p>Add BIOS type MLE</p>

    <p># bash oat_mle -a -h oatserver.*.com ‘{“Name”:”NewMLE1”,”Version”:”v123”,”OemName”:”OEM1”,”Attestation_Type”: “PCR”,”MLE_Type”:”BIOS”,”Description”:”MLETest1111”,”MLE_Manifests”: [{“Name”: “0”,  “Value”: “D8FE91C410E7A3F9CAD8C05F42AC2DDFF707902E”}]}’</p>
  </li>
</ul>

<p>Notes: “0” means PCR 0, the value could be got via “# cat /sys/…/pcrs” on oat agent system, but the space chars should be removed first.</p>

<ul>
  <li>
    <p>Add HOST</p>

    <p># bash oat_host -a -h oatserver.<em>.com ‘{“HostName”:”agent.</em>.com”,”IPAddress”:”192.168.1.1”,”Port”:”9999”,”BIOS_Name”:”NewMLE1”,”BIOS_Version”:”v123”,”BIOS_Oem”:”OEM1”,”VMM_Name”:”NewMLE2”,”VMM_Version”:”v123”,”VMM_OSName”:”OS1”,”VMM_OSVersion”:”v1”,”Email”:””,”AddOn_Connection_String”:””,”Description”:””}’</p>
  </li>
</ul>

<p>Notes: by far, “IPAddress” and “Port” are not really used, so just leave a placeholder there. “HostName”:”agent.*.com” should be the host name of the oat agent (same as what hostname cmd returns on the oat agent system).</p>

<ul>
  <li>
    <p>query the trust state of the node</p>

    <p># bash oat_pollhosts -h oatserver.<em>.com ‘{“hosts”:[“agent.</em>.com”]}’</p>
  </li>
</ul>

<p>Once you got response like below the you can continue to configure oVirt engine for TCP:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  {"hosts":[{"host_name":"agent.*.com","trust_lvl":"trusted","vtime":"2013-05-16T14:14:44.881+08:00"}]}
</code></pre></div></div>

<h2 id="configuration-in-ovirt-engine">Configuration in oVirt Engine</h2>

<p>User may want to configure vdc_options to overwrite the default values, these configurations include:</p>

<table>
  <thead>
    <tr>
      <th>options</th>
      <th>default value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>SecureConnectionWithOATServers</td>
      <td>true</td>
    </tr>
    <tr>
      <td>PollUri</td>
      <td>AttestationService/resources/PollHosts</td>
    </tr>
    <tr>
      <td>AttestationTruststore</td>
      <td>TrustStore.jks</td>
    </tr>
    <tr>
      <td>AttestationPort</td>
      <td>8443</td>
    </tr>
    <tr>
      <td>AttestationServer</td>
      <td>oat-server</td>
    </tr>
    <tr>
      <td>AttestationTruststorePass</td>
      <td>password</td>
    </tr>
    <tr>
      <td>AttestationFirstStageSize</td>
      <td>10</td>
    </tr>
  </tbody>
</table>

<ul>
  <li>Copy “TrustStore.jks” from attestation server to engine server, find the file in the directory of “/var/lib/oat-appraiser/Certificate/”. For the environment setup by “yum install”, please copy “TrustStore.jks” into “/usr/share” of engine server, for the environment setup by source code, please copy “TrustStore.jks” into “/etc/engine/ca/” of engine server.</li>
  <li>
    <p>Overwrite the default values. Currently, only attestation server must be specified and modified, for other options, it is okay with the default value, please follow these script to modify “AttestationServer” :</p>

    <p>insert into vdc_options (option_name, option_value) values (‘ AttestationServer’,’oat-server’);
  update vdc_options set option_value = ‘oat-server. ***.com’ where option_name = ‘AttestationServer’</p>
  </li>
</ul>



        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/3043/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/3043/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/3043/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/3043/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/sla/trusted-compute-pools-deployment.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/main/source/develop/sla/trusted-compute-pools-deployment.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
