<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Gluster Volume Asynchronous Tasks Management | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Gluster Volume Asynchronous Tasks Management" />
<meta name="author" content="Dusmant Kumar Pati" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/2853/develop/release-management/features/gluster/gluster-volume-asynchronous-tasks-management.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/2853/develop/release-management/features/gluster/gluster-volume-asynchronous-tasks-management.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Gluster Volume Asynchronous Tasks Management" />
<meta name="twitter:site" content="@ovirt" />
<meta name="twitter:creator" content="@Dusmant Kumar Pati" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Dusmant Kumar Pati"},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"Gluster Volume Asynchronous Tasks Management","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/2853/images/logo.svg"},"name":"Dusmant Kumar Pati"},"url":"https://ovirt.github.io/ovirt-site/previews/2853/develop/release-management/features/gluster/gluster-volume-asynchronous-tasks-management.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/2853/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/2853/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/2853/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/2853/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/2853/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/2853/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2853/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2853/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2853/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2853/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2853/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/2853/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/2853/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/2853/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/2853/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/2853/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/2853/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/2853/images/logo.svg">      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/2853/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2853/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/2853/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2853/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2853//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2853//blogs.ovirt.org/'>Blog</a></li>              </ul>          </div>          <!-- /.navbar-collapse -->      </div>      <!-- /.container-fluid -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2853/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2853/develop/">
              <span property="name">Developers Community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2853/develop/release-management/">
              <span property="name">Release Management</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2853/develop/release-management/features/">
              <span property="name">Features (Design documents)</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2853/develop/release-management/features/gluster/">
              <span property="name">Gluster</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/6c55497f23a52d218254702feefae28a?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/6c55497f23a52d218254702feefae28a?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Dusmant Kumar Pati</span></p>
                      
                    </section>
                  </span>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/ad6a629dcee77b9544df139f8407510f?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/ad6a629dcee77b9544df139f8407510f?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Kanagaraj Mayilsamy</span></p>
                      
                    </section>
                  </span>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/450b77aa4b277aa954e42c0cbaed64f1?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/450b77aa4b277aa954e42c0cbaed64f1?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Sahina Bose</span></p>
                      
                    </section>
                  </span>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/bc7a1e6e655b766ad1553b35c30cc83b?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/bc7a1e6e655b766ad1553b35c30cc83b?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Shireesh Anjal</span></p>
                      
                    </section>
                  </span>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Feature pages are design documents that developers have created while collaborating on oVirt.<br><br>Most of them are&nbsp;<strong>outdated</strong>, but provide historical design context.<br><br>They are&nbsp;<strong>not</strong>&nbsp;user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/2853/documentation/'>Documentation is available here.</a></div>

<h1 id="gluster-volume-asynchronous-tasks-management">Gluster Volume Asynchronous Tasks Management</h1>

<h2 id="summary">Summary</h2>

<p>This feature provide the support for managing the asynchronous tasks on Gluster volumes.</p>

<h2 id="owner">Owner</h2>

<ul>
  <li>Feature owner: Sahina Bose <a href="mailto:sabose@redhat.com">sabose@redhat.com</a>
    <ul>
      <li>GUI Component owner: Kanagaraj Mayilsamy <a href="mailto:kmayilsa@redhat.com">kmayilsa@redhat.com</a></li>
      <li>Engine Component owner: Sahina Bose <a href="mailto:sabose@redhat.com">sabose@redhat.com</a></li>
      <li>VDSM component owner: Balamurugan Arumugam <a href="mailto:barumuga@redhat.com">barumuga@redhat.com</a></li>
      <li>REST component owner: Sahina Bose <a href="mailto:sabose@redhat.com">sabose@redhat.com</a></li>
      <li>QA Owner: Sudhir Dharanendraiah <a href="mailto:sdharane@redhat.com">sdharane@redhat.com</a></li>
    </ul>
  </li>
</ul>

<h2 id="current-status">Current Status</h2>

<ul>
  <li>Status: Completed</li>
  <li>Last updated date: ,</li>
  <li>Requires : glusterfs &gt;= 3.5</li>
</ul>

<h2 id="detailed-description">Detailed Description</h2>

<p>Support managing the following gluster operations that run asynchronously, from the oVirt UI</p>

<ul>
  <li>Rebalance volume</li>
  <li>Remove brick</li>
</ul>

<p>User should be able to start any of these operations as follows:</p>

<ul>
  <li>Select a volume and click on the button “Start Rebalance”</li>
  <li>Select a brick and click on the button “Remove”
    <ul>
      <li>When removing a brick, select/un-select a checkbox “Migrate data”. If selected, the remove brick operation will be triggered in asynchronous fashion by first migrating the data from the brick to be removed.This is the default option. If not checked, the remove is performed with the “force” option to “gluster volume remove-brick” command. This is a synchronous operation</li>
    </ul>
  </li>
</ul>

<p><strong>Task Monitoring</strong></p>

<ul>
  <li>Tasks can be monitored using the Tasks sub-tab in the bottom pane of the UI</li>
  <li>A child step is added to the Executing step, the status of which is periodically updated for as long as the task is in progress</li>
  <li>If rebalance or remove-brick operations are started from the Gluster CLI, these can also be monitored using the Tasks sub-tab. A job entry is created for any such operation which is associated with the gluster task id.</li>
  <li>User can also check the status of the task from the Volume/Bricks tabs by selecting the volume/brick.</li>
</ul>

<p><strong>Task Operations</strong></p>

<p>Once started, a rebalance volume or remove-brick can be stopped while in progress. This can be done from the Volumes/Bricks tab depending on the operation.</p>

<ul>
  <li>For rebalance volume, clicking on the volume which is being rebalanced will enable a UI option to stop the task</li>
  <li>For remove brick, clicking on one or more bricks that have a remove brick operation in progress will enable a UI option to stop the task.</li>
</ul>

<h2 id="dependencies--related-features">Dependencies / Related Features</h2>

<h2 id="user-flows">User Flows</h2>

<p>User flow that’s given in “Rebalance Volume” and “Remove Brick” section, has been slightly altered after the UX team’s review. Though the functionality remains same, the menu and flows have been altered.</p>

<p><strong>Pls. take a look at the flow description ( no images attached - only description ) given bellow to know the changes…</strong> Rebalance Operation related UI modifications</p>

<p>Now the “Rebalance” menu does not have any of the Start, Stop and Status sub-menu. And this menu would come before the “Optimization for Virt Store”.</p>

<p>To Start Rebalance operation on a volume: User goes to the volume tab and selects one or more volume and clicks the “Rebalance” menu (Note : Rebalance menu will not be activated, when no row in the Volume table is selected. Currently no default row is selected when the user comes to the volume page ). This will start the rebalance operation on the selected Volume(s) and the “Activities” column for those volume will show an icon indicating that the rebalance operation is on progress on those volumes. The rebalance-progress icon will be changed to rebalance-completed-successfully icon, once the rebalance task on the volume is finished successfully. If the rebalance operation fails on any of the selected volumes, then the icon will change to rebalance-fail icon. If all the bricks of the selected volume is down ( volume status is shown with yellow-exclamation mark ), then the pressing Rebalance menu would give a proper warning, saying rebalance operation can not be started.</p>

<p>The rebalance progress icon, will also have a drop down arrow, which can be clicked by the end user to get the context sensitive menu. Upon clicking that, a menu will be shown. If the rebalance operation is in-progress on the volume, then the following two menu items will be shown. “Stop” and “Status”. Otherwise, it will show only the “Status” menu.</p>

<p>If the user clicks the “Stop” menu, user will be given a confirmation dialogue, which would ask “Do you want to stop the rebalance operation on the selected volume?”. If the user presses the “Yes”, then the rebalance operation on that volume will be stopped and rebalance-status dialogue will be shown (no change in status dialogue). If the user presses the “No” button, then the rebalance operation will not be stopped and this dialogue will be closed.</p>

<p>If the user clicks the “Status” menu, then rebalance-status dialogue will be shown (it will be same as already given description bellow)</p>

<p>Smilarly the Remove brick</p>

<p>Few other items, that are modified in the course of Corbett are as follows : There is not a whole lot of change, but it makes sense to have them captured….</p>

<ol>
  <li>
    <p>When one or more brick is down in a volume, volume status would be shown as Yellow-Up arrow ( volume service is still up )</p>
  </li>
  <li>
    <p>If all the bricks are down in a volume, volume status would be shown as Yellow-Up Arrow + Yellow-exclamation mark ( volume service is till up )</p>
  </li>
</ol>

<h3 id="rebalance-volume">Rebalance Volume</h3>

<ul>
  <li>Users can initiate a rebalance operation on a volume using the following UI</li>
</ul>

<p><img src="/ovirt-site/previews/2853/images/wiki/Start_vol_rebalance.png" alt="" /></p>

<ul>
  <li>If volume rebalance is in progress, the UI will be updated as follows:</li>
</ul>

<p><img src="/ovirt-site/previews/2853/images/wiki/View_vol_rebalance.png" alt="" /></p>

<ul>
  <li>
    <ul>
      <li>The icon in the Activities column indicates that “Rebalance” operation is in progress</li>
      <li>User can check status/ stop operation from the Rebalance menu. Rebalance –&gt; Start, Rebalance –&gt; Stop</li>
      <li>The tasks tab in the bottom pane is updated periodically with short summary status of task</li>
      <li><strong>\1</strong></li>
    </ul>
  </li>
</ul>

<!-- -->

<ul>
  <li>User can check the detailed status of the rebalance operation using Rebalance –&gt; Status, which will invoke the following UI</li>
</ul>

<p><img src="/ovirt-site/previews/2853/images/wiki/Vol_rebalance_status.png" alt="" /></p>

<ul>
  <li>
    <ul>
      <li>The status dialog gets refreshed automatically (a periodic refresh for as long as dialog is open) When the rebalance operation is done, it would also append the string “(Rebalance Completed)” to ‘Status at’ field.</li>
      <li>User can stop rebalance from the status window by clicking on “Stop Rebalance” button. User will be prompted for confirmation and after confirmation, it will stop the rebalance operation and show the Stop dialog as below</li>
    </ul>
  </li>
</ul>

<!-- -->

<ul>
  <li>To stop, the rebalance operation, user can use the Rebalance –&gt; Stop option, which will ask for confirmation and once stopped display the status of rebalance operation as below:</li>
</ul>

<p><img src="/ovirt-site/previews/2853/images/wiki/Stop_vol_rebalance.png" alt="" /></p>

<h3 id="remove-brick">Remove Brick</h3>

<ul>
  <li>Remove Brick can be initiated from the Bricks sub tab as below:</li>
</ul>

<p><img src="/ovirt-site/previews/2853/images/wiki/StartRemovebrick.png" alt="" /></p>

<ul>
  <li>
    <ul>
      <li>In Gluster CLI, remove brick is a two-step process - where data is first migrated using <strong>remove-brick start</strong> and then user calls <strong>remove-brick commit</strong> to remove the brick</li>
      <li>In the engine UI, once a user clicks on Remove -&gt; Start, he/she is presented with a dialog that has 2 checkboxes
        <ul>
          <li>Migrate data from bricks is ON by default. This is needed to ensure data migration before brick is removed. If unchecked, the engine will call a remove-brick force, which could lead to data loss on the bricks being removed</li>
          <li>Auto commit. If checked, once the migration of data is complete, the engine will automatically call commit on remove-brick in CLI, which removes the brick.</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<!-- -->

<ul>
  <li>
    <ul>
      <li>If the user chooses to Remove brick without auto commit option, once migration of data is complete, the Tasks tab is updated with message that user needs to commit for the remove brick operation to take effect.</li>
    </ul>
  </li>
</ul>

<!-- -->

<ul>
  <li>Once remove brick operation is started, the UI is updated as follows (similar to Rebalance volume in progress)</li>
</ul>

<p><img src="/ovirt-site/previews/2853/images/wiki/Removebrickview.png" alt="" /></p>

<ul>
  <li>'’UX input required - Need a way in Bricks sub tab to indicate that remove brick is in progress on one or more bricks - Icon or colour coding rows? ‘’</li>
  <li>User can check the detailed status of the remove brick operation using Remove –&gt; Status (it will invoke a UI similar to volume rebalance status)</li>
</ul>

<p><img src="/ovirt-site/previews/2853/images/wiki/Removebrickstatus.png" alt="" /></p>

<ul>
  <li>
    <ul>
      <li>The dialog is periodically refreshed when open. If Migration of data is complete, the commit button will be enabled.</li>
      <li>User can choose to stop the remove brick operation by clicking on the “Stop Remove” button. This will ask for confirmation and display the Stop dialog as below</li>
    </ul>
  </li>
</ul>

<!-- -->

<ul>
  <li>To stop the remove brick operation while in progress, user can use the Remove –&gt; Stop option. This will ask for confirmation, and if confirmed will display a dialog as below</li>
</ul>

<p><img src="/ovirt-site/previews/2853/images/wiki/Removebrickstop.png" alt="" /></p>

<h2 id="detailed-design">Detailed Design</h2>

<p>Please see <a href="/ovirt-site/previews/2853/develop/release-management/features/gluster/detailed-gluster-volume-asynchronous-tasks-management.html">Detailed Gluster Volume Asynchronous Tasks Management</a></p>




        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/2853/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/2853/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/2853/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/2853/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/release-management/features/gluster/gluster-volume-asynchronous-tasks-management.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/master/source/develop/release-management/features/gluster/gluster-volume-asynchronous-tasks-management.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
