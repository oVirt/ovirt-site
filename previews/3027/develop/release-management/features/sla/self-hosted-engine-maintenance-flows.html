<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Self Hosted Engine Maintenance Flows | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Self Hosted Engine Maintenance Flows" />
<meta name="author" content="Greg Padgett" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/3027/develop/release-management/features/sla/self-hosted-engine-maintenance-flows.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/3027/develop/release-management/features/sla/self-hosted-engine-maintenance-flows.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Self Hosted Engine Maintenance Flows" />
<meta name="twitter:site" content="@ovirt" />
<meta name="twitter:creator" content="@Greg Padgett" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Greg Padgett"},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"Self Hosted Engine Maintenance Flows","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/3027/images/logo.svg"},"name":"Greg Padgett"},"url":"https://ovirt.github.io/ovirt-site/previews/3027/develop/release-management/features/sla/self-hosted-engine-maintenance-flows.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/3027/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/3027/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/3027/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/3027/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/3027/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/3027/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3027/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3027/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3027/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3027/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3027/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/3027/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/3027/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/3027/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/3027/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/3027/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/3027/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/3027/images/logo.svg" />      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav" role="menubar">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/3027/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3027/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/3027/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3027/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3027//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3027//blogs.ovirt.org/'>Blog</a></li>        </ul>      </div>      <!-- /.navbar-collapse -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3027/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3027/develop/">
              <span property="name">Developers Community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3027/develop/release-management/">
              <span property="name">Release Management</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3027/develop/release-management/features/">
              <span property="name">Features (Design documents)</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3027/develop/release-management/features/sla/">
              <span property="name">Sla</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/bd7754652a65e36e7c7f7672f59bf1fe?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/bd7754652a65e36e7c7f7672f59bf1fe?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Greg Padgett">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Greg Padgett</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/db6bc448daa2b0b1315b0184bbcc9b77?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/db6bc448daa2b0b1315b0184bbcc9b77?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Maor Lipchuk">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Maor Lipchuk</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/65fafd7adcef0c369b149759491fae7f?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/65fafd7adcef0c369b149759491fae7f?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Sandro Bonazzola">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard"><a rel="author" href="https://twitter.com/sandrobonazzola" title="Sandro Bonazzola">Sandro Bonazzola</a></span></p>
                      
                    </section>
                  </div>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Feature pages are design documents that developers have created while collaborating on oVirt.<br><br>Most of them are&nbsp;<strong>outdated</strong>, but provide historical design context.<br><br>They are&nbsp;<strong>not</strong>&nbsp;user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/3027/documentation/'>Documentation is available here.</a></div>

<h1 id="self-hosted-engine-maintenance-flows">Self Hosted Engine Maintenance Flows</h1>

<h2 id="hosted-engine-maintenance-flow-unification">Hosted Engine Maintenance Flow Unification</h2>

<h3 id="summary">Summary</h3>

<p>Make maintenance operations easier on hosted engine clusters and their participating nodes by providing a method to initiate HA maintenance from the engine UI.</p>

<h3 id="owner">Owner</h3>

<ul>
  <li>Featue Owner: Greg Padgett (gpadgett)</li>
</ul>

<h3 id="current-status">Current status</h3>

<ul>
  <li>Design and initial implementation</li>
</ul>

<h3 id="detailed-description">Detailed Description</h3>

<p>Today, the Hosted Engine functionality is mainly monitored and controlled on the command line. The host status (HA or not) and score is reported to the engine, but further information is lacking.</p>

<p>The aim of this feature is to make management of a hosted engine setup easier. We’ll do this by reporting additional information about the hosted engine system to the engine, and by allowing the engine to control the hosted engine maintenance modes. Both of these goals require changes in the VDSM as well as ovirt-engine.</p>

<h4 id="display-of-additional-information">Display of Additional Information</h4>

<p>New fields will be returned to the engine through VDSM’s getVdsStats call (under a new parent member in the result, ‘haStatus’) and stored in the vds_statistics table:</p>

<ul>
  <li>ha_configured - HA is installed on the host</li>
  <li>ha_active - HA is currently running/updating on the host</li>
  <li>ha_global_maintenance - HA global maintenance is enabled according to the host</li>
  <li>ha_local_maintenance - HA local maintenance is enabled on the host</li>
  <li>ha_score - (Existing field) Host score</li>
</ul>

<p>The engine UI will display a summary of this information in the Host &gt; General tab for each selected host as follows:</p>

<ul>
  <li>Hosted Engine HA: Active (score: xxxx) &lt;- If the agent is configured and active</li>
  <li>Hosted Engine HA: Not Active &lt;- If the agent is configured but not active</li>
  <li>Hosted Engine HA: [Local/Global] Maintenance Enabled &lt;- Maintenance enabled</li>
  <li>(No entry will show up if not configured)</li>
</ul>

<h4 id="maintenance-commands">Maintenance Commands</h4>

<p>The two types of HA maintenance will be configured in different ways.</p>

<p>Local maintenance, which affects only the host on which it is enabled, will be tied into the existing VDS maintenance operation. This will be initiated in the engine bll layer. Upon enabling host maintenance, if HA is configured, a command will be sent to the Hosted Engine agent through VDSM to enable local maintenance. Upon activating the host, the converse will occur and local HA maintenance will be disabled. (Note that it is possible for the host and HA states to become out of sync; this should be discoverable in the host status field and fixable via the command line or by de-/re-activating the host.)</p>

<p>Global maintenance affects the entire HA cluster, for which there isn’t a perfect 1:1 representation in the engine. Due to this, along with the fact that global HA maintenance is enabled/disabled via commands run on the hosts, the operation in the UI is also tied to the hosts. To enable or disable global maintenance, new items will be available in each host’s context (right-click) menu. These will follow a similar pattern to local maintenance, sending a command to the HA Agent through VDSM.</p>

<p>In each case above, the HA maintenance state will be reflected in the Host &gt; General tab.</p>

<h3 id="dependencies--related-features">Dependencies / Related Features</h3>

<p><a href="/ovirt-site/previews/3027/develop/release-management/features/sla/self-hosted-engine.html">Self_Hosted_Engine</a></p>




        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/3027/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/3027/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/3027/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/3027/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/release-management/features/sla/self-hosted-engine-maintenance-flows.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/main/source/develop/release-management/features/sla/self-hosted-engine-maintenance-flows.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
