<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>DetailedPMHealthCheck | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="DetailedPMHealthCheck" />
<meta name="author" content="Eli Mesika" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/2952/develop/release-management/features/infra/detailedpmhealthcheck.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/2952/develop/release-management/features/infra/detailedpmhealthcheck.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="DetailedPMHealthCheck" />
<meta name="twitter:site" content="@ovirt" />
<meta name="twitter:creator" content="@Eli Mesika" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Eli Mesika"},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"DetailedPMHealthCheck","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/2952/images/logo.svg"},"name":"Eli Mesika"},"url":"https://ovirt.github.io/ovirt-site/previews/2952/develop/release-management/features/infra/detailedpmhealthcheck.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/2952/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/2952/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/2952/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/2952/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/2952/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/2952/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2952/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2952/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2952/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2952/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2952/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/2952/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/2952/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/2952/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/2952/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/2952/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/2952/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/2952/images/logo.svg">      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/2952/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2952/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/2952/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2952/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2952//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2952//blogs.ovirt.org/'>Blog</a></li>              </ul>          </div>          <!-- /.navbar-collapse -->      </div>      <!-- /.container-fluid -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2952/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2952/develop/">
              <span property="name">Developers Community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2952/develop/release-management/">
              <span property="name">Release Management</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2952/develop/release-management/features/">
              <span property="name">Features (Design documents)</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2952/develop/release-management/features/infra/">
              <span property="name">Infra</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/d75560fd509444e4cbc70734dffa0673?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/d75560fd509444e4cbc70734dffa0673?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Eli Mesika</span></p>
                      
                    </section>
                  </span>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/d23ba59f40f03f1390a8bbe87e4a8060?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/d23ba59f40f03f1390a8bbe87e4a8060?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Gilad Chaplik</span></p>
                      
                    </section>
                  </span>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Feature pages are design documents that developers have created while collaborating on oVirt.<br><br>Most of them are&nbsp;<strong>outdated</strong>, but provide historical design context.<br><br>They are&nbsp;<strong>not</strong>&nbsp;user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/2952/documentation/'>Documentation is available here.</a></div>

<h1 id="detailed-pm-health-check">Detailed PM Health Check</h1>

<h2 id="power-management-health-check">Power Management Health Check</h2>

<h3 id="summary">Summary</h3>

<p>The requirement is to add a periodic health check of all Hosts with configured PM
The scheduled job will try to send a status command to all PM enabled hosts periodically (once an-hour by default) and raise alerts for failed operations</p>

<h3 id="owner">Owner</h3>

<p>Feature owner: Eli Mesika (emesika)
Engine Component owner: Eli Mesika (emesika)
QA Owner: Pavel Stehlik (pstehlik)
Email: emesika@redhat.com</p>

<h3 id="current-status">Current status</h3>

<ul>
  <li>Target Release: 3.5</li>
  <li>Status: Design</li>
  <li>Last updated date: MAY 3 2014</li>
</ul>

<h3 id="detailed-description">Detailed Description</h3>

<p>Add a class PmHealtCheckManager to handle the scheduled check
This class will</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Read the related configuration values(see Configuration) and if feature is enabled reads the
    PMHealtCheckIntervalInSec  configurationvariable.
    Create the Quartz job in it initialize() method which will be called from backend::initialize()
</code></pre></div></div>

<h3 id="crud">CRUD</h3>

<p>N/A</p>

<h4 id="dao">DAO</h4>

<p>N/A</p>

<h4 id="metadata">Metadata</h4>

<p>N/A</p>

<h3 id="configuration">Configuration</h3>

<p>The following configuration variabled will be added to vdc_options</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    PMHealthCheckEnabled (boolean, false by default) - Enable/Diable the Pm Health Check scheduled job
    PMHealthCheckIntervalInSec (int, default 3600) - Determines the number of seconds for scheduling the PM Healt Check operation
</code></pre></div></div>

<p>Those configuration value should be exposed to the engine-config tool.</p>

<h3 id="business-logic">Business Logic</h3>

<p>The PmHealtCheckManager (if enabled) will create a Quartz job that runs each PmHealtCheckIntervalInSec and will do the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    Search for all Hosts with defined and enabled power management
    For each Host
        If the Host has just a Primary card, send a status command to this card, In case that this failed
        and Alert is generated, in case that it succeeded we check if there is an active alert for this host
        and remove it.
        If the Host has Primary &amp; Secondary cards
           For sequential devices, both are tested but only warning alerts are generated if one of those
           cards is OK and one fails
           For concurrent devices both are tested and alert is generated no matter which card fails
</code></pre></div></div>

<h3 id="api">API</h3>

<p>N/A</p>

<h3 id="user-experience">User Experience</h3>

<p>N/A</p>

<h3 id="installationupgrade">Installation/Upgrade</h3>

<p>New configuration values will be installed (see Configuration)</p>

<h4 id="user-work-flows">User work-flows</h4>

<p>User may see Alerts generated by the PM Healt Check job listed with other PM alerts generated by the system.
In 3.5, the user may be able to clear those alerts as any other alerts on the system
See <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1090808">Dismiss Alerts</a></p>

<h3 id="enforcement">Enforcement</h3>

<p>Code should verify that PM Health Check cycle can not be run while another cycle is active, this is due the fact that in a general elecricity failure or shutdown, looping over all hosts and waiting for the communication timeouts may be time consuming</p>

<h3 id="dependencies--related-features-and-projects">Dependencies / Related Features and Projects</h3>

<h4 id="affected-ovirt-projects">Affected oVirt projects</h4>

<p>See <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1090808">RFE</a></p>

<h3 id="documentation--external-references">Documentation / External references</h3>

<p><a href="/ovirt-site/previews/2952/develop/release-management/features/infra/pmhealthcheck.html">Features/PMHealthCheck</a></p>

<h3 id="future-directions">Future Directions</h3>

<p>N/A</p>

<h3 id="open-issues">Open Issues</h3>

<p>N/A</p>



        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/2952/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/2952/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/2952/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/2952/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/release-management/features/infra/detailedpmhealthcheck.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/master/source/develop/release-management/features/infra/detailedpmhealthcheck.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
