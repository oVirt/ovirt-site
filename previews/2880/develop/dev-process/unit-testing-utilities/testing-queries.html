<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Testing Queries | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Testing Queries" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/2880/develop/dev-process/unit-testing-utilities/testing-queries.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/2880/develop/dev-process/unit-testing-utilities/testing-queries.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Testing Queries" />
<meta name="twitter:site" content="@ovirt" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"Testing Queries","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/2880/images/logo.svg"}},"url":"https://ovirt.github.io/ovirt-site/previews/2880/develop/dev-process/unit-testing-utilities/testing-queries.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/2880/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/2880/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/2880/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/2880/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/2880/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/2880/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2880/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2880/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2880/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2880/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2880/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/2880/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/2880/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/2880/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/2880/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/2880/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/2880/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/2880/images/logo.svg">      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/2880/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2880/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/2880/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2880/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2880//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2880//blogs.ovirt.org/'>Blog</a></li>              </ul>          </div>          <!-- /.navbar-collapse -->      </div>      <!-- /.container-fluid -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2880/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2880/develop/">
              <span property="name">Developers Community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2880/develop/dev-process/">
              <span property="name">Dev Process</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2880/develop/dev-process/unit-testing-utilities/">
              <span property="name">Unit Testing Utilities</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/869d772390b0b317e4b37bb0714ab68e?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/869d772390b0b317e4b37bb0714ab68e?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Allon Mureinik</span></p>
                      
                    </section>
                  </span>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          
<h1 id="testing-queries">Testing Queries</h1>

<p>Queries are the main way for extracting data from the oVirt Engine for clients palced outside it. As such, they are a critical part of the engine, and should be thoroughly tested. This page discusses the base classes provided in oVirt Engine’s testing framework which help facilitate these tests.</p>

<h2 id="abstractquerytest">AbstractQueryTest</h2>

<p>This is the base class for testing any query. It provides several mocked and spied objects and is in charge of setting up the query instance for your tests. Note that it’s implementation uses reflection based on the generics parameters given to your class, so it is important to pass them accurately.</p>

<h3 id="declaring-a-test-class">Declaring A Test Class</h3>

<p>To use it, simply declare your test class as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>public class MyQueryTest extends AbstractQueryTest&lt;MyParamters, MyQuery&lt;MyParamters&gt;&gt; {
 ...
}
</code></pre></div></div>

<h3 id="utility-methods">Utility Methods</h3>

<p>Extenting this class will provide you with several utility methods to use in your tests:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">getQuery()</code> - returns the query to use in the test, with a mocked up user</li>
  <li><code class="language-plaintext highlighter-rouge">getQueryParameters()</code> - return <strong>a mock</strong> parameter object the query was constructed with. You can add additional behavior to it using <code class="language-plaintext highlighter-rouge">when(...).thenRerurn(...)</code> statements.</li>
  <li><code class="language-plaintext highlighter-rouge">getDbFacadeMockInstance()</code> - returns a mocked instance of <code class="language-plaintext highlighter-rouge">DbFacade</code>. You can add additional behavior to it (e.g., adding mocks for specific DAOs) using <code class="language-plaintext highlighter-rouge">when(...).thenRerurn(...)</code> statements.</li>
</ol>

<h3 id="built-in-tests">Built-in Tests</h3>

<ol>
  <li><code class="language-plaintext highlighter-rouge">testQueryType()</code> - asserts you didn’t forget to add your query to <code class="language-plaintext highlighter-rouge">VdcQueryType</code>. Note this test is run from the base class, and does not need to be called explicitly.</li>
</ol>

<h2 id="abstractuserquerytest">AbstractUserQueryTest</h2>

<p><code class="language-plaintext highlighter-rouge">AbstractUserQueryTest</code> is an extention of <code class="language-plaintext highlighter-rouge">AbstractQueryTest</code> designed to cater to user queries, which adds some additional functionality to the base class.</p>

<h3 id="utility-methods-1">Utility Methods</h3>

<ol>
  <li><code class="language-plaintext highlighter-rouge">getUser()</code> - returns the mocked user running the query</li>
</ol>

<h3 id="built-in-tests-1">Built-in Tests</h3>

<ol>
  <li><code class="language-plaintext highlighter-rouge">testQueryIsAUserQuery()</code> - tests your query was indeed marked as a user query. Note this test is run from the base class, and does not need to be called explicitly.</li>
</ol>




        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/2880/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/2880/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/2880/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/2880/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/dev-process/unit-testing-utilities/testing-queries.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/master/source/develop/dev-process/unit-testing-utilities/testing-queries.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
