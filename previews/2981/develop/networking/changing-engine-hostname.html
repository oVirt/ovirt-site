<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Changing Engine Hostname | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Changing Engine Hostname" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/2981/develop/networking/changing-engine-hostname.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/2981/develop/networking/changing-engine-hostname.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Changing Engine Hostname" />
<meta name="twitter:site" content="@ovirt" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"Changing Engine Hostname","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/2981/images/logo.svg"}},"url":"https://ovirt.github.io/ovirt-site/previews/2981/develop/networking/changing-engine-hostname.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/2981/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/2981/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/2981/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/2981/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/2981/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/2981/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2981/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2981/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2981/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2981/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2981/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/2981/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/2981/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/2981/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/2981/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/2981/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/2981/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/2981/images/logo.svg" />      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav" role="menubar">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/2981/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2981/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/2981/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2981/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2981//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2981//blogs.ovirt.org/'>Blog</a></li>        </ul>      </div>      <!-- /.navbar-collapse -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2981/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2981/develop/">
              <span property="name">Developers Community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2981/develop/networking/">
              <span property="name">Networking</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/a29d28811a6b9fc71f135fc57cbb3ee4?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/a29d28811a6b9fc71f135fc57cbb3ee4?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Yedidyah Bar David">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Yedidyah Bar David</span></p>
                      
                    </section>
                  </div>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>This developer documentation is <strong>outdated</strong>, but provides historical context.<br><br>It is <strong>not</strong> user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/2981/documentation/'>Documentation is available here.</a></div>

<h1 id="changing-engine-hostname">Changing Engine Hostname</h1>

<h2 id="are-you-sure-you-need-this">Are you sure you need this?</h2>

<p>Since version 4.0.4, it is possible to add more names to access the engine web interface,
see <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1325746">BZ 1325746</a>.</p>

<p>Make sure the name or names you want resolve to an IP address of the engine machine, by adding
relevant records to the DNS or to /etc/hosts, and then:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">#</span><span class="w"> </span><span class="nb">echo</span> <span class="s1">'SSO_ALTERNATE_ENGINE_FQDNS="alias1.example.com alias2.example.com"'</span> <span class="se">\</span>
<span class="gp">&gt;</span><span class="w"> </span>/etc/ovirt-engine/engine.conf.d/99-custom-sso-setup.conf
<span class="gp">#</span><span class="w"> </span>systemctl restart ovirt-engine.service
</code></pre></div></div>

<p>The list of alternate names has to be listed separated by spaces.</p>

<p>It’s possible to add also IP addresses of engine host, but using IP addresses instead of DNS names is not considered to be a good practise.</p>

<h2 id="changing-the-hostname-of-an-ovirt-managerengine">Changing the hostname of an oVirt Manager/engine</h2>

<h3 id="how-to">How to</h3>

<ol>
  <li>Prepare relevant DNS and/or /etc/hosts records for the new name.</li>
  <li>If using DHCP, update the DHCP server’s configuration.</li>
  <li>Change the hostname. This is usually done by editing /etc/hostname and rebooting. There are other options and details which are not in the scope of this document.</li>
  <li>Run the script ovirt-engine-rename:
    <div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">#</span><span class="w"> </span>/usr/share/ovirt-engine/setup/bin/ovirt-engine-rename
</code></pre></div>    </div>
  </li>
</ol>

<p>It’s otopi-based. This means, among other things, that it looks similar engine-setup/cleanup, and provides similar logging, options, etc.</p>

<p>Options specific to it:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--newname=&lt;newname&gt;
</code></pre></div></div>

<p>An example run, which does everything in batch and does not ask questions, if possible:</p>

<div class="language-console highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="gp">#</span><span class="w"> </span>/usr/share/ovirt-engine/setup/bin/ovirt-engine-rename <span class="se">\</span>
<span class="go">--newname=ovirte1n.home.local \
--otopi-environment="OSETUP_RENAME/forceIgnoreAIAInCA=bool:'True' \
OVESETUP_CORE/engineStop=bool:'True' \
OSETUP_RENAME/confirmForceOverwrite=bool:'False'"
</span></code></pre></div></div>

<h3 id="discussion">Discussion</h3>

<p>When running engine-setup on a clean system, one of the things it does is create the following set of keys and certs:</p>

<ol>
  <li>A CA (certificate authority) key and a self-signed cert for it</li>
  <li>A key for httpd, the admin web server, and a CA-signed certificate for it. This is used for https access to the admin site.</li>
  <li>A key for the engine, the jboss application managing the oVirt database and system, and a CA-signed certificate for it.</li>
</ol>

<p>All three certificates (CA, httpd, engine) are for the Common Name (CN) whose value is the hostname entered during engine-setup,
which is supposed to be the hostname of the engine’s machine, exist in the dns (forward and reverse records), and point to an IP address of the engine’s machine.</p>

<p>Later, when adding hosts to oVirt, these hosts also get certificates signed by the CA. The engine and VDSM can thus verify each others’ identity.</p>

<p>Currently, the script ovirt-engine-rename does not touch the CA’s or the engine’s certificate.
It does create a new certificate for the httpd web server.
This means that when you rename the host using this script, and then login using the admin interface to the new hostname, you’ll get in your browser a certificate for the new hostname,
signed by the CA, accompanied by the certificate of the CA, which is for the old hostname.</p>

<p>This means that if/when the old hostname is gone, it will not be possible anymore to try and verify the entire “trust path” from the root (CA) to the services - httpd and the engine.
Is this a concern? For the web server, it’s not too big of a concern.
At most, you’ll get some extra warnings from your web browser when trying to connect to the admin interface, which you can ignore.</p>

<p>The bigger concern is with the engine’s certificate. Currently, to the best of our knowledge, there is no component that actually checks this trust.
But it’s possible, that in some future version of one of the relevant tools - vdsm, libvirt, etc. - such a check will actually be made, and even prevent connections.
If this happens, the engine might not be able to connect to the hosts, and the worst case is that they will have to be reinstalled, thus loosing all the configuration and data accumulated by then.</p>

<p>Certificates can include an optional extension called Authority Information Access.
In oVirt releases up to and including 3.2, the CA certificate included this extension, pointing at the engine hostname. In 3.3 and later, this extension is no longer included.
Systems installed with 3.2 or before, and upgraded to 3.3, will still include this extension. That’s why it’s safer to rename such systems by running cleanup and setup again if possible.</p>

<p>See also <a href="/ovirt-site/previews/2981/develop/release-management/features/infra/pki.html">Features/PKI</a>.</p>



        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/2981/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/2981/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/2981/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/2981/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/networking/changing-engine-hostname.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/master/source/develop/networking/changing-engine-hostname.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
