// Module included in the following assemblies:
//
// doc-Technical_Reference/chap-Network.adoc

:_content-type: REFERENCE
[id="conc-overview-of-networking-in-rhv"]
= Networking in RHV

This topic provides an overview of networking in {virt-product-fullname} ({virt-product-shortname}).

== Host networking

On the data link layer (layer 2), {virt-product-shortname} enables the configuration of Linux bonds to connect to VLANs and define the MTU for network interfaces. These networks can be shared via Linux bridges to virtual machines.

For SR-IOV, the number of virtual functions and their mapping to logical networks can be configured.

VLANs are managed by FCoE and (application layer) iSCSI bonds, which are exclusively for storage access and neither visible for virtual machines nor in RHVs network configuration.

On the network layer (layer 3), IP addresses and gateways can be managed.

The DNS resolver used by the host can be configured.

It is also possible to manage network roles and QoS.

== Virtual machine networking

=== Supported networking types

In {virt-product-shortname} virtual NICs of virtual machines can connect to:

* Linux bridges
* SR-IOV NICs
* OVN - {virt-product-shortname} internal OVN

The following diagram shows the structure of these three approaches, where:

* "Host 1" represents Linux bridges
* "Host 2" represents SR-IOV NICs
* "Host 3" represents OVN


image::103_RHV_Networking_Overview_0720.png[]

.Comparison of network types
|===
| |Linux bridge |SR-IOV |{virt-product-shortname} internal OVN
|Isolation from physical host networks
|Layer 3, Separate IP network possible
|Layer 2, Separate VLANs possible
|Isolated

|Live Migration
|x
|x
|x

|QoS
|x
|
|

|Port Mirroring
|x
|
|

| configuration of plugged vNIC
|x
|x
|

|MAC address management
|x
|x
|x

|MTU propagation
|x
|
|x

|VLAN filtering, might require configuration on the physical switch
|x
|x
|Technology Preview

|MAC Spoofing Protection
|x
|
|x

|IP Spoofing Protection
|x
|
|x

|Predefined Network Filters
|x
|
|

|Custom Layer 3/4 Filtering
|
|
|x

|NAT
|
|
|

|DHCP/Router Advertisements
|
|
|x

|Layer 3 Router
|
|
|x

|Performance
|`**`
|`***`
|`*`

|virtual machine network data encapsulation
|flat, VLAN
|flat, VLAN
|Stable: GENEVE; Technology Preview: flat, VLAN
|===

== Networking choices for various scenarios

Linux bridge is the default way to go. It is the most proven option which fits most use cases.

For scenarios that require very low network latency or a high count of Ethernet frames, it might be worth investing in SR-IOV, which requires hardware support and additional configuration steps.

{virt-product-shortname} 's internal OVN networks enable virtual machines to communicate with each other without additional effort.

If a full-featured SDN is required, OpenStack Neutron can be used to manage OVN.

{virt-product-shortname} Engine provides only for a subset of the SDN features and user interfaces. To utilize the full potential of SDNs, like {virt-product-shortname} internal OVN, OpenStack Neutron OVN, or third party SDN, an additional client like CloudForms is required.

All kinds of networks can be combined on a single host and connected to the same virtual machine, with a single exception: {virt-product-shortname} 's internal OVN can not be used with Neutron in the same cluster.

=== Interaction with the guest

{virt-product-shortname} supports the initial configuration of the guest by providing configuration data via cloud-init. If the qemu-guest-agent runs inside the guest, {virt-product-shortname} can report the IP addresses of the guest.

If the guest virtual machine uses a VirtIO NIC, the MTU of the {virt-product-shortname} logical networks are provided to the guest OS. The guest can pick up the MTU from DHCPv4 or IPv6 router advertisements if supported by the logical network.

=== Host and VM networking

Linux bridge networking separates virtual machine and host networking on OSI layer 3. This means that the networking configuration, like VLAN, bonding, and MTU, is shared between the host and virtual machines.

To reduce their surface, hosts should not assign IP addresses to VLANs connected to virtual machines. This helps the hosts avoid potential confusion caused by virtual machine traffic.

.Additional resources

* link:https://www.ovirt.org/documentation/networking-overview/#:~:text=deeper%20into%20details.-,Host%20Networking,via%20Linux%20bridges%20to%20VMs.&text=On%20the%20network%20layer%20(layer,and%20gateways%20can%20be%20managed.[Overview of Networking in oVirt]
