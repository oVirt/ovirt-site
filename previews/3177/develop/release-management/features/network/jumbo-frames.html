<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Jumbo frames | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Jumbo frames" />
<meta name="author" content="Danny Rankevich" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/3177/develop/release-management/features/network/jumbo-frames.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/3177/develop/release-management/features/network/jumbo-frames.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Jumbo frames" />
<meta name="twitter:site" content="@ovirt" />
<meta name="twitter:creator" content="@Danny Rankevich" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Danny Rankevich"},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"Jumbo frames","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/3177/images/logo.svg"},"name":"Danny Rankevich"},"url":"https://ovirt.github.io/ovirt-site/previews/3177/develop/release-management/features/network/jumbo-frames.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/3177/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/3177/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/3177/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/3177/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/3177/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/3177/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3177/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3177/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3177/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3177/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3177/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/3177/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/3177/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/3177/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/3177/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/3177/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/3177/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/3177/images/logo.svg" />      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav" role="menubar">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/3177/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3177/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/3177/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3177/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3177//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3177//blogs.ovirt.org/'>Blog</a></li>        </ul>      </div>      <!-- /.navbar-collapse -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3177/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3177/develop/">
              <span property="name">Joining the developers community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3177/develop/release-management/">
              <span property="name">Release Management</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3177/develop/release-management/features/">
              <span property="name">Features (Design documents)</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3177/develop/release-management/features/network/">
              <span property="name">Network</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/a6d93107c253beece217ec0c2ae8d453?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/a6d93107c253beece217ec0c2ae8d453?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Danny Rankevich">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Danny Rankevich</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/ebbb2bb1935ae8d3235d20a4221769ee?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/ebbb2bb1935ae8d3235d20a4221769ee?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Einav Cohen">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Einav Cohen</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/6a6ee5db5d55d1918022cb4a22f64286?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/6a6ee5db5d55d1918022cb4a22f64286?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Roy Golan">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Roy Golan</span></p>
                      
                    </section>
                  </div>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Feature pages are design documents that developers have created while collaborating on oVirt.<br><br>Most of them are&nbsp;<strong>outdated</strong>, but provide historical design context.<br><br>They are&nbsp;<strong>not</strong>&nbsp;user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/3177/documentation/'>Documentation is available here.</a></div>

<h1 id="jumbo-frames">Jumbo frames</h1>

<h2 id="summary">Summary</h2>

<p>Typically, just another parameter for a network configuration to determine the <a href="http://en.wikipedia.org/wiki/Maximum_transmission_unit">MTU</a>.</p>

<h2 id="owner">Owner</h2>

<ul>
  <li>Name: Roy Golan</li>
  <li>Email: rgolan@redhat.com</li>
</ul>

<h2 id="definition">definition</h2>

<table>
  <tbody>
    <tr>
      <td>[<a href="http://en.wikipedia.org/wiki/Jumbo_frame">http://en.wikipedia.org/wiki/Jumbo_frame</a></td>
      <td>Jumbo frames] (Wikipedia citation): In computer networking, jumbo frames are Ethernet frames with more than 1500 bytes of payload. Conventionally, jumbo frames can carry up to 9000 bytes of payload, but variations exist and some care must be taken when using the term.</td>
    </tr>
  </tbody>
</table>

<h2 id="code-changes">Code Changes</h2>

<h3 id="model">Model</h3>

<ul>
  <li>Add MTU : int to both network and VdsNeworkEntity</li>
  <li>Add deserialization to MTU field in VdsBrokerObjectsBuilder.java. Serialise as String and not Int.</li>
  <li>DB - add field in to vds_interface,vds_interface_view, network,network_view</li>
  <li>DAO - add field to VdsInterfaceDao,networkDao CRUD actions</li>
  <li>DAO - update tests</li>
  <li>config value - MaxMTU</li>
</ul>

<h3 id="bl">BL</h3>

<ul>
  <li>Create logical network
    <ul>
      <li>valid values: 0 - use OS default , 68 - minimum and maximum is configurable (MaxMTU)</li>
      <li>mtu is updateable only when the logical network is not attached to a cluster</li>
    </ul>
  </li>
</ul>

<!-- -->

<ul>
  <li>Add host to newtork via setupnetworks
    <ul>
      <li>If network.mtu is 0 then don’t send it to VDSM and the OS default will take place</li>
    </ul>
  </li>
</ul>

<!-- -->

<ul>
  <li>monitoring
    <ul>
      <li>fire audit log if a the host reported MTU different than the logical network</li>
    </ul>
  </li>
</ul>

<h3 id="limitations">limitations</h3>

<ul>
  <li>Vlan and non-Vlan networks cannot reside on the same nic although there is an RFE for that</li>
</ul>

<p>If this limitation is removed we need to validate the MTU for the non-vlan network will allways is the lowest or equals to the the lowest vlan id (again, for networks on the same nic)</p>

<h3 id="rest-api">REST API</h3>

<p>mtu is a new optional parameter when creating a logical network. Not sending it defaults to 0 which api-wise means “use default value”</p>

<p>Endpoint: <strong>POST</strong> <code class="language-plaintext highlighter-rouge">/api/networks/</code></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;action&gt;</span>
  <span class="nt">&lt;network&gt;</span>
    <span class="nt">&lt;name&gt;</span>....<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;mtu&gt;</span>9000<span class="nt">&lt;/mtu&gt;</span>
  <span class="nt">&lt;/network&gt;</span>
<span class="nt">&lt;/action&gt;</span>
</code></pre></div></div>

<h3 id="implementation-on-host">implementation on host</h3>

<ul>
  <li>The mtu on the bare interface is always the highest common between all pseudo-interfaces (vlan, bridge) on top of it</li>
  <li>
    <p>single network bridged mtu 1500</p>

    <p>eth0  mtu=1500
  br0<br />
   |
  eth0 mtu=1500</p>
  </li>
  <li>
    <p>vlaned bridged mtu 1500 and vlaned non-bridged mtu 9000</p>

    <p>eth0 mtu=9000
  br0  mtu=1500
   |
  eth0.300 mtu=1500<br />
  eth0.500 mtu=9000</p>
  </li>
</ul>

<h3 id="messages">Messages</h3>

<ul>
  <li>
    <p>Audit log</p>

    <p>VDS_SET_NONOPERATIONAL_NETWORK_MTU_DIFFER(605, HOUR)</p>
  </li>
  <li>
    <p>AuditLogMessages.properies</p>

    <p>VDS_SET_NONOPERATIONAL_NETWORK_MTU_DIFFER=MTU on network ${NetworkName} is ${VDS_MTU} and expected to be ${CLUSTER_MTU}</p>
  </li>
  <li>
    <p>Enums.properties</p>

    <p>AuditLogType___VDS_SET_NONOPERATIONAL_NETWORK_MTU_DIFFER=The MTU value of the Host network differs from Cluster</p>
  </li>
  <li>
    <p>Enums.java</p>

    <p>AuditLogType___VDS_SET_NONOPERATIONAL_NETWORK_MTU_DIFFER</p>
  </li>
</ul>

<h2 id="ui">UI</h2>

<ul>
  <li>MTU is provisioned in logical network UI</li>
  <li>add checkbox “override MTU” unchecked by default</li>
  <li>once checked a blank input apears (valid input type is integers)</li>
  <li>unchecking will clear the input box</li>
  <li>if no overriden, send 0</li>
</ul>

<p><img src="/ovirt-site/previews/3177/images/wiki/MTU_unchecked.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3177/images/wiki/MTU_checked.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3177/images/wiki/ClusterNetwork.png" alt="" /></p>

<h2 id="backward-compatibility">Backward Compatibility</h2>

<p>Same as for bridge-less feature.</p>

<p>The XML returned by VDSM may have or miss the element of “mtu” since this wasn’t reported till now.</p>

<p>The code must check for existing elements and then try to deserialize to interface/bond/network entities.</p>

<p>Missing element is ignored for its implicitly regarded as non compatible.</p>



        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/3177/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/3177/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/3177/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/3177/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2024 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/release-management/features/network/jumbo-frames.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/main/source/develop/release-management/features/network/jumbo-frames.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
