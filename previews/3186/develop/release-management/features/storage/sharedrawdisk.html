<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>SharedRawDisk | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="SharedRawDisk" />
<meta name="author" content="Ayal Baron" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/3186/develop/release-management/features/storage/sharedrawdisk.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/3186/develop/release-management/features/storage/sharedrawdisk.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="SharedRawDisk" />
<meta name="twitter:site" content="@ovirt" />
<meta name="twitter:creator" content="@Ayal Baron" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Ayal Baron"},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"SharedRawDisk","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/3186/images/logo.svg"},"name":"Ayal Baron"},"url":"https://ovirt.github.io/ovirt-site/previews/3186/develop/release-management/features/storage/sharedrawdisk.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/3186/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/3186/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/3186/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/3186/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/3186/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/3186/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3186/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3186/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3186/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3186/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3186/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/3186/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/3186/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/3186/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/3186/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/3186/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/3186/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/3186/images/logo.svg" />      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav" role="menubar">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/3186/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3186/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/3186/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3186/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3186//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3186//blogs.ovirt.org/'>Blog</a></li>        </ul>      </div>      <!-- /.navbar-collapse -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3186/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3186/develop/">
              <span property="name">Joining the developers community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3186/develop/release-management/">
              <span property="name">Release Management</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3186/develop/release-management/features/">
              <span property="name">Features (Design documents)</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3186/develop/release-management/features/storage/">
              <span property="name">Storage</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/a283ddeeff169a8d3dbc71a3d6d3a2e5?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/a283ddeeff169a8d3dbc71a3d6d3a2e5?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Ayal Baron">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Ayal Baron</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/93875e42e9b962947becb4e425504fab?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/93875e42e9b962947becb4e425504fab?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Daniel Erez">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Daniel Erez</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/db6bc448daa2b0b1315b0184bbcc9b77?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/db6bc448daa2b0b1315b0184bbcc9b77?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Maor Lipchuk">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Maor Lipchuk</span></p>
                      
                    </section>
                  </div>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/65fafd7adcef0c369b149759491fae7f?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/65fafd7adcef0c369b149759491fae7f?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Sandro Bonazzola">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard"><a rel="author" href="https://twitter.com/sandrobonazzola" title="Sandro Bonazzola">Sandro Bonazzola</a></span></p>
                      
                    </section>
                  </div>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Feature pages are design documents that developers have created while collaborating on oVirt.<br><br>Most of them are&nbsp;<strong>outdated</strong>, but provide historical design context.<br><br>They are&nbsp;<strong>not</strong>&nbsp;user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/3186/documentation/'>Documentation is available here.</a></div>

<h1 id="shared-raw-disk">Shared Raw Disk</h1>

<h3 id="summary">Summary</h3>

<p>The shared raw disk feature enables to share disks between multiple VMs in the Data Center.</p>

<h3 id="owner">Owner</h3>

<ul>
  <li>
    <p>Feature owner: Maor Lipchuk (mlipchuk)</p>

    <ul>
      <li>
        <p>GUI Component owner: Daniel Erez (derez)</p>
      </li>
      <li>
        <p>REST Component owner: Michael Pasternak (mpasternak)</p>
      </li>
      <li>
        <p>Engine Component owner: Maor Lipchuk (mlipchuk)</p>
      </li>
      <li>
        <p>QA Owner: Yaniv Kaul (ykaul)</p>
      </li>
    </ul>
  </li>
</ul>

<h3 id="detailed-description">Detailed Description</h3>

<p>The shared disk feature should provide the ability to attach a disk to multiple VMs. It is the user’s responsibility to make sure that the VMs do not corrupt disk data.
Users should be able to easily manage disks as standalone entities which are not shared between VMs
(see <a href="/ovirt-site/previews/3186/develop/release-management/features/storage/floatingdisk.html">Features/FloatingDisk</a>),
 or as entities which are shared between multiple VMs, and be able to switch between the two states. This feature will enable oVirt users to more easily run external cluster applications, or shared data warehouses on VMs.</p>

<h4 id="entity-description">Entity Description</h4>

<h5 id="disk">Disk</h5>

<ul>
  <li>Disk should have a field indicating whether it is shareable or not.</li>
</ul>

<h4 id="functionality">Functionality</h4>

<p>General</p>

<ul>
  <li>Shareable raw disk is configured the same as a regular disk, but with a shareable flag will be marked as true.</li>
  <li>Currently only raw disks without snapshot can be shareable.</li>
  <li>Shareable disks are attached with R/W permissions.</li>
  <li>The synchronization/clustering of data access to shareable disks is the responsibility of the guests. Attaching a shareable disk to non-cluster aware guests will lead to corruption of the data on the disk.</li>
  <li>When detaching a shareable disk from all VMs in the Data Center. the disk will become ‘floating’.</li>
</ul>

<p>Attach Shareable Disk</p>

<ul>
  <li>When attaching a shareable disk to a VM, the disk will be logically connected to the VM and will be activated (hot plug VDSM command will be send), if the activation will fail the disk not be activated.</li>
</ul>

<p>Remove Shareable Disk</p>

<ul>
  <li>
    <p>User can remove the shareable raw disk entirely from the setup, whether the disk is inactive in all the VMs which are attached to it, or all the VMs which the disk attached to, are in status down (or any combination of the two).
 When disk will be removed a warning message should display the user the following message :</p>

    <p>Removing the shareable disk will remove it from all the VMs which are associated with it.</p>
  </li>
</ul>

<p>Remove VM</p>

<ul>
  <li>When VM will be removed the shareable disk will be detached from the VM.</li>
</ul>

<p>Templates</p>

<ul>
  <li>When creating a template from a VM which has one or more shareable disks, the creation will of the template will be without the shareable disk.</li>
  <li>Template disks should not be shareable.</li>
</ul>

<p>VM pool</p>

<ul>
  <li>Shareable disk should not be supported with VM from pool, since VM pool is based on a template which does not support shareable disk.</li>
</ul>

<p>Export/Import</p>

<ul>
  <li>When exporting a VM which has one or more shareable disks, the VM will be exported without its shareable disks.</li>
  <li>Exported disks (Whether with VMs or Templates) should not be shareable.</li>
</ul>

<p>Move disk</p>

<ul>
  <li>Moving a shareable disk is permitted only when all the attached VMs statuses are down, or all the VMs which the disks are attached to are inactive.</li>
</ul>

<p>Snapshot</p>

<ul>
  <li>When taking a vm snapshot, a snapshot of the shareable disk should not be taken and should not be part of the VM snapshot configuration.</li>
</ul>

<p>Stateless VM</p>

<ul>
  <li>When running stateless VM, the shareable raw disk will not be handled as stateless, the user should get a warning message indicating that the disk will not be handled as stateless.</li>
</ul>

<h4 id="user-experience">User Experience</h4>

<ul>
  <li>Display shareable disk
    <ul>
      <li>The shareable disks will be displayed in the ‘disks’ main tab.</li>
      <li>The shareable disk details tab will include the number of VMs to which it is connected.</li>
    </ul>
  </li>
  <li>Adding shareable disk
    <ul>
      <li>Creating/Editing a shareable disk is available through the new/edit disk dialog from the disks sub tab in the VM main tab.
 The add/edit disk dialog box will have a check box indicating whether the disk is shareable or not.
When a user wants to configure a regular disk to be a shareable disk, he will edit the disk and mark the checkbox as shareable.</li>
      <li>User will also be able to attach/detach a shareable disk through the disks sub tab of the VMs main tab,</li>
    </ul>
  </li>
  <li>Remove shareable disk
    <ul>
      <li>User will be able to remove a shareable disk from the disks main tab.</li>
      <li>When user will try to remove a shareable disk which is attached to only one VM from the disks sub tab, the user will be able to choose whether to remove the disk permanently from the storage or only detach it from the VM.</li>
      <li>When user will try to remove a shareable disk which is attached to more then one VM from the disks sub tab, the disk should only be detached from the VM, and not removed permanently.</li>
    </ul>
  </li>
</ul>

<h4 id="api">API</h4>

<ul>
  <li>User can set a disk to be shareable or not through the API, by setting the shareable property in the disk entity appropriately.</li>
  <li>Shareable disk entity should provide a list of VMs which the disk is associated with (Will be provided soon as disk root rest implementation will be provided).</li>
</ul>

<h4 id="installationupgrade">Installation/Upgrade</h4>

<ul>
  <li>
    <p>Disk name should be generated automatically based on the vm name and disk number in the VM, as follow:
<code class="language-plaintext highlighter-rouge">&lt;VM-name&gt;_&lt;Disk-name&gt;</code> (“&lt;Disk-name” = “Disk” + internal_drive_mapping) . Description will be empty.</p>
  </li>
  <li>
    <p>New disk will present a calculated default disk name which the user can change.</p>
  </li>
</ul>

<p>=== User work-flows ===</p>

<p>The Administrator Portal should allow the following operations:</p>

<ul>
  <li>Search should provide the user to view all sharebale raw disks from the disks main tab.</li>
  <li>Regular disk can become a shareable raw disk, by editing the existing disk and marking the ‘shareable’ property type.</li>
  <li>When removing a VM with shareable disks attached to it, the shareable disks will not be removed.</li>
  <li>If the shareable disk is not attached to any other VMs then it will become a ‘floating’ disk.</li>
  <li>Attach/Detach of a shareable disk can be performed only when the VM is in status ‘down’.</li>
</ul>

<p>The Power User Portal should allow the following operations:</p>

<ul>
  <li>Attach/detach disks to/from a VM.</li>
  <li>View shareable disks in the Data Center which the power user can attach/detach</li>
  <li>The power user will not have permissions to create a shareable disk from the user portal.</li>
</ul>

<p>The following UI mockups contain guidelines for the different screens and wizards:</p>

<p><img src="/ovirt-site/previews/3186/images/wiki/Grid_vmvdisks.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3186/images/wiki/Attach_dialogue.png" alt="" /></p>

<p><img src="/ovirt-site/previews/3186/images/wiki/New_disk.png" alt="" /></p>

<h3 id="dependencies--related-features-and-projects">Dependencies / Related Features and Projects</h3>

<p>Attaching shareable disk will not consume new Quota resource. Affected oVirt projects:</p>

<ul>
  <li>API</li>
  <li>CLI</li>
  <li>Engine-core</li>
  <li>Webadmin</li>
  <li>User Portal</li>
  <li>History Data Warehouse</li>
  <li>VDSM</li>
</ul>

<p>Quota has to be taken in consideration, for every new feature that will involve consumption of resources managed by it.</p>

<ul>
  <li>Quota - Same as regular disk, shareable raw disk will need to be attached to quota, he will consume from. Attach and detach should not affect the quota consumption.</li>
  <li>Floating Disk - Shareable raw disk will be considered to be floating when the shareable disk will not be attach to any VM.</li>
  <li>Disk Permissions - Manage permissions for creating/removing/configuring shareable disk.</li>
</ul>



        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/3186/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/3186/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/3186/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/3186/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2024 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/release-management/features/storage/sharedrawdisk.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/main/source/develop/release-management/features/storage/sharedrawdisk.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
