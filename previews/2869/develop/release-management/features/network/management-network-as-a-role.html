<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Management Network As A Role | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Management Network As A Role" />
<meta name="author" content="Dan Kenigsberg" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/2869/develop/release-management/features/network/management-network-as-a-role.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/2869/develop/release-management/features/network/management-network-as-a-role.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Management Network As A Role" />
<meta name="twitter:site" content="@ovirt" />
<meta name="twitter:creator" content="@Dan Kenigsberg" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","author":{"@type":"Person","name":"Dan Kenigsberg"},"description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"Management Network As A Role","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/2869/images/logo.svg"},"name":"Dan Kenigsberg"},"url":"https://ovirt.github.io/ovirt-site/previews/2869/develop/release-management/features/network/management-network-as-a-role.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/2869/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/2869/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/2869/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/2869/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/2869/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/2869/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2869/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2869/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2869/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2869/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2869/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/2869/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/2869/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/2869/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/2869/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/2869/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/2869/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/2869/images/logo.svg">      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/2869/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2869/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/2869/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2869/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2869//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2869//blogs.ovirt.org/'>Blog</a></li>              </ul>          </div>          <!-- /.navbar-collapse -->      </div>      <!-- /.container-fluid -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2869/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2869/develop/">
              <span property="name">Developers Community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2869/develop/release-management/">
              <span property="name">Release Management</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2869/develop/release-management/features/">
              <span property="name">Features (Design documents)</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2869/develop/release-management/features/network/">
              <span property="name">Network</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/ce421080e5d2da87febb626f6e8906c9?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/ce421080e5d2da87febb626f6e8906c9?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Dan Kenigsberg</span></p>
                      
                    </section>
                  </span>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/90758110b19ee0a2e03473012fdc1bd7?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/90758110b19ee0a2e03473012fdc1bd7?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Moti Asayag</span></p>
                      
                    </section>
                  </span>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/65fafd7adcef0c369b149759491fae7f?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/65fafd7adcef0c369b149759491fae7f?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard"></span><a rel="author" href="https://twitter.com/sandrobonazzola" title="Sandro Bonazzola">Sandro Bonazzola</a></span></p>
                      
                    </section>
                  </span>
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/52ced33e55ce6b7309d2c399121ecc35?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/52ced33e55ce6b7309d2c399121ecc35?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy">
                  </div>
                  <span class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Yevgeny Zaspitsky</span></p>
                      
                    </section>
                  </span>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Feature pages are design documents that developers have created while collaborating on oVirt.<br><br>Most of them are&nbsp;<strong>outdated</strong>, but provide historical design context.<br><br>They are&nbsp;<strong>not</strong>&nbsp;user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/2869/documentation/'>Documentation is available here.</a></div>

<h1 id="management-network-as-a-role">Management Network As A Role</h1>

<h2 id="summary">Summary</h2>

<p>This feature is about attaching the management network role to an arbitrary network in a cluster.</p>

<h2 id="detailed-description">Detailed Description</h2>

<h3 id="motivation">Motivation</h3>

<p>Allow assigning different VLANs to management networks in different clusters under same data center.</p>

<h3 id="entity-description">Entity Description</h3>

<ul>
  <li>No new entities</li>
  <li><em>Management</em> boolean field will be added to NetworkCluster entity. <em>True</em> value will indicate that the network is the management one in the given cluster (similarly like it been done for display networks).</li>
</ul>

<h3 id="user-experience">User Experience</h3>

<h4 id="ui">UI</h4>

<ul>
  <li>The existing “Manage network(s)” screens will be updated with the new column “Management Network”. User will be able to change the management network assignment through the screens in the similar way like it’s currently done for display network. Only a required network could be chosen as the management one.
    <ul>
      <li>Networks assignments for a single cluster
        <ul>
          <li>The management <strong>radio button</strong> will be disabled for non-required networks.
<img src="/ovirt-site/previews/2869/images/wiki/Manage_networks.png" alt="" /></li>
        </ul>
      </li>
      <li>A single network assignments for all clusters in the DC
        <ul>
          <li>The management <strong>checkbox</strong> will be disabled for non-required networks.
<img src="/ovirt-site/previews/2869/images/wiki/Manage_network.png" alt="" /></li>
        </ul>
      </li>
      <li>The “required” checkbox will become disabled while the network is chosen as the management one and will turn to enabled once it stops being the management network.</li>
    </ul>
  </li>
  <li>The new parameter (management network) will be added in “New cluster” screen. The parameter will have the default value of <em>ovirtmgmt</em> if that is present in the DC and the user will be able to choose any other network as the management one.
<img src="/ovirt-site/previews/2869/images/wiki/Create_cluster.png" alt="" /></li>
</ul>

<h4 id="restful-api">RESTful API</h4>

<ul>
  <li>The new valid value (<em>MANAGEMENT</em>) will be added to Network.Usages collection.
    <ul>
      <li>NetworkUsage enum will be extended with the new <em>MANAGEMENT</em> value.</li>
    </ul>
  </li>
  <li>A request that will make a management network non-required will fail.</li>
  <li>The new optional parameter (management network) will be added for creating a new cluster API call (see <a href="#user-work-flows">point 1 of User work-flows</a>)</li>
</ul>

<h3 id="user-work-flows">User work-flows</h3>

<p>Here are the work flows that will be affected by implementing the feature:</p>

<ul>
  <li>In order to make sure that every cluster will continue having a management network the new parameter (management network) will be added to creating new cluster flow.
    <ul>
      <li>The parameter will have the default value of <em>ovirtmgmt</em> and the user will be able to choose any other network as the management one.</li>
      <li><em>ovirtmgmt</em> network will continue to be created upon a DC creation.</li>
      <li>In case of <em>ovirtmgmt</em> isn’t present (was removed) and another single network is present in the DC it will be taken as the default management network.</li>
      <li>In case of <em>ovirtmgmt</em> isn’t present (was removed) and number of network in the DC <strong>isn’t one</strong> the cluster creating operation will fail.</li>
    </ul>
  </li>
  <li><em>ovirtmgmt</em> will be created upon creating a new DC. That will be done in order to keep backward compatibility to the current system behavior.</li>
  <li>Only a required network could be chosen as the management one.</li>
  <li>It will be possible to remove a network (and yes, <em>ovirtmgmt</em> too) as soon as it stops serving as the management network of any cluster (same rules applied like prior the feature implementation).</li>
  <li>Changing the management network in a cluster (through one of the options mentioned earlier) will be enabled for an empty cluster only.</li>
  <li>Moving a host from a cluster to another one will be enabled only in case where the source and destination management networks are the same one.</li>
  <li>All hard-coded usages of ovirtmgmt network will be changed to the cluster management one:
    <ul>
      <li>A new added host will be setup with the cluster management network.</li>
      <li>The cluster management network will be used as display and/or migration network fallback (e.g. in case of removing a network from a cluser/host).</li>
      <li>The management network will be used by VDSM as the host default route.</li>
    </ul>
  </li>
</ul>

<h3 id="feature-restrictions">Feature restrictions</h3>

<p>Most of the feature restrictions are intended to prevent changing the management network on a host after inital “setup networks” operation (a part of a host installation process). Changing the management network might lead to loosing connectivity to the host that the connection to it is defined on the IP it was initially installed with in oVirt and the security certificate that was issued with that IP. Changing the mangement network after the host was installed might cause changing the IP that will be assigned to the new management network. Then accessing the host through that new IP will be impossible as the certifacate will not match the new IP address.
Resolving the certifiacate limitation (e.g. by making possible its changing) will make possible changing the management network after inital “setup networks” operation (a part of a host installation process) , which will enable removing most of the feature restrictions.</p>

<h2 id="documentation">Documentation</h2>

<p>The high level feature description could be found <a href="/ovirt-site/previews/2869/develop/release-management/features/network/detailedmanagementnetworkasarole.html">here</a>.</p>

<h2 id="open-issues">Open Issues</h2>

<ul>
  <li>What should be done with the host certificate that was issued for a specific IP? If changing certificate was possible most of the feature restriction could’ve been removed.</li>
  <li>Moving a cluster from a DC to another one. The scenario is possible only after a DC force removal. At that stage al old DC networks are removed. The possible scenarios are:
    <ul>
      <li>The operation will be forbidden. That will push the user to copy the cluster manually:
        <ul>
          <li>create an empty cluster under the destination DC</li>
          <li>remove all old cluster hosts from oVirt and add them back under the new created cluster in the destination DC</li>
          <li>remove the old cluster from the system</li>
        </ul>
      </li>
      <li>Let the user to choose one of the destination DC networks as the management one for the moved cluster (like it is done in creating a new cluster). The user should be warned that the management traffic to the cluster hosts will remain AS IS until “setup host networks” operation will be successfully completed on each one of the hosts.</li>
    </ul>
  </li>
  <li>How the new “management network” parameter will be represented in “Create new cluster” dialog in UI (see <a href="#ui">the second bullet of UI section</a>)?</li>
</ul>




        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/2869/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/2869/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/2869/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/2869/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/release-management/features/network/management-network-as-a-role.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/master/source/develop/release-management/features/network/management-network-as-a-role.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
