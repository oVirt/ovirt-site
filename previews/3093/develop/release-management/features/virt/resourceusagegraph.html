<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>ResourceUsageGraph | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="ResourceUsageGraph" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/3093/develop/release-management/features/virt/resourceusagegraph.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/3093/develop/release-management/features/virt/resourceusagegraph.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="ResourceUsageGraph" />
<meta name="twitter:site" content="@ovirt" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"ResourceUsageGraph","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/3093/images/logo.svg"}},"url":"https://ovirt.github.io/ovirt-site/previews/3093/develop/release-management/features/virt/resourceusagegraph.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/3093/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/3093/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/3093/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/3093/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/3093/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/3093/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3093/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3093/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3093/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3093/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/3093/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/3093/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/3093/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/3093/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/3093/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/3093/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/3093/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/3093/images/logo.svg" />      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav" role="menubar">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/3093/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3093/documentation/'>Documentation</a></li><li class='active' role='menuitem'>  <a href='/ovirt-site/previews/3093/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3093/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3093//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/3093//blogs.ovirt.org/'>Blog</a></li>        </ul>      </div>      <!-- /.navbar-collapse -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3093/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3093/develop/">
              <span property="name">Developers Community</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3093/develop/release-management/">
              <span property="name">Release Management</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3093/develop/release-management/features/">
              <span property="name">Features (Design documents)</span>
              <meta property="position" content="4" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/3093/develop/release-management/features/virt/">
              <span property="name">Virt</span>
              <meta property="position" content="5" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
            <header class="post-header col-md-4 pad-sides well well-lg">
              <h2 class="post-title entry-title">Authors:</h2>
              <div class="post-meta">
                
                  
                  
                  
                  <div class="blogger_avatar">
                    <img
                      src="https://secure.gravatar.com/avatar/c77d53c2ffc02fceea3ab4cc705360e5?s=32&amp;d=mm&amp;r=g"
                      srcset="https://secure.gravatar.com/avatar/c77d53c2ffc02fceea3ab4cc705360e5?s=64&amp;d=mm&amp;r=g 2x"
                      class="avatar avatar-32 photo"
                      height="32"
                      width="32"
                      loading="lazy"
                      alt="avatar of Tomas Jelinek">
                  </div>
                  <div class="byline">
                    <section class="entry-meta">
                      
                        <p><span class="author vcard">Tomas Jelinek</span></p>
                      
                    </section>
                  </div>
                
                </div>
            </header>
          
        
        <section id="content" class="content container">
          <div class='alert alert-warning'>Feature pages are design documents that developers have created while collaborating on oVirt.<br><br>Most of them are&nbsp;<strong>outdated</strong>, but provide historical design context.<br><br>They are&nbsp;<strong>not</strong>&nbsp;user documentation and should not be treated as such.<br><br><a href='/ovirt-site/previews/3093/documentation/'>Documentation is available here.</a></div>

<h1 id="resource-usage-graph">Resource Usage Graph</h1>

<h2 id="summary">Summary</h2>

<p>Implement a line chart showing a short history of the resource usage.</p>

<h2 id="owner">Owner</h2>

<ul>
  <li>Name: Tomas Jelinek (TJelinek)</li>
  <li>Email: <a href="mailto:TJelinek@redhat.com">TJelinek@redhat.com</a></li>
</ul>

<h2 id="current-status">Current status</h2>

<ul>
  <li>Target Release: 3.6</li>
  <li>Status: done</li>
</ul>

<h2 id="background">Background</h2>

<p>Up until now, the resource (CPU, memory, network) usage of the VM was shown only as a current state with no historical view.</p>

<p>It would be good to replace the current visualization with a line chart.</p>

<h2 id="implementation">Implementation</h2>

<p>To store the short term history the vm_statistics table has been enriched by the following fields:</p>

<ul>
  <li>cpu_usage_history</li>
  <li>memory_usage_history</li>
  <li>network_usage_history</li>
</ul>

<p>This fields are defined as TEXT and the values in them are stored as one comma separated string of values in percentage, for example: “19,20,34,0,0,1”</p>

<p>The amount of values which are stored in this fields are regulated by <strong>UsageHistoryLimit</strong> from <strong>vdc_options</strong>. For example, if the UsageHistoryLimit is 3 and the current value is “1,2,3” and the new value of 4 comes, the result will be “2,3,4”.</p>

<h2 id="frontend">Frontend</h2>

<p>A line chart will be added (implemented using the HTML5 canvas with a fallback to the old way of visualizing if the browser does not support it) The widget’s specific behavior (in case the browser supports HTML5 canvas):</p>

<ul>
  <li>the widget draws a line chart ending with a green triangle (if the last value is smaller than 70), orange square (if smaller than 95) and a red dot (if bigger than 95)</li>
  <li>next to the chart is a the last value of the chart written in form of N% (e.g. 75%). If the value is &gt;= 95, it is red and bold</li>
  <li>if the num of progress values is smaller than the amount fitting into the drawing area but does not start with 0, the values are prepended by ‘0’ e.g. the chart will start from 0</li>
  <li>if the num of progress values is bigger than the amount fitting into the drawing area, beginning of the values are cut</li>
  <li>the distance between two points has to be between the 4px and 15px (calculated according to the width of the drawing area and num of of points in the chart) - e.g. the bigger the drawing area the more points can fit in. It will also react to table column resize.</li>
  <li>if no points fit into the drawing area, only the number is shown</li>
</ul>

<p>Please see the mockup attached (please note that the line endings are random in the mockup):</p>

<p><img src="/ovirt-site/previews/3093/images/wiki/ResourceUsageGraphMockup.png" alt="" /></p>

<h2 id="testing">Testing</h2>

<h2 id="test-case-1">Test Case 1</h2>

<ul>
  <li>Have a VM which is turned off</li>
  <li>Verify the line charts reset to 0</li>
</ul>

<h2 id="test-case-2">Test Case 2</h2>

<ul>
  <li>Have a VM running some while so the charts are showing something</li>
  <li>Turn the VM off using webadmin</li>
  <li>Verify the charts are reset to 0</li>
</ul>

<h2 id="test-case-3">Test Case 3</h2>

<ul>
  <li>Have a VM running some while so the charts are showing something</li>
  <li>Kill the qemu process of the VM</li>
  <li>Verify the charts are reset to 0</li>
</ul>

<h2 id="test-case-4">Test Case 4</h2>

<ul>
  <li>Have a VM running for some time so it has, say, 10 values shown in the CPU usage chart shown</li>
  <li>Make the CPU usage column small that not all the values fit in</li>
  <li>Verify that only the subpart of the values are in</li>
</ul>

<h2 id="test-case-5">Test Case 5</h2>

<ul>
  <li>Have a VM running for some time so it has, say, 10 values shown in the CPU usage chart shown</li>
  <li>Make the CPU usage column large that all the values fit in</li>
  <li>Verify that all of the values are in</li>
</ul>

<h2 id="test-case-6">Test Case 6</h2>

<ul>
  <li>Have a VM running for some time so it has, say, 10 values shown in the CPU usage chart shown</li>
  <li>Make the CPU usage column very small</li>
  <li>Verify that only the number showing the actual usage is shown</li>
</ul>

<h2 id="test-case-7">Test Case 7</h2>

<ul>
  <li>Have a VM running for some time and has a changing values in the CPU usage</li>
  <li>Verify that when the CPU usage is under 70%, the line chart ends with a green triangle, if between 70 and 95 than orange square and if above 95 a red dot</li>
  <li>Also verify that if the current value is under 95% the number showing the actual value is not bold while when above 95 it is red and bold</li>
</ul>




        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/3093/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/3093/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/3093/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/3093/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/develop/release-management/features/virt/resourceusagegraph.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/main/source/develop/release-management/features/virt/resourceusagegraph.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
