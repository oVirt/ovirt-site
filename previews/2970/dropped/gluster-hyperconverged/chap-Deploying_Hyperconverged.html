<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Deploying oVirt and Gluster Hyperconverged | oVirt</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Deploying oVirt and Gluster Hyperconverged" />
<meta property="og:locale" content="en" />
<meta name="description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<meta property="og:description" content="oVirt is a free open-source virtualization solution for your entire enterprise" />
<link rel="canonical" href="https://ovirt.github.io/ovirt-site/previews/2970/dropped/gluster-hyperconverged/chap-Deploying_Hyperconverged.html" />
<meta property="og:url" content="https://ovirt.github.io/ovirt-site/previews/2970/dropped/gluster-hyperconverged/chap-Deploying_Hyperconverged.html" />
<meta property="og:site_name" content="oVirt" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Deploying oVirt and Gluster Hyperconverged" />
<meta name="twitter:site" content="@ovirt" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"oVirt is a free open-source virtualization solution for your entire enterprise","headline":"Deploying oVirt and Gluster Hyperconverged","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://ovirt.github.io/ovirt-site/previews/2970/images/logo.svg"}},"url":"https://ovirt.github.io/ovirt-site/previews/2970/dropped/gluster-hyperconverged/chap-Deploying_Hyperconverged.html"}</script>
<!-- End Jekyll SEO tag -->

  <meta name="viewport" content="initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width">
  <link rel="stylesheet" href="/ovirt-site/previews/2970/stylesheets/fonts.css" />
  <link rel='stylesheet' href='https://fonts.googleapis.com/css?family=Open+Sans'>
  <link rel="stylesheet" href="/ovirt-site/previews/2970/stylesheets/application.css" />
  <link rel="stylesheet" href="/ovirt-site/previews/2970/stylesheets/print.css" media="print" />
  <link rel="stylesheet" href="/ovirt-site/previews/2970/stylesheets/coderay.css" media="screen" />
  <link rel="stylesheet" href="/ovirt-site/previews/2970/stylesheets/asciidoc.css" />
  <script src="/ovirt-site/previews/2970/javascripts/vendor/jquery.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2970/javascripts/vendor/bootstrap.min.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2970/javascripts/vendor/bootstrap-sortable.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2970/javascripts/vendor/moment.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2970/javascripts/vendor/fullcalendar/fullcalendar.js" type="text/javascript"></script>
  <script src="/ovirt-site/previews/2970/javascripts/lib/cal-widget.js" type="text/javascript"></script>
  <link href='/ovirt-site/previews/2970/favicon.ico' rel='shortcut icon' sizes='36x36 24x24 16x16' type='image/x-icon'/>
<link href='/ovirt-site/previews/2970/favicon.png' rel='icon' sizes='196x196' type='image/png'/>
<meta content='/ovirt-site/previews/2970/mstile-icon-128x128.png' name='msapplication-TileImage'/>
<meta content='transparent' name='msapplication-TileColor'/>
<link href='/ovirt-site/previews/2970/manifest.webmanifest' rel='manifest'/>
<meta content='/ovirt-site/previews/2970/browserconfig.xml' name='msapplication-config'/>
</head>
<body class=""><header class='masthead hidden-print' id='branding' role='banner'><section class='hgroup'></section><div id='access'><nav id="mainNav" class="navbar navbar-fixed-top affix-top">  <div class="container">    <div class="col-sm-2 navbar-header">      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#menu_id0980fddf">        <span class="sr-only">Toggle navigation</span>        <span>Menu</span>        <span class="fa fa-bars"></span>      </button>      <a class="navbar-brand" href="/ovirt-site/previews/2970/">        <img id="logo" alt="oVirt" src="/ovirt-site/previews/2970/images/logo.svg" />      </a>    </div>    <!-- Collect the nav links, forms, and other content for toggling -->    <div class="col-sm-10">      <div class="navbar-collapse collapse" id="menu_id0980fddf">        <ul class="nav navbar-nav" role="menubar">          <li class="hidden active">            <a href="#page-wrap"></a>          </li><li role='menuitem'>  <a href='/ovirt-site/previews/2970/download/'>Download</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2970/documentation/'>Documentation</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2970/develop/'>Developers</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2970/community/'>Community</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2970//lists.ovirt.org/archives/'>Forum</a></li><li role='menuitem'>  <a href='/ovirt-site/previews/2970//blogs.ovirt.org/'>Blog</a></li>        </ul>      </div>      <!-- /.navbar-collapse -->    </div>  </div></nav></div></header><main id="page-wrap" class="page-wrap" aria-label="Content">
      <section id="page" class="page">
        <!-- adapted from https://github.com/git-no/jekyll-breadcrumbs -->
<nav class="breadcrumbs bootstrap hidden-sm-down" aria-label="breadcrumb">

   <ol class="breadcrumb list-unstyled" vocab="http://schema.org/" typeof="BreadcrumbList">

      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2970/">
              <span property="name"></span>
              <meta property="position" content="1" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2970/dropped/">
              <span property="name">Dropped</span>
              <meta property="position" content="2" />
           </a>
        </li>
      
        
        
        <li class="breadcrumb-item" property="itemListElement" typeof="ListItem">
           <a property="item" typeof="WebPage" href="/ovirt-site/previews/2970/dropped/gluster-hyperconverged/">
              <span property="name">Gluster Hyperconverged</span>
              <meta property="position" content="3" />
           </a>
        </li>
      
        
        
          

   </ol>

</nav>

        
          
        
        <section id="content" class="content container">
          
<h1 id="chapter-2-deploying-ovirt-and-gluster-hyperconverged">Chapter 2: Deploying oVirt and Gluster Hyperconverged</h1>

<h2 id="pre-requisites">Pre-requisites</h2>

<ul>
  <li>
    <p>You must have 3 Enterprise Linux 8 hosts or oVirt Node 4.4 hosts. Refer <a href="/ovirt-site/previews/2970/documentation/installing_ovirt_as_a_self-hosted_engine_using_the_command_line/#Red_Hat_Enterprise_Linux_hosts_SHE_cli_deploy">Enterprise Linux Hosts</a> or <a href="/ovirt-site/previews/2970/documentation/installing_ovirt_as_a_self-hosted_engine_using_the_command_line/#Red_Hat_Virtualization_Hosts_SHE_cli_deploy">oVirt Nodes</a></p>
  </li>
  <li>
    <p>You must have at least 2 interfaces on each of the hosts, so that the frontend and backend traffic can be separated out. Having only one network will cause the engine monitoring, client traffic, gluster I/O traffic to all run together and interfere each other. To segregate the backend network, the gluster cluster is formed using the backend network addresses, and the nodes are added to the engine using the frontend network address.</p>
  </li>
  <li>
    <p>You must have a fully qualified domain name prepared for your Engine and the host. Forward and reverse lookup records must both be set in the DNS. <strong>The Engine should use the same subnet as the management network.</strong></p>
  </li>
  <li>
    <p>You must have configured passwordless ssh between the first host to itself and the other 2 hosts. This is needed for gdeploy to configure the 3 nodes. gdeploy uses Ansible playbooks and the ability to remotely execute commands is a pre-requisite.</p>
  </li>
</ul>

<h2 id="deploying-on-enterprise-linux-hosts">Deploying on Enterprise Linux Hosts</h2>

<h3 id="installing-the-required-packages">Installing the Required Packages</h3>

<p><strong>Installing the packages on the first host</strong></p>

<ol>
  <li>
    <p>On all 3 hosts, subscribe to ovirt repos from https://resources.ovirt.org/pub/yum-repo/
For instance, to subscribe to oVirt 4.4 repo.</p>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> # yum install https://resources.ovirt.org/pub/yum-repo/ovirt-release44.rpm
</code></pre></div>    </div>
  </li>
  <li>On all 3 hosts, install the following packages:
    <ul>
      <li>cockpit-ovirt-dashboard (provides a UI for the installation)</li>
      <li>vdsm-gluster (plugin to manage gluster services)</li>
    </ul>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum install cockpit-ovirt-dashboard vdsm-gluster ovirt-host
</code></pre></div>    </div>
  </li>
  <li>On the first host, install the following packages:
    <ul>
      <li>ovirt-engine-appliance (for the Engine virtual machine installation)</li>
      <li>gdeploy (a wrapper tool around Ansible that helps to setup gluster volumes)</li>
    </ul>

    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># yum install ovirt-engine-appliance
</code></pre></div>    </div>
  </li>
</ol>

<h2 id="deploying-on-ovirt-node-based-hosts">Deploying on oVirt Node based Hosts</h2>

<p><strong>oVirt Node contains all the required packages to set up the hyperconverged environment.</strong>
Refer <a href="/ovirt-site/previews/2970/documentation/installing_ovirt_as_a_self-hosted_engine_using_the_command_line/#Red_Hat_Virtualization_Hosts_SHE_cli_deploy">oVirt Nodes</a> for instructions on installing oVirt Node on your hosts. You can proceed to setting up the hyperconverged environment if you have 3 oVirt Node based hosts.</p>

<h3 id="setting-up-the-hyperconverged-environment">Setting up the hyperconverged environment</h3>

<p>Steps for installing are detailed in this <a href="https://blogs.ovirt.org/2018/02/up-and-running-with-ovirt-4-2-and-gluster-storage/">blog post</a>.</p>

<p>More details on the deployment wizard are explained below</p>

<h4 id="host-selection">Host selection</h4>

<p>To ensure that GlusterFS related network traffic is segregated on the backend/storage network, the gluster bricks need to be defined using these interface. In this tab, provide the FQDN/IP addresses associated with the backend/storage network so that the bricks are correctly defined during the deployment process.</p>

<p>Cockpit wizard uses ansible to perform the gluster deployment on the hosts. It is required to have key-based authentication setup for <code class="language-plaintext highlighter-rouge">root</code> user between the host running the wizard and the 3 addresses providedfor gluster hosts</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    On the first host in the list, (from which deployment is run)

    # ssh-keygen
    # ssh-copy-id root@gluster-host1-address
    # ssh-copy-id root@gluster-host2-address
    # ssh-copy-id root@gluster-host3-address
</code></pre></div></div>

<p><img src="/ovirt-site/previews/2970/images/gluster-hyperconverged/3-Hosts.png" alt="Hosts sub-tab" /></p>

<p>The deployment process also add the 3 hosts to the oVirt engine at the end of the deployment process. To ensure that the hosts are added using the frontend/management network, provide the FQDN to be used for the hosts in the tab below:</p>

<p><em>FQDN of host1 is input during the Hosted Engine deployment process, hence not asked here</em></p>

<p><img src="/ovirt-site/previews/2970/images/gluster-hyperconverged/4-FQDN.png" alt="Hosts sub-tab" /></p>

<h4 id="package-selection">Package selection</h4>

<p>This is an optional step - to install additional packages required on all hosts. If using oVirt-Node based installation, all required packages are already available.</p>

<p><img src="/ovirt-site/previews/2970/images/gluster-hyperconverged/5-Packages.png" alt="Packages sub-tab" /></p>
<h4 id="volume-tab">Volume tab</h4>

<p>This step in the wizard defines the gluster volumes that need to be created. These gluster volumes will later in the wizard, be used to create storage domains in oVirt.
The first volume in the list is used to host the Hosted Engine virtual disk.
As a guidance, we ask to create 2 additional gluster volumes</p>
<ul>
  <li>vmstore : Hosting the OS disks of the virtual machines</li>
  <li>data : Hosting the data disks of the virtual machines</li>
</ul>

<p><em>The volumes are separated as above to ease backup, assuming only data volume will need to be backed up</em></p>

<p>All 3 gluster volumes will be created as <code class="language-plaintext highlighter-rouge">Data</code> storage domains.</p>

<p>A gluster volume can be created as an <code class="language-plaintext highlighter-rouge">Arbiter</code> type volume, to save on storage capacity. In this case, the 3rd host will not need the same capacity as the first two hosts. Refer <a href="https://docs.gluster.org/en/v3/Administrator%20Guide/arbiter-volumes-and-quorum/">Arbiter volume</a></p>

<p><img src="/ovirt-site/previews/2970/images/gluster-hyperconverged/6-Volumes.png" alt="Volume sub-tab" /></p>
<h4 id="brick-setup-tab">Brick setup tab</h4>

<p>The Bricks tab configures the devices to use for the gluster volumes defined in the previous step.</p>

<p>If the devices used for bricks are configured as RAID devices, provide the information in the <code class="language-plaintext highlighter-rouge">RAID information</code> section. These parameters are used to create the optimal alignment values for the LVM and filesystem layers created on the device.</p>

<p>Brick configuration allows for per-host definition of bricks. This is useful in case the device names are not uniform across the hosts.</p>

<ul>
  <li>LV Name : name used for the logical LV created on brick. This is read-only and based on the gluster volumes defined in previous step</li>
  <li>Device Name: name of device to be used to create the brick. Either the same device or different devices can be used for different gluster volumes. For instance, engine can use device <code class="language-plaintext highlighter-rouge">sdb</code> while vmstore and data can use device <code class="language-plaintext highlighter-rouge">sdc</code></li>
  <li>Size (GB): Size of the LV in Gigabytes</li>
  <li>Thinp: Checkbox indicating if the LV should be thinly provisioned or not. <strong><em>Thin provisioned LVs are not supported with dedupe &amp; compression on device</em></strong></li>
  <li>Mount point: Path where the brick is mounted. Determined from the brick directory provided in previous step</li>
  <li>
    <p>Enable Dedupe &amp; Compression: Checkbox indicating if de-duplication and compression should be turned on for the device. Dedupe and compression is provided at the device layer using the vdo module available since el7.5. Read more at <a href="https://github.com/dm-vdo/kvdo">dm-vdo</a>. <strong><em>vdo layer will introduce a performance overhead, so it is advised to enable this if youâ€™re using SSD devices</em></strong></p>
  </li>
  <li>Configure LV Cache: Use this option to provide an SSD based lvmcache layer if your brick LVs are on spinning devices.</li>
</ul>

<p><img src="/ovirt-site/previews/2970/images/gluster-hyperconverged/7-Bricks.png" alt="Brick setup sub-tab" /></p>

<p><strong>Prev:</strong> <a href="chap-Introduction.html">Chapter: Introduction</a> <br />
<strong>Next:</strong> <a href="chap-Additional_Steps.html">Chapter: Additional Steps</a></p>




        </section>
      </section>
    </main>

    <script src="/ovirt-site/previews/2970/javascripts/lib/headings_anchors.js" type="text/javascript"></script><footer class='text-center' id='footer'><hr class='visible-print'><ul class='footer-nav-list'><li><a href='/ovirt-site/previews/2970/privacy-policy.html' target='_blank' title='Privacy policy'>Privacy policy</a></li><li><a href='/ovirt-site/previews/2970/community/about.html' target='_blank' title='About'>About</a></li><li><a href='/ovirt-site/previews/2970/general-disclaimer.html' target='_blank' title='Disclaimers'>Disclaimers</a></li></ul>&copy; 2013&ndash;2022 oVirt<div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/issues/new?labels=content&amp;title=Issue:%20/dropped/gluster-hyperconverged/chap-Deploying_Hyperconverged.html&amp;template=' target='_blank' title='Report an issue'><i class="icon fab fa-github"></i>Report an issue with this page</a></div><div class='edit-this-page'><a href='https://github.com/oVirt/ovirt-site/edit/master/source/dropped/gluster-hyperconverged/chap-Deploying_Hyperconverged.md' target='_blank' title='Edit this page'><i class="icon fab fa-github"></i>Edit this page</a></div></footer></body>

</html>
